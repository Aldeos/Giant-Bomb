function Swipe(b,i){var c=function(){};var t=function(C){setTimeout(C||c,0)};var B={addEventListener:!!window.addEventListener,touch:("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch,transitions:(function(C){var E=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var D in E){if(C.style[E[D]]!==undefined){return true}}return false})(document.createElement("swipe"))};if(!b){return}var k=b.children[0];var x,j,r,h;i=i||{};var f=parseInt(i.startSlide,10)||0;var u=i.speed||300;i.continuous=i.continuous!==undefined?i.continuous:true;function o(){x=k.children;h=x.length;if(x.length<2){i.continuous=false}if(B.transitions&&i.continuous&&x.length<3){k.appendChild(x[0].cloneNode(true));k.appendChild(k.children[1].cloneNode(true));x=k.children}j=new Array(x.length);r=b.getBoundingClientRect().width||b.offsetWidth;k.style.width=(x.length*r)+"px";var D=x.length;while(D--){var C=x[D];C.style.width=r+"px";C.setAttribute("data-index",D);if(B.transitions){C.style.left=(D*-r)+"px";q(D,f>D?-r:(f<D?r:0),0)}}if(i.continuous&&B.transitions){q(g(f-1),-r,0);q(g(f+1),r,0)}if(!B.transitions){k.style.left=(f*-r)+"px"}b.style.visibility="visible"}function n(){if(i.continuous){a(f-1)}else{if(f){a(f-1)}}}function p(){if(i.continuous){a(f+1)}else{if(f<x.length-1){a(f+1)}}}function g(C){return(x.length+(C%x.length))%x.length}function a(G,D){if(f==G){return}if(B.transitions){var F=Math.abs(f-G)/(f-G);if(i.continuous){var C=F;F=-j[g(G)]/r;if(F!==C){G=-F*x.length+G}}var E=Math.abs(f-G)-1;while(E--){q(g((G>f?G:f)-E-1),r*F,0)}G=g(G);q(f,r*F,D||u);q(G,0,D||u);if(i.continuous){q(g(G-F),-(r*F),0)}}else{G=g(G);e(f*-r,G*-r,D||u)}f=G;t(i.callback&&i.callback(f,x[f]))}function q(C,E,D){m(C,E,D);j[C]=E}function m(D,G,F){var C=x[D];var E=C&&C.style;if(!E){return}E.webkitTransitionDuration=E.MozTransitionDuration=E.msTransitionDuration=E.OTransitionDuration=E.transitionDuration=F+"ms";E.webkitTransform="translate("+G+"px,0)translateZ(0)";E.msTransform=E.MozTransform=E.OTransform="translateX("+G+"px)"}function e(G,F,C){if(!C){k.style.left=F+"px";return}var E=+new Date;var D=setInterval(function(){var H=+new Date-E;if(H>C){k.style.left=F+"px";if(A){w()}i.transitionEnd&&i.transitionEnd.call(event,f,x[f]);clearInterval(D);return}k.style.left=(((F-G)*(Math.floor((H/C)*100)/100))+G)+"px"},4)}var A=i.auto||0;var v;function w(){v=setTimeout(p,A)}function s(){A=0;clearTimeout(v)}var d={};var y={};var z;var l={handleEvent:function(C){switch(C.type){case"touchstart":this.start(C);break;case"touchmove":this.move(C);break;case"touchend":t(this.end(C));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":t(this.transitionEnd(C));break;case"resize":t(o.call());break}if(i.stopPropagation){C.stopPropagation()}},start:function(C){var D=C.touches[0];d={x:D.pageX,y:D.pageY,time:+new Date};z=undefined;y={};k.addEventListener("touchmove",this,false);k.addEventListener("touchend",this,false)},move:function(C){if(C.touches.length>1||C.scale&&C.scale!==1){return}if(i.disableScroll){C.preventDefault()}var D=C.touches[0];y={x:D.pageX-d.x,y:D.pageY-d.y};if(typeof z=="undefined"){z=!!(z||Math.abs(y.x)<Math.abs(y.y))}if(!z){C.preventDefault();s();if(i.continuous){m(g(f-1),y.x+j[g(f-1)],0);m(f,y.x+j[f],0);m(g(f+1),y.x+j[g(f+1)],0)}else{y.x=y.x/((!f&&y.x>0||f==x.length-1&&y.x<0)?(Math.abs(y.x)/r+1):1);m(f-1,y.x+j[f-1],0);m(f,y.x+j[f],0);m(f+1,y.x+j[f+1],0)}}},end:function(E){var G=+new Date-d.time;var C=Number(G)<250&&Math.abs(y.x)>20||Math.abs(y.x)>r/2;var D=!f&&y.x>0||f==x.length-1&&y.x<0;if(i.continuous){D=false}var F=y.x<0;if(!z){if(C&&!D){if(F){if(i.continuous){q(g(f-1),-r,0);q(g(f+2),r,0)}else{q(f-1,-r,0)}q(f,j[f]-r,u);q(g(f+1),j[g(f+1)]-r,u);f=g(f+1)}else{if(i.continuous){q(g(f+1),r,0);q(g(f-2),-r,0)}else{q(f+1,r,0)}q(f,j[f]+r,u);q(g(f-1),j[g(f-1)]+r,u);f=g(f-1)}i.callback&&i.callback(f,x[f])}else{if(i.continuous){q(g(f-1),-r,u);q(f,0,u);q(g(f+1),r,u)}else{q(f-1,-r,u);q(f,0,u);q(f+1,r,u)}}}k.removeEventListener("touchmove",l,false);k.removeEventListener("touchend",l,false)},transitionEnd:function(C){if(parseInt(C.target.getAttribute("data-index"),10)==f){if(A){w()}i.transitionEnd&&i.transitionEnd.call(C,f,x[f])}}};o();if(A){w()}if(B.addEventListener){if(B.touch){k.addEventListener("touchstart",l,false)}if(B.transitions){k.addEventListener("webkitTransitionEnd",l,false);k.addEventListener("msTransitionEnd",l,false);k.addEventListener("oTransitionEnd",l,false);k.addEventListener("otransitionend",l,false);k.addEventListener("transitionend",l,false)}window.addEventListener("resize",l,false)}else{window.onresize=function(){o()}}return{setup:function(){o()},slide:function(D,C){s();a(D,C)},prev:function(){s();n()},next:function(){s();p()},getPos:function(){return f},getNumSlides:function(){return h},kill:function(){s();k.style.width="auto";k.style.left=0;var D=x.length;while(D--){var C=x[D];C.style.width="100%";C.style.left=0;if(B.transitions){m(D,0,0)}}if(B.addEventListener){k.removeEventListener("touchstart",l,false);k.removeEventListener("webkitTransitionEnd",l,false);k.removeEventListener("msTransitionEnd",l,false);k.removeEventListener("oTransitionEnd",l,false);k.removeEventListener("otransitionend",l,false);k.removeEventListener("transitionend",l,false);window.removeEventListener("resize",l,false)}else{window.onresize=null}}}}if(window.jQuery||window.Zepto){(function(a){a.fn.Swipe=function(b){return this.each(function(){a(this).data("Swipe",new Swipe(a(this)[0],b))})}})(window.jQuery||window.Zepto)};
(function(){function ae(b,n,m){if(b===n){return 0!==b||1/b==1/n}if(null==b||null==n){return b===n}b._chain&&(b=b._wrapped);n._chain&&(n=n._wrapped);if(b.isEqual&&ar.isFunction(b.isEqual)){return b.isEqual(n)}if(n.isEqual&&ar.isFunction(n.isEqual)){return n.isEqual(b)}var l=an.call(b);if(l!=an.call(n)){return !1}switch(l){case"[object String]":return b==""+n;case"[object Number]":return b!=+b?n!=+n:0==b?1/b==1/n:b==+n;case"[object Date]":case"[object Boolean]":return +b==+n;case"[object RegExp]":return b.source==n.source&&b.global==n.global&&b.multiline==n.multiline&&b.ignoreCase==n.ignoreCase}if("object"!=typeof b||"object"!=typeof n){return !1}for(var k=m.length;k--;){if(m[k]==b){return !0}}m.push(b);var k=0,j=!0;if("[object Array]"==l){if(k=b.length,j=k==n.length){for(;k--&&(j=k in b==k in n&&ae(b[k],n[k],m));){}}}else{if("constructor" in b!="constructor" in n||b.constructor!=n.constructor){return !1}for(var i in b){if(ar.has(b,i)&&(k++,!(j=ar.has(n,i)&&ae(b[i],n[i],m)))){break}}if(j){for(i in n){if(ar.has(n,i)&&!k--){break}}j=!k}}m.pop();return j}var ad=this,T=ad._,ak={},ao=Array.prototype,ai=Object.prototype,aq=ao.slice,R=ao.unshift,an=ai.toString,h=ai.hasOwnProperty,Q=ao.forEach,g=ao.map,aj=ao.reduce,ah=ao.reduceRight,af=ao.filter,ac=ao.every,ab=ao.some,ag=ao.indexOf,Z=ao.lastIndexOf,ai=Array.isArray,f=Object.keys,aa=Function.prototype.bind,ar=function(b){return new am(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=ar),exports._=ar):ad._=ar;ar.VERSION="1.3.3";var ap=ar.each=ar.forEach=function(b,l,k){if(b!=null){if(Q&&b.forEach===Q){b.forEach(l,k)}else{if(b.length===+b.length){for(var j=0,i=b.length;j<i;j++){if(j in b&&l.call(k,b[j],j,b)===ak){break}}}else{for(j in b){if(ar.has(b,j)&&l.call(k,b[j],j,b)===ak){break}}}}}};ar.map=ar.collect=function(j,l,i){var k=[];if(j==null){return k}if(g&&j.map===g){return j.map(l,i)}ap(j,function(b,n,m){k[k.length]=l.call(i,b,n,m)});if(j.length===+j.length){k.length=j.length}return k};ar.reduce=ar.foldl=ar.inject=function(b,l,k,j){var i=arguments.length>2;b==null&&(b=[]);if(aj&&b.reduce===aj){j&&(l=ar.bind(l,j));return i?b.reduce(l,k):b.reduce(l)}ap(b,function(n,m,o){if(i){k=l.call(j,k,n,m,o)}else{k=n;i=true}});if(!i){throw new TypeError("Reduce of empty array with no initial value")}return k};ar.reduceRight=ar.foldr=function(b,m,l,k){var j=arguments.length>2;b==null&&(b=[]);if(ah&&b.reduceRight===ah){k&&(m=ar.bind(m,k));return j?b.reduceRight(m,l):b.reduceRight(m)}var i=ar.toArray(b).reverse();k&&!j&&(m=ar.bind(m,k));return j?ar.reduce(i,m,l,k):ar.reduce(i,m)};ar.find=ar.detect=function(j,l,i){var k;X(j,function(b,n,m){if(l.call(i,b,n,m)){k=b;return true}});return k};ar.filter=ar.select=function(j,l,i){var k=[];if(j==null){return k}if(af&&j.filter===af){return j.filter(l,i)}ap(j,function(b,n,m){l.call(i,b,n,m)&&(k[k.length]=b)});return k};ar.reject=function(j,l,i){var k=[];if(j==null){return k}ap(j,function(b,n,m){l.call(i,b,n,m)||(k[k.length]=b)});return k};ar.every=ar.all=function(j,l,i){var k=true;if(j==null){return k}if(ac&&j.every===ac){return j.every(l,i)}ap(j,function(b,n,m){if(!(k=k&&l.call(i,b,n,m))){return ak}});return !!k};var X=ar.some=ar.any=function(b,k,j){k||(k=ar.identity);var i=false;if(b==null){return i}if(ab&&b.some===ab){return b.some(k,j)}ap(b,function(m,l,n){if(i||(i=k.call(j,m,l,n))){return ak}});return !!i};ar.include=ar.contains=function(j,k){var i=false;if(j==null){return i}if(ag&&j.indexOf===ag){return j.indexOf(k)!=-1}return i=X(j,function(b){return b===k})};ar.invoke=function(b,j){var i=aq.call(arguments,2);return ar.map(b,function(k){return(ar.isFunction(j)?j||k:k[j]).apply(k,i)})};ar.pluck=function(b,i){return ar.map(b,function(j){return j[i]})};ar.max=function(b,k,j){if(!k&&ar.isArray(b)&&b[0]===+b[0]){return Math.max.apply(Math,b)}if(!k&&ar.isEmpty(b)){return -Infinity}var i={computed:-Infinity};ap(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l>=i.computed&&(i={value:m,computed:l})});return i.value};ar.min=function(b,k,j){if(!k&&ar.isArray(b)&&b[0]===+b[0]){return Math.min.apply(Math,b)}if(!k&&ar.isEmpty(b)){return Infinity}var i={computed:Infinity};ap(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l<i.computed&&(i={value:m,computed:l})});return i.value};ar.shuffle=function(j){var i=[],k;ap(j,function(b,l){k=Math.floor(Math.random()*(l+1));i[l]=i[k];i[k]=b});return i};ar.sortBy=function(b,k,j){var i=ar.isFunction(k)?k:function(l){return l[k]};return ar.pluck(ar.map(b,function(m,l,n){return{value:m,criteria:i.call(j,m,l,n)}}).sort(function(m,l){var o=m.criteria,n=l.criteria;return o===void 0?1:n===void 0?-1:o<n?-1:o>n?1:0}),"value")};ar.groupBy=function(b,k){var j={},i=ar.isFunction(k)?k:function(l){return l[k]};ap(b,function(m,l){var n=i(m,l);(j[n]||(j[n]=[])).push(m)});return j};ar.sortedIndex=function(b,m,l){l||(l=ar.identity);for(var k=0,j=b.length;k<j;){var i=k+j>>1;l(b[i])<l(m)?k=i+1:j=i}return k};ar.toArray=function(b){return !b?[]:ar.isArray(b)||ar.isArguments(b)?aq.call(b):b.toArray&&ar.isFunction(b.toArray)?b.toArray():ar.values(b)};ar.size=function(b){return ar.isArray(b)?b.length:ar.keys(b).length};ar.first=ar.head=ar.take=function(j,i,k){return i!=null&&!k?aq.call(j,0,i):j[0]};ar.initial=function(j,i,k){return aq.call(j,0,j.length-(i==null||k?1:i))};ar.last=function(j,i,k){return i!=null&&!k?aq.call(j,Math.max(j.length-i,0)):j[j.length-1]};ar.rest=ar.tail=function(j,i,k){return aq.call(j,i==null||k?1:i)};ar.compact=function(b){return ar.filter(b,function(i){return !!i})};ar.flatten=function(b,i){return ar.reduce(b,function(j,k){if(ar.isArray(k)){return j.concat(i?k:ar.flatten(k))}j[j.length]=k;return j},[])};ar.without=function(b){return ar.difference(b,aq.call(arguments,1))};ar.uniq=ar.unique=function(b,k,j){var j=j?ar.map(b,j):b,i=[];b.length<3&&(k=true);ar.reduce(j,function(n,m,l){if(k?ar.last(n)!==m||!n.length:!ar.include(n,m)){n.push(m);i.push(b[l])}return n},[]);return i};ar.union=function(){return ar.uniq(ar.flatten(arguments,true))};ar.intersection=ar.intersect=function(b){var i=aq.call(arguments,1);return ar.filter(ar.uniq(b),function(j){return ar.every(i,function(k){return ar.indexOf(k,j)>=0})})};ar.difference=function(b){var i=ar.flatten(aq.call(arguments,1),true);return ar.filter(b,function(j){return !ar.include(i,j)})};ar.zip=function(){for(var b=aq.call(arguments),k=ar.max(ar.pluck(b,"length")),j=Array(k),i=0;i<k;i++){j[i]=ar.pluck(b,""+i)}return j};ar.indexOf=function(b,k,j){if(b==null){return -1}var i;if(j){j=ar.sortedIndex(b,k);return b[j]===k?j:-1}if(ag&&b.indexOf===ag){return b.indexOf(k)}j=0;for(i=b.length;j<i;j++){if(j in b&&b[j]===k){return j}}return -1};ar.lastIndexOf=function(j,i){if(j==null){return -1}if(Z&&j.lastIndexOf===Z){return j.lastIndexOf(i)}for(var k=j.length;k--;){if(k in j&&j[k]===i){return k}}return -1};ar.range=function(j,i,n){if(arguments.length<=1){i=j||0;j=0}for(var n=arguments[2]||1,m=Math.max(Math.ceil((i-j)/n),0),l=0,k=Array(m);l<m;){k[l++]=j;j=j+n}return k};var V=function(){};ar.bind=function(b,k){var j,i;if(b.bind===aa&&aa){return aa.apply(b,aq.call(arguments,1))}if(!ar.isFunction(b)){throw new TypeError}i=aq.call(arguments,2);return j=function(){if(!(this instanceof j)){return b.apply(k,i.concat(aq.call(arguments)))}V.prototype=b.prototype;var l=new V,m=b.apply(l,i.concat(aq.call(arguments)));return Object(m)===m?m:l}};ar.bindAll=function(b){var i=aq.call(arguments,1);i.length==0&&(i=ar.functions(b));ap(i,function(j){b[j]=ar.bind(b[j],b)});return b};ar.memoize=function(b,j){var i={};j||(j=ar.identity);return function(){var k=j.apply(this,arguments);return ar.has(i,k)?i[k]:i[k]=b.apply(this,arguments)}};ar.delay=function(j,i){var k=aq.call(arguments,2);return setTimeout(function(){return j.apply(null,k)},i)};ar.defer=function(b){return ar.delay.apply(ar,[b,1].concat(aq.call(arguments,1)))};ar.throttle=function(r,q){var p,o,n,m,l,k,b=ar.debounce(function(){l=m=false},q);return function(){p=this;o=arguments;n||(n=setTimeout(function(){n=null;l&&r.apply(p,o);b()},q));m?l=true:k=r.apply(p,o);b();m=true;return k}};ar.debounce=function(j,i,l){var k;return function(){var m=this,b=arguments;l&&!k&&j.apply(m,b);clearTimeout(k);k=setTimeout(function(){k=null;l||j.apply(m,b)},i)}};ar.once=function(j){var i=false,k;return function(){if(i){return k}i=true;return k=j.apply(this,arguments)}};ar.wrap=function(j,i){return function(){var b=[j].concat(aq.call(arguments,0));return i.apply(this,b)}};ar.compose=function(){var b=arguments;return function(){for(var i=arguments,j=b.length-1;j>=0;j--){i=[b[j].apply(this,i)]}return i[0]}};ar.after=function(j,i){return j<=0?i():function(){if(--j<1){return i.apply(this,arguments)}}};ar.keys=f||function(b){if(b!==Object(b)){throw new TypeError("Invalid object")}var j=[],i;for(i in b){ar.has(b,i)&&(j[j.length]=i)}return j};ar.values=function(b){return ar.map(b,ar.identity)};ar.functions=ar.methods=function(b){var j=[],i;for(i in b){ar.isFunction(b[i])&&j.push(i)}return j.sort()};ar.extend=function(b){ap(aq.call(arguments,1),function(i){for(var j in i){b[j]=i[j]}});return b};ar.pick=function(b){var i={};ap(ar.flatten(aq.call(arguments,1)),function(j){j in b&&(i[j]=b[j])});return i};ar.defaults=function(b){ap(aq.call(arguments,1),function(i){for(var j in i){b[j]==null&&(b[j]=i[j])}});return b};ar.clone=function(b){return !ar.isObject(b)?b:ar.isArray(b)?b.slice():ar.extend({},b)};ar.tap=function(j,i){i(j);return j};ar.isEqual=function(j,i){return ae(j,i,[])};ar.isEmpty=function(b){if(b==null){return true}if(ar.isArray(b)||ar.isString(b)){return b.length===0}for(var i in b){if(ar.has(b,i)){return false}}return true};ar.isElement=function(b){return !!(b&&b.nodeType==1)};ar.isArray=ai||function(b){return an.call(b)=="[object Array]"};ar.isObject=function(b){return b===Object(b)};ar.isArguments=function(b){return an.call(b)=="[object Arguments]"};ar.isArguments(arguments)||(ar.isArguments=function(b){return !(!b||!ar.has(b,"callee"))});ar.isFunction=function(b){return an.call(b)=="[object Function]"};ar.isString=function(b){return an.call(b)=="[object String]"};ar.isNumber=function(b){return an.call(b)=="[object Number]"};ar.isFinite=function(b){return ar.isNumber(b)&&isFinite(b)};ar.isNaN=function(b){return b!==b};ar.isBoolean=function(b){return b===true||b===false||an.call(b)=="[object Boolean]"};ar.isDate=function(b){return an.call(b)=="[object Date]"};ar.isRegExp=function(b){return an.call(b)=="[object RegExp]"};ar.isNull=function(b){return b===null};ar.isUndefined=function(b){return b===void 0};ar.has=function(j,i){return h.call(j,i)};ar.noConflict=function(){ad._=T;return this};ar.identity=function(b){return b};ar.times=function(j,i,l){for(var k=0;k<j;k++){i.call(l,k)}};ar.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};ar.result=function(b,j){if(b==null){return null}var i=b[j];return ar.isFunction(i)?i.call(b):i};ar.mixin=function(b){ap(ar.functions(b),function(i){e(i,ar[i]=b[i])})};var d=0;ar.uniqueId=function(j){var i=d++;return j?j+i:i};ar.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/.^/,al={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},W;for(W in al){al[al[W]]=W}var c=/\\|'|\r|\n|\t|\u2028|\u2029/g,a=/\\(\\|'|r|n|t|u2028|u2029)/g,U=function(b){return b.replace(a,function(j,i){return al[i]})};ar.template=function(b,k,j){j=ar.defaults(j||{},ar.templateSettings);b="__p+='"+b.replace(c,function(l){return"\\"+al[l]}).replace(j.escape||Y,function(m,l){return"'+\n_.escape("+U(l)+")+\n'"}).replace(j.interpolate||Y,function(m,l){return"'+\n("+U(l)+")+\n'"}).replace(j.evaluate||Y,function(m,l){return"';\n"+U(l)+"\n;__p+='"})+"';\n";j.variable||(b="with(obj||{}){\n"+b+"}\n");var b="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+b+"return __p;\n",i=new Function(j.variable||"obj","_",b);if(k){return i(k,ar)}k=function(l){return i.call(this,l,ar)};k.source="function("+(j.variable||"obj")+"){\n"+b+"}";return k};ar.chain=function(b){return ar(b).chain()};var am=function(b){this._wrapped=b};ar.prototype=am.prototype;var S=function(b,i){return i?ar(b).chain():b},e=function(b,i){am.prototype[b]=function(){var j=aq.call(arguments);R.call(j,this._wrapped);return S(i.apply(ar,j),this._chain)}};ar.mixin(ar);ap("pop,push,reverse,shift,sort,splice,unshift".split(","),function(j){var i=ao[j];am.prototype[j]=function(){var k=this._wrapped;i.apply(k,arguments);var b=k.length;(j=="shift"||j=="splice")&&b===0&&delete k[0];return S(k,this._chain)}});ap(["concat","join","slice"],function(j){var i=ao[j];am.prototype[j]=function(){return S(i.apply(this._wrapped,arguments),this._chain)}});am.prototype.chain=function(){this._chain=true;return this};am.prototype.value=function(){return this._wrapped}}).call(this);
(function(){var V=this,b=V.Backbone,a=Array.prototype.slice,R=Array.prototype.splice,Y;Y="undefined"!==typeof exports?exports:V.Backbone={};Y.VERSION="0.9.2";var Z=V._;!Z&&"undefined"!==typeof require&&(Z=require("underscore"));var X=V.jQuery||V.Zepto||V.ender;Y.setDomLibrary=function(f){X=f};Y.noConflict=function(){V.Backbone=b;return this};Y.emulateHTTP=!1;Y.emulateJSON=!1;var Q=/\s+/,W=Y.Events={on:function(k,i,r){var p,o,n,m,l;if(!i){return this}k=k.split(Q);for(p=this._callbacks||(this._callbacks={});o=k.shift();){n=(l=p[o])?l.tail:{},n.next=m={},n.context=r,n.callback=i,p[o]={tail:m,next:l?l.next:n}}return this},off:function(r,p,o){var n,m,k,l,i,f;if(m=this._callbacks){if(!r&&!p&&!o){return delete this._callbacks,this}for(r=r?r.split(Q):Z.keys(m);n=r.shift();){if(k=m[n],delete m[n],k&&(p||o)){for(l=k.tail;(k=k.next)!==l;){if(i=k.callback,f=k.context,p&&i!==p||o&&f!==o){this.on(n,i,f)}}}}return this}},trigger:function(k){var i,p,o,n,m,l;if(!(o=this._callbacks)){return this}m=o.all;k=k.split(Q);for(l=a.call(arguments,1);i=k.shift();){if(p=o[i]){for(n=p.tail;(p=p.next)!==n;){p.callback.apply(p.context||this,l)}}if(p=m){n=p.tail;for(i=[i].concat(l);(p=p.next)!==n;){p.callback.apply(p.context||this,i)}}}return this}};W.bind=W.on;W.unbind=W.off;var S=Y.Model=function(g,f){var i;g||(g={});f&&f.parse&&(g=this.parse(g));if(i=T(this,"defaults")){g=Z.extend({},i,g)}f&&f.collection&&(this.collection=f.collection);this.attributes={};this._escapedAttributes={};this.cid=Z.uniqueId("c");this.changed={};this._silent={};this._pending={};this.set(g,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=Z.clone(this.attributes);this.initialize.apply(this,arguments)};Z.extend(S.prototype,W,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return Z.clone(this.attributes)},get:function(f){return this.attributes[f]},escape:function(g){var f;if(f=this._escapedAttributes[g]){return f}f=this.get(g);return this._escapedAttributes[g]=Z.escape(null==f?"":""+f)},has:function(f){return null!=this.get(f)},set:function(i,f,p){var o,n;Z.isObject(i)||null==i?(o=i,p=f):(o={},o[i]=f);p||(p={});if(!o){return this}o instanceof S&&(o=o.attributes);if(p.unset){for(n in o){o[n]=void 0}}if(!this._validate(o,p)){return !1}this.idAttribute in o&&(this.id=o[this.idAttribute]);var f=p.changes={},l=this.attributes,m=this._escapedAttributes,k=this._previousAttributes||{};for(n in o){i=o[n];if(!Z.isEqual(l[n],i)||p.unset&&Z.has(l,n)){delete m[n],(p.silent?this._silent:f)[n]=!0}p.unset?delete l[n]:l[n]=i;!Z.isEqual(k[n],i)||Z.has(l,n)!=Z.has(k,n)?(this.changed[n]=i,p.silent||(this._pending[n]=!0)):(delete this.changed[n],delete this._pending[n])}p.silent||this.change(p);return this},unset:function(g,f){(f||(f={})).unset=!0;return this.set(g,null,f)},clear:function(f){(f||(f={})).unset=!0;return this.set(Z.clone(this.attributes),f)},fetch:function(g){var g=g?Z.clone(g):{},f=this,i=g.success;g.success=function(m,l,k){if(!f.set(f.parse(m,k),g)){return !1}i&&i(f,m)};g.error=Y.wrapError(g.error,f,g);return(this.sync||Y.sync).call(this,"read",this,g)},save:function(g,f,o){var n,m;Z.isObject(g)||null==g?(n=g,o=f):(n={},n[g]=f);o=o?Z.clone(o):{};if(o.wait){if(!this._validate(n,o)){return !1}m=Z.clone(this.attributes)}g=Z.extend({},o,{silent:!0});if(n&&!this.set(n,o.wait?g:o)){return !1}var l=this,k=o.success;o.success=function(p,i,r){i=l.parse(p,r);if(o.wait){delete o.wait;i=Z.extend(n||{},i)}if(!l.set(i,o)){return false}k?k(l,p):l.trigger("sync",l,p,o)};o.error=Y.wrapError(o.error,l,o);f=this.isNew()?"create":"update";f=(this.sync||Y.sync).call(this,f,this,o);o.wait&&this.set(m,g);return f},destroy:function(g){var g=g?Z.clone(g):{},f=this,l=g.success,k=function(){f.trigger("destroy",f,f.collection,g)};if(this.isNew()){return k(),!1}g.success=function(m){g.wait&&k();l?l(f,m):f.trigger("sync",f,m,g)};g.error=Y.wrapError(g.error,f,g);var i=(this.sync||Y.sync).call(this,"delete",this,g);g.wait||k();return i},url:function(){var f=T(this,"urlRoot")||T(this.collection,"url")||J();return this.isNew()?f:f+("/"==f.charAt(f.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(f){return f},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(g){g||(g={});var f=this._changing;this._changing=!0;for(var k in this._silent){this._pending[k]=!0}var i=Z.extend({},g.changes,this._silent);this._silent={};for(k in i){this.trigger("change:"+k,this,this.get(k),g)}if(f){return this}for(;!Z.isEmpty(this._pending);){this._pending={};this.trigger("change",this,g);for(k in this.changed){!this._pending[k]&&!this._silent[k]&&delete this.changed[k]}this._previousAttributes=Z.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(f){return !arguments.length?!Z.isEmpty(this.changed):Z.has(this.changed,f)},changedAttributes:function(g){if(!g){return this.hasChanged()?Z.clone(this.changed):!1}var f,l=!1,k=this._previousAttributes,i;for(i in g){if(!Z.isEqual(k[i],f=g[i])){(l||(l={}))[i]=f}}return l},previous:function(f){return !arguments.length||!this._previousAttributes?null:this._previousAttributes[f]},previousAttributes:function(){return Z.clone(this._previousAttributes)},isValid:function(){return !this.validate(this.attributes)},_validate:function(g,f){if(f.silent||!this.validate){return !0}var g=Z.extend({},this.attributes,g),i=this.validate(g,f);if(!i){return !0}f&&f.error?f.error(this,i,f):this.trigger("error",this,i,f);return !1}});var N=Y.Collection=function(g,f){f||(f={});f.model&&(this.model=f.model);f.comparator&&(this.comparator=f.comparator);this._reset();this.initialize.apply(this,arguments);g&&this.reset(g,{silent:!0,parse:f.parse})};Z.extend(N.prototype,W,{model:S,initialize:function(){},toJSON:function(f){return this.map(function(g){return g.toJSON(f)})},add:function(v,u){var t,s,r,p,o,n={},m={},f=[];u||(u={});v=Z.isArray(v)?v.slice():[v];t=0;for(s=v.length;t<s;t++){if(!(r=v[t]=this._prepareModel(v[t],u))){throw Error("Can't add an invalid model to a collection")}p=r.cid;o=r.id;n[p]||this._byCid[p]||null!=o&&(m[o]||this._byId[o])?f.push(t):n[p]=m[o]=r}for(t=f.length;t--;){v.splice(f[t],1)}t=0;for(s=v.length;t<s;t++){(r=v[t]).on("all",this._onModelEvent,this),this._byCid[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)}this.length+=s;R.apply(this.models,[null!=u.at?u.at:this.models.length,0].concat(v));this.comparator&&this.sort({silent:!0});if(u.silent){return this}t=0;for(s=this.models.length;t<s;t++){if(n[(r=this.models[t]).cid]){u.index=t,r.trigger("add",r,this,u)}}return this},remove:function(i,f){var n,m,l,k;f||(f={});i=Z.isArray(i)?i.slice():[i];n=0;for(m=i.length;n<m;n++){if(k=this.getByCid(i[n])||this.get(i[n])){delete this._byId[k.id],delete this._byCid[k.cid],l=this.indexOf(k),this.models.splice(l,1),this.length--,f.silent||(f.index=l,k.trigger("remove",k,this,f)),this._removeReference(k)}}return this},push:function(g,f){g=this._prepareModel(g,f);this.add(g,f);return g},pop:function(g){var f=this.at(this.length-1);this.remove(f,g);return f},unshift:function(g,f){g=this._prepareModel(g,f);this.add(g,Z.extend({at:0},f));return g},shift:function(g){var f=this.at(0);this.remove(f,g);return f},get:function(f){return null==f?void 0:this._byId[null!=f.id?f.id:f]},getByCid:function(f){return f&&this._byCid[f.cid||f]},at:function(f){return this.models[f]},where:function(f){return Z.isEmpty(f)?[]:this.filter(function(g){for(var i in f){if(f[i]!==g.get(i)){return !1}}return !0})},sort:function(g){g||(g={});if(!this.comparator){throw Error("Cannot sort a set without a comparator")}var f=Z.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(f):this.models.sort(f);g.silent||this.trigger("reset",this,g);return this},pluck:function(f){return Z.map(this.models,function(g){return g.get(f)})},reset:function(g,f){g||(g=[]);f||(f={});for(var k=0,i=this.models.length;k<i;k++){this._removeReference(this.models[k])}this._reset();this.add(g,Z.extend({silent:!0},f));f.silent||this.trigger("reset",this,f);return this},fetch:function(g){g=g?Z.clone(g):{};void 0===g.parse&&(g.parse=!0);var f=this,i=g.success;g.success=function(m,l,k){f[g.add?"add":"reset"](f.parse(m,k),g);i&&i(f,m)};g.error=Y.wrapError(g.error,f,g);return(this.sync||Y.sync).call(this,"read",this,g)},create:function(g,f){var k=this,f=f?Z.clone(f):{},g=this._prepareModel(g,f);if(!g){return !1}f.wait||k.add(g,f);var i=f.success;f.success=function(m,l){f.wait&&k.add(m,f);i?i(m,l):m.trigger("sync",g,l,f)};g.save(null,f);return g},parse:function(f){return f},chain:function(){return Z(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(g,f){f||(f={});g instanceof S?g.collection||(g.collection=this):(f.collection=this,g=new this.model(g,f),g._validate(g.attributes,f)||(g=!1));return g},_removeReference:function(f){this==f.collection&&delete f.collection;f.off("all",this._onModelEvent,this)},_onModelEvent:function(g,f,k,i){("add"==g||"remove"==g)&&k!=this||("destroy"==g&&this.remove(f,i),f&&g==="change:"+f.idAttribute&&(delete this._byId[f.previous(f.idAttribute)],this._byId[f.id]=f),this.trigger.apply(this,arguments))}});Z.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(f){N.prototype[f]=function(){return Z[f].apply(Z,[this.models].concat(Z.toArray(arguments)))}});var I=Y.Router=function(f){f||(f={});f.routes&&(this.routes=f.routes);this._bindRoutes();this.initialize.apply(this,arguments)},P=/:\w+/g,O=/\*\w+/g,L=/[-[\]{}()+?.,\\^$|#\s]/g;Z.extend(I.prototype,W,{initialize:function(){},route:function(g,f,i){Y.history||(Y.history=new U);Z.isRegExp(g)||(g=this._routeToRegExp(g));i||(i=this[f]);Y.history.route(g,Z.bind(function(k){k=this._extractParameters(g,k);i&&i.apply(this,k);this.trigger.apply(this,["route:"+f].concat(k));Y.history.trigger("route",this,f,k)},this));return this},navigate:function(g,f){Y.history.navigate(g,f)},_bindRoutes:function(){if(this.routes){var g=[],f;for(f in this.routes){g.unshift([f,this.routes[f]])}f=0;for(var i=g.length;f<i;f++){this.route(g[f][0],g[f][1],this[g[f][1]])}}},_routeToRegExp:function(f){f=f.replace(L,"\\$&").replace(P,"([^/]+)").replace(O,"(.*?)");return RegExp("^"+f+"$")},_extractParameters:function(g,f){return g.exec(f).slice(1)}});var U=Y.History=function(){this.handlers=[];Z.bindAll(this,"checkUrl")},M=/^[#\/]/,K=/msie [\w.]+/;U.started=!1;Z.extend(U.prototype,W,{interval:50,getHash:function(f){return(f=(f?f.location:window.location).href.match(/#(.*)$/))?f[1]:""},getFragment:function(g,f){if(null==g){if(this._hasPushState||f){var g=window.location.pathname,i=window.location.search;i&&(g+=i)}else{g=this.getHash()}}g.indexOf(this.options.root)||(g=g.substr(this.options.root.length));return g.replace(M,"")},start:function(g){if(U.started){throw Error("Backbone.history has already been started")}U.started=!0;this.options=Z.extend({},{root:"/"},this.options,g);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var g=this.getFragment(),f=document.documentMode;if(f=K.exec(navigator.userAgent.toLowerCase())&&(!f||7>=f)){this.iframe=X('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(g)}this._hasPushState?X(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange" in window&&!f?X(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=g;g=window.location;f=g.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!f){return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0}this._wantsPushState&&this._hasPushState&&f&&g.hash&&(this.fragment=this.getHash().replace(M,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent){return this.loadUrl()}},stop:function(){X(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);U.started=!1},route:function(g,f){this.handlers.unshift({route:g,callback:f})},checkUrl:function(){var f=this.getFragment();f==this.fragment&&this.iframe&&(f=this.getFragment(this.getHash(this.iframe)));if(f==this.fragment){return !1}this.iframe&&this.navigate(f);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(g){var f=this.fragment=this.getFragment(g);return Z.any(this.handlers,function(i){if(i.route.test(f)){return i.callback(f),!0}})},navigate:function(g,f){if(!U.started){return !1}if(!f||!0===f){f={trigger:f}}var i=(g||"").replace(M,"");this.fragment!=i&&(this._hasPushState?(0!=i.indexOf(this.options.root)&&(i=this.options.root+i),this.fragment=i,window.history[f.replace?"replaceState":"pushState"]({},document.title,i)):this._wantsHashChange?(this.fragment=i,this._updateHash(window.location,i,f.replace),this.iframe&&i!=this.getFragment(this.getHash(this.iframe))&&(f.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,i,f.replace))):window.location.assign(this.options.root+g),f.trigger&&this.loadUrl(g))},_updateHash:function(g,f,i){i?g.replace(g.toString().replace(/(javascript:|#).*$/,"")+"#"+f):g.hash=f}});var j=Y.View=function(f){this.cid=Z.uniqueId("view");this._configure(f||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},q=/^(\S+)\s*(.*)$/,e="model,collection,el,id,attributes,className,tagName".split(",");Z.extend(j.prototype,W,{tagName:"div",$:function(f){return this.$el.find(f)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(g,f,i){g=document.createElement(g);f&&X(g).attr(f);i&&X(g).html(i);return g},setElement:function(g,f){this.$el&&this.undelegateEvents();this.$el=g instanceof X?g:X(g);this.el=this.$el[0];!1!==f&&this.delegateEvents();return this},delegateEvents:function(g){if(g||(g=T(this,"events"))){this.undelegateEvents();for(var f in g){var l=g[f];Z.isFunction(l)||(l=this[g[f]]);if(!l){throw Error('Method "'+g[f]+'" does not exist')}var k=f.match(q),i=k[1],k=k[2],l=Z.bind(l,this),i=i+(".delegateEvents"+this.cid);""===k?this.$el.bind(i,l):this.$el.delegate(k,i,l)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(g){this.options&&(g=Z.extend({},this.options,g));for(var f=0,k=e.length;f<k;f++){var i=e[f];g[i]&&(this[i]=g[i])}this.options=g},_ensureElement:function(){if(this.el){this.setElement(this.el,!1)}else{var f=T(this,"attributes")||{};this.id&&(f.id=this.id);this.className&&(f["class"]=this.className);this.setElement(this.make(this.tagName,f),!1)}}});S.extend=N.extend=I.extend=j.extend=function(g,f){var i=h(this,g,f);i.extend=this.extend;return i};var d={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};Y.sync=function(g,f,l){var k=d[g];l||(l={});var i={type:k,dataType:"json"};l.url||(i.url=T(f,"url")||J());if(!l.data&&f&&("create"==g||"update"==g)){i.contentType="application/json",i.data=JSON.stringify(f.toJSON())}Y.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(Y.emulateHTTP&&("PUT"===k||"DELETE"===k)){Y.emulateJSON&&(i.data._method=k),i.type="POST",i.beforeSend=function(m){m.setRequestHeader("X-HTTP-Method-Override",k)}}"GET"!==i.type&&!Y.emulateJSON&&(i.processData=!1);return X.ajax(Z.extend(i,l))};Y.wrapError=function(g,f,i){return function(l,k){k=l===f?k:l;g?g(f,k,i):f.trigger("error",f,k,i)}};var c=function(){},h=function(g,f,k){var i;i=f&&f.hasOwnProperty("constructor")?f.constructor:function(){g.apply(this,arguments)};Z.extend(i,g);c.prototype=g.prototype;i.prototype=new c;f&&Z.extend(i.prototype,f);k&&Z.extend(i,k);i.prototype.constructor=i;i.__super__=g.prototype;return i},T=function(g,f){return !g||!g[f]?null:Z.isFunction(g[f])?g[f]():g[f]},J=function(){throw Error('A "url" property or function must be specified')}}).call(this);
var Kinetic={};Kinetic.GlobalObject={stages:[],idCounter:0,tempNodes:[],animations:[],animIdCounter:0,animRunning:false,maxDragTimeInterval:20,frame:{time:0,timeDiff:0,lastTime:0},drag:{moving:false,node:undefined,offset:{x:0,y:0},lastDrawTime:0},extend:function(c,b){for(var a in b.prototype){if(b.prototype.hasOwnProperty(a)&&c.prototype[a]===undefined){c.prototype[a]=b.prototype[a]}}},addSetters:function(c,b){for(var d=0;d<b.length;d++){var a=b[d];this._addSetter(c,a)}},addGetters:function(c,b){for(var d=0;d<b.length;d++){var a=b[d];this._addGetter(c,a)}},_pullNodes:function(b){var a=this.tempNodes;for(var d=0;d<a.length;d++){var c=a[d];if(c.getStage()!==undefined&&c.getStage()._id===b._id){b._addId(c);b._addName(c);this.tempNodes.splice(d,1);d-=1}}},_addAnimation:function(a){a.id=this.animIdCounter++;this.animations.push(a)},_removeAnimation:function(a){var d=a.id;var c=this.animations;for(var b=0;b<c.length;b++){if(c[b].id===d){this.animations.splice(b,1);return false}}},_runFrames:function(){var a={};for(var d=0;d<this.animations.length;d++){var c=this.animations[d];if(c.node&&c.node._id!==undefined){a[c.node._id]=c.node}c.func(this.frame)}for(var b in a){a[b].draw()}},_updateFrameObject:function(){var a=new Date();var b=a.getTime();if(this.frame.lastTime===0){this.frame.lastTime=b}else{this.frame.timeDiff=b-this.frame.lastTime;this.frame.lastTime=b;this.frame.time+=this.frame.timeDiff}},_animationLoop:function(){if(this.animations.length>0){this._updateFrameObject();this._runFrames();var a=this;window.requestAnimFrame(function(){a._animationLoop()})}else{this.animRunning=false;this.frame.lastTime=0}},_handleAnimation:function(){var a=this;if(!this.animRunning){this.animRunning=true;a._animationLoop()}else{this.frame.lastTime=0}},_isElement:function(a){return !!(a&&a.nodeType==1)},_isFunction:function(a){return !!(a&&a.constructor&&a.call&&a.apply)},_isArray:function(a){return Object.prototype.toString.call(a)=="[object Array]"},_isObject:function(a){return(a!==undefined&&a.constructor==Object)},_isNumber:function(a){return Object.prototype.toString.call(a)=="[object Number]"},_hasMethods:function(c){var b=[];for(var a in c){if(this._isFunction(c[a])){b.push(a)}}return b.length>0},_getXY:function(a){if(this._isNumber(a)){return{x:a,y:a}}else{if(this._isArray(a)){if(a.length===1){var b=a[0];if(this._isNumber(b)){return{x:b,y:b}}else{if(this._isArray(b)){return{x:b[0],y:b[1]}}else{if(this._isObject(b)){return b}}}}else{if(a.length>=2){return{x:a[0],y:a[1]}}}}else{if(this._isObject(a)){return a}}}return{x:0,y:0}},_getSize:function(a){if(this._isNumber(a)){return{width:a,height:a}}else{if(this._isArray(a)){if(a.length===1){var b=a[0];if(this._isNumber(b)){return{width:b,height:b}}else{if(this._isArray(b)){if(b.length>=4){return{width:b[2],height:b[3]}}else{if(b.length>=2){return{width:b[0],height:b[1]}}}}else{if(this._isObject(b)){return b}}}}else{if(a.length>=4){return{width:a[2],height:a[3]}}else{if(a.length>=2){return{width:a[0],height:a[1]}}}}}else{if(this._isObject(a)){return a}}}return{width:0,height:0}},_getPoints:function(b){if(b===undefined){return[]}if(this._isObject(b[0])){return b}else{var a=[];for(var c=0;c<b.length;c+=2){a.push({x:b[c],y:b[c+1]})}return a}},_addSetter:function(b,a){var c=this;var d="set"+a.charAt(0).toUpperCase()+a.slice(1);b.prototype[d]=function(e){var f={};f[a]=e;this.setAttrs(f)}},_addGetter:function(b,a){var c=this;var d="get"+a.charAt(0).toUpperCase()+a.slice(1);b.prototype[d]=function(e){return this.attrs[a]}}};window.requestAnimFrame=(function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1000/60)}})();Kinetic.Node=function(a){this.defaultNodeAttrs={visible:true,listening:true,name:undefined,alpha:1,x:0,y:0,scale:{x:1,y:1},rotation:0,offset:{x:0,y:0},dragConstraint:"none",dragBounds:{},draggable:false};this.setDefaultAttrs(this.defaultNodeAttrs);this.eventListeners={};this.setAttrs(a);this.on("draggableChange.kinetic",function(){if(this.attrs.draggable){this._listenDrag()}else{this._dragCleanup();var b=this.getStage();var c=Kinetic.GlobalObject;if(b&&c.drag.node&&c.drag.node._id===this._id){b._endDrag()}}});this.simulate("draggableChange")};Kinetic.Node.prototype={on:function(g,i){var f=g.split(" ");for(var c=0;c<f.length;c++){var h=f[c];var b=h;var d=b.split(".");var e=d[0];var a=d.length>1?d[1]:"";if(!this.eventListeners[e]){this.eventListeners[e]=[]}this.eventListeners[e].push({name:a,handler:i})}},off:function(h){var g=h.split(" ");for(var c=0;c<g.length;c++){var j=g[c];var b=j;var d=b.split(".");var f=d[0];if(this.eventListeners[f]&&d.length>1){var a=d[1];for(var e=0;e<this.eventListeners[f].length;e++){if(this.eventListeners[f][e].name===a){this.eventListeners[f].splice(e,1);if(this.eventListeners[f].length===0){delete this.eventListeners[f];break}e--}}}else{delete this.eventListeners[f]}}},getAttrs:function(){return this.attrs},setDefaultAttrs:function(b){if(this.attrs===undefined){this.attrs={}}if(b){for(var a in b){if(this.attrs[a]===undefined){this.attrs[a]=b[a]}}}},setAttrs:function(a){var d=Kinetic.GlobalObject;var c=this;var e;if(a!==undefined){var b=function(h,k,j){for(var g in k){var i=k[g];if(h[g]===undefined){h[g]={}}if(d._isObject(i)&&!d._isArray(i)&&!d._isElement(i)&&!d._hasMethods(i)){if(!Kinetic.GlobalObject._isObject(h[g])){h[g]={}}b(h[g],i,j+1)}else{switch(g){case"rotationDeg":c._setAttr(h,"rotation",k[g]*Math.PI/180);g="rotation";break;case"offset":e=d._getXY(i);c._setAttr(h[g],"x",e.x);c._setAttr(h[g],"y",e.y);break;case"scale":e=d._getXY(i);c._setAttr(h[g],"x",e.x);c._setAttr(h[g],"y",e.y);break;case"points":c._setAttr(h,g,d._getPoints(i));break;case"crop":e=d._getXY(i);var f=d._getSize(i);c._setAttr(h[g],"x",e.x);c._setAttr(h[g],"y",e.y);c._setAttr(h[g],"width",f.width);c._setAttr(h[g],"height",f.height);break;default:c._setAttr(h,g,i);break}if(j===0){c._fireChangeEvent(g)}}}};b(this.attrs,a,0)}},isVisible:function(){if(this.getParent()&&!this.getParent().isVisible()){return false}return this.attrs.visible},show:function(){this.setAttrs({visible:true})},hide:function(){this.setAttrs({visible:false})},getZIndex:function(){return this.index},getAbsoluteZIndex:function(){var e=this.getLevel();var c=this.getStage();var d=this;var b=0;function a(g){var f=[];for(var i=0;i<g.length;i++){var h=g[i];b++;if(h.nodeType!=="Shape"){f=f.concat(h.getChildren())}if(h._id===d._id){i=g.length}}if(f.length>0&&f[0].getLevel()<=e){a(f)}}if(d.nodeType!=="Stage"){a(d.getStage().getChildren())}return b},getLevel:function(){var b=0;var a=this.parent;while(a){b++;a=a.parent}return b},setScale:function(){this.setAttrs({scale:Array.prototype.slice.call(arguments)})},setPosition:function(){var a=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));this.setAttrs(a)},getPosition:function(){return{x:this.attrs.x,y:this.attrs.y}},getAbsolutePosition:function(){return this.getAbsoluteTransform().getTranslation()},setAbsolutePosition:function(){var e=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var a=this.attrs.rotation;var d={x:this.attrs.scale.x,y:this.attrs.scale.y};var c={x:this.attrs.offset.x,y:this.attrs.offset.y};this.attrs.rotation=0;this.attrs.scale={x:1,y:1};var b=this.getAbsoluteTransform();b.invert();b.translate(e.x,e.y);e={x:this.attrs.x+b.getTranslation().x,y:this.attrs.y+b.getTranslation().y};this.setPosition(e.x,e.y);this.rotate(a);this.attrs.scale={x:d.x,y:d.y}},move:function(){var c=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var a=this.getX();var b=this.getY();if(c.x!==undefined){a+=c.x}if(c.y!==undefined){b+=c.y}this.setAttrs({x:a,y:b})},setRotationDeg:function(a){this.setRotation(a*Math.PI/180)},getRotationDeg:function(){return this.attrs.rotation*180/Math.PI},rotate:function(a){this.setAttrs({rotation:this.getRotation()+a})},rotateDeg:function(a){this.setAttrs({rotation:this.getRotation()+(a*Math.PI/180)})},moveToTop:function(){var a=this.index;this.parent.children.splice(a,1);this.parent.children.push(this);this.parent._setChildrenIndices()},moveUp:function(){var a=this.index;this.parent.children.splice(a,1);this.parent.children.splice(a+1,0,this);this.parent._setChildrenIndices()},moveDown:function(){var a=this.index;if(a>0){this.parent.children.splice(a,1);this.parent.children.splice(a-1,0,this);this.parent._setChildrenIndices()}},moveToBottom:function(){var a=this.index;this.parent.children.splice(a,1);this.parent.children.unshift(this);this.parent._setChildrenIndices()},setZIndex:function(b){var a=this.index;this.parent.children.splice(a,1);this.parent.children.splice(b,0,this);this.parent._setChildrenIndices()},getAbsoluteAlpha:function(){var b=1;var a=this;while(a.nodeType!=="Stage"){b*=a.attrs.alpha;a=a.parent}return b},isDragging:function(){var a=Kinetic.GlobalObject;return a.drag.node!==undefined&&a.drag.node._id===this._id&&a.drag.moving},moveTo:function(a){var b=this.parent;b.children.splice(this.index,1);b._setChildrenIndices();a.children.push(this);this.index=a.children.length-1;this.parent=a;a._setChildrenIndices()},getParent:function(){return this.parent},getLayer:function(){if(this.nodeType==="Layer"){return this}else{return this.getParent().getLayer()}},getStage:function(){if(this.nodeType==="Stage"){return this}else{if(this.getParent()===undefined){return undefined}else{return this.getParent().getStage()}}},simulate:function(a){this._handleEvent(a,{})},setOffset:function(){this.setAttrs({offset:Array.prototype.slice.call(arguments)})},transitionTo:function(b){var e=Kinetic.GlobalObject;if(this.transAnim!==undefined){e._removeAnimation(this.transAnim);this.transAnim=undefined}var d=this.nodeType==="Stage"?this:this.getLayer();var c=this;var a=new Kinetic.Transition(this,b);var f={func:function(){a._onEnterFrame()},node:d};this.transAnim=f;e._addAnimation(f);a.onFinished=function(){e._removeAnimation(f);c.transAnim=undefined;if(b.callback!==undefined){b.callback()}f.node.draw()};a.start();e._handleAnimation();return a},getAbsoluteTransform:function(){var e=new Kinetic.Transform();var c=[];var b=this.parent;c.unshift(this);while(b){c.unshift(b);b=b.parent}for(var f=0;f<c.length;f++){var d=c[f];var a=d.getTransform();e.multiply(a)}return e},getTransform:function(){var a=new Kinetic.Transform();if(this.attrs.x!==0||this.attrs.y!==0){a.translate(this.attrs.x,this.attrs.y)}if(this.attrs.rotation!==0){a.rotate(this.attrs.rotation)}if(this.attrs.scale.x!==1||this.attrs.scale.y!==1){a.scale(this.attrs.scale.x,this.attrs.scale.y)}return a},_fireChangeEvent:function(a){this._handleEvent(a+"Change",{})},_setAttr:function(b,a,c){if(c!==undefined){b[a]=c}},_listenDrag:function(){this._dragCleanup();var b=Kinetic.GlobalObject;var a=this;this.on("mousedown.kinetic_initdrag touchstart.kinetic_initdrag",function(c){a._initDrag()})},_initDrag:function(){var c=Kinetic.GlobalObject;var b=this.getStage();var e=b.getUserPosition();if(e){var a=this.getTransform().getTranslation();var d=this.getAbsoluteTransform().getTranslation();c.drag.node=this;c.drag.offset.x=e.x-this.getAbsoluteTransform().getTranslation().x;c.drag.offset.y=e.y-this.getAbsoluteTransform().getTranslation().y}},_dragCleanup:function(){this.off("mousedown.kinetic_initdrag");this.off("touchstart.kinetic_initdrag")},_handleEvent:function(b,j){if(this.nodeType==="Shape"){j.shape=this}var g=this.getStage();var f=g?g.mouseoverShape:null;var l=g?g.mouseoutShape:null;var c=this.eventListeners;var k=true;if(b==="mouseover"&&l&&l._id===this._id){k=false}else{if(b==="mouseout"&&f&&f._id===this._id){k=false}}if(c[b]&&k){var h=c[b];for(var e=0;e<h.length;e++){h[e].handler.apply(this,[j])}}var d=f?f.parent:undefined;var a=l?l.parent:undefined;if(!j.cancelBubble&&this.parent&&this.parent.nodeType!=="Stage"){this._handleEvent.call(this.parent,b,j)}}};Kinetic.GlobalObject.addSetters(Kinetic.Node,["x","y","detectionType","rotation","alpha","name","id","draggable","dragConstraint","dragBounds","listening"]);Kinetic.GlobalObject.addGetters(Kinetic.Node,["scale","x","y","detectionType","rotation","alpha","name","id","draggable","offset","dragConstraint","dragBounds","listening"]);Kinetic.Container=function(){this.children=[]};Kinetic.Container.prototype={getChildren:function(){return this.children},removeChildren:function(){while(this.children.length>0){this.remove(this.children[0])}},add:function(c){var b;c._id=Kinetic.GlobalObject.idCounter++;c.index=this.children.length;c.parent=this;this.children.push(c);var a=c.getStage();if(a===undefined){b=Kinetic.GlobalObject;b.tempNodes.push(c)}else{a._addId(c);a._addName(c);b=Kinetic.GlobalObject;b._pullNodes(a)}if(this._add!==undefined){this._add(c)}return this},remove:function(e){if(e&&e.index!==undefined&&this.children[e.index]._id==e._id){var a=this.getStage();if(a!==undefined){a._removeId(e);a._removeName(e)}var c=Kinetic.GlobalObject;for(var d=0;d<c.tempNodes.length;d++){var b=c.tempNodes[d];if(b._id===e._id){c.tempNodes.splice(d,1);break}}this.children.splice(e.index,1);this._setChildrenIndices();if(e.children){for(d=0;d<e.children.length;d++){e.remove(e.children[d])}}if(this._remove!==undefined){this._remove(e)}}return this},get:function(b){var c=this.getStage();var a;var d=b.slice(1);if(b.charAt(0)==="#"){a=c.ids[d]!==undefined?[c.ids[d]]:[]}else{if(b.charAt(0)==="."){a=c.names[d]!==undefined?c.names[d]:[]}else{if(b==="Shape"||b==="Group"||b==="Layer"){return this._getNodes(b)}else{return false}}}var f=[];for(var g=0;g<a.length;g++){var e=a[g];if(this.isAncestorOf(e)){f.push(e)}}return f},isAncestorOf:function(b){if(this.nodeType==="Stage"){return true}var a=b.getParent();while(a){if(a._id===this._id){return true}a=a.getParent()}return false},_getNodes:function(c){var a=[];function b(d){var e=d.getChildren();for(var g=0;g<e.length;g++){var f=e[g];if(f.nodeType===c){a.push(f)}else{if(f.nodeType!=="Shape"){b(f)}}}}b(this);return a},_drawChildren:function(){var a=this.getStage();var b=this.children;for(var d=0;d<b.length;d++){var c=b[d];if(c.nodeType==="Shape"){if(c.isVisible()&&a.isVisible()){c._draw(c.getLayer())}}else{c.draw()}}},_setChildrenIndices:function(){if(this.nodeType==="Stage"){var a=this.content.children;var b=a[0];var c=a[1];this.content.innerHTML="";this.content.appendChild(b);this.content.appendChild(c)}for(var d=0;d<this.children.length;d++){this.children[d].index=d;if(this.nodeType==="Stage"){this.content.appendChild(this.children[d].canvas)}}}};Kinetic.Stage=function(a){this.setDefaultAttrs({width:400,height:200,throttle:80});if(typeof a.container==="string"){a.container=document.getElementById(a.container)}Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[a]);this._setStageDefaultProperties();this._id=Kinetic.GlobalObject.idCounter++;this._buildDOM();this._bindContentEvents();this.on("widthChange.kinetic",function(){this._resizeDOM()});this.on("heightChange.kinetic",function(){this._resizeDOM()});var b=Kinetic.GlobalObject;b.stages.push(this);this._addId(this);this._addName(this)};Kinetic.Stage.prototype={onFrame:function(b){var a=Kinetic.GlobalObject;this.anim={func:b}},start:function(){if(!this.animRunning){var a=Kinetic.GlobalObject;a._addAnimation(this.anim);a._handleAnimation();this.animRunning=true}},stop:function(){var a=Kinetic.GlobalObject;a._removeAnimation(this.anim);this.animRunning=false},draw:function(){this._drawChildren()},setSize:function(){var a=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(a)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}},clear:function(){var b=this.children;for(var a=0;a<b.length;a++){b[a].clear()}},toDataURL:function(e,f,h){var b=this.bufferLayer;var d=b.getContext();var g=this.children;var c=this;function a(k){var i=g[k].getCanvas().toDataURL();var j=new Image();j.onload=function(){d.drawImage(this,0,0);k++;if(k<g.length){a(k)}else{try{e(b.getCanvas().toDataURL(f,h))}catch(l){e(b.getCanvas().toDataURL())}}};j.src=i}b.clear();a(0)},toJSON:function(){var a=Kinetic.GlobalObject;function b(f){var g={};var e=f.attrs;for(var d in e){var h=e[d];if(a._isFunction(h)||a._isElement(h)||a._hasMethods(h)){e[d]=undefined}}g.attrs=e;g.nodeType=f.nodeType;g.shapeType=f.shapeType;if(f.nodeType!=="Shape"){g.children=[];var c=f.getChildren();for(var j=0;j<c.length;j++){var i=c[j];g.children.push(b(i))}}return g}return window.JSON.stringify(b(this))},reset:function(){this.removeChildren();this._setStageDefaultProperties();this.setAttrs(this.defaultNodeAttrs)},load:function(a){this.reset();function c(f,g){var d=g.children;if(d!==undefined){for(var j=0;j<d.length;j++){var i=d[j];var e;if(i.nodeType==="Shape"){if(i.shapeType===undefined){e="Shape"}else{e=i.shapeType}}else{e=i.nodeType}var h=new Kinetic[e](i.attrs);f.add(h);c(h,i)}}}var b=window.JSON.parse(a);this.attrs=b.attrs;c(this,b);this.draw()},getMousePosition:function(a){return this.mousePos},getTouchPosition:function(a){return this.touchPos},getUserPosition:function(a){return this.getTouchPosition()||this.getMousePosition()},getContainer:function(){return this.attrs.container},getContent:function(){return this.content},getStage:function(){return this},getIntersections:function(){var e=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var a=[];var c=this.get("Shape");for(var d=0;d<c.length;d++){var b=c[d];if(b.intersects(e)){a.push(b)}}return a},getDOM:function(){return this.content},_resizeDOM:function(){var b=this.attrs.width;var c=this.attrs.height;this.content.style.width=b+"px";this.content.style.height=c+"px";this.bufferLayer.getCanvas().width=b;this.bufferLayer.getCanvas().height=c;this.pathLayer.getCanvas().width=b;this.pathLayer.getCanvas().height=c;var e=this.children;for(var d=0;d<e.length;d++){var a=e[d];a.getCanvas().width=b;a.getCanvas().height=c;a.draw()}},_remove:function(a){try{this.content.removeChild(a.canvas)}catch(b){}},_add:function(a){a.canvas.width=this.attrs.width;a.canvas.height=this.attrs.height;a.draw();this.content.appendChild(a.canvas);a.lastDrawTime=0},_detectEvent:function(c,a){var b=Kinetic.GlobalObject.drag.moving;var f=Kinetic.GlobalObject;var g=this.getUserPosition();var d=c.eventListeners;var e=this;if(this.targetShape&&c._id===this.targetShape._id){this.targetFound=true}if(c.isVisible()&&g!==undefined&&c.intersects(g)){if(!b&&this.mouseDown){this.mouseDown=false;this.clickStart=true;c._handleEvent("mousedown",a);return true}else{if(this.mouseUp){this.mouseUp=false;c._handleEvent("mouseup",a);if(this.clickStart){if((!f.drag.moving)||!f.drag.node){c._handleEvent("click",a);if(this.inDoubleClickWindow){c._handleEvent("dblclick",a)}this.inDoubleClickWindow=true;setTimeout(function(){e.inDoubleClickWindow=false},this.dblClickWindow)}}return true}else{if(!b&&this.touchStart&&!this.touchMove){this.touchStart=false;this.tapStart=true;c._handleEvent("touchstart",a);return true}else{if(this.touchEnd){this.touchEnd=false;c._handleEvent("touchend",a);if(this.tapStart){if((!f.drag.moving)||!f.drag.node){c._handleEvent("tap",a);if(this.inDoubleClickWindow){c._handleEvent("dbltap",a)}this.inDoubleClickWindow=true;setTimeout(function(){e.inDoubleClickWindow=false},this.dblClickWindow)}}return true}else{if(!b&&this.touchMove){c._handleEvent("touchmove",a);return true}else{if(!b&&this._isNewTarget(c,a)){if(this.mouseoutShape){this.mouseoverShape=c;this.mouseoutShape._handleEvent("mouseout",a);this.mouseoverShape=undefined}c._handleEvent("mouseover",a);this._setTarget(c);return true}else{if(!b&&this.mouseMove){c._handleEvent("mousemove",a);return true}}}}}}}}else{if(!b&&this.targetShape&&this.targetShape._id===c._id){this._setTarget(undefined);this.mouseoutShape=c;return true}}return false},_setTarget:function(a){this.targetShape=a;this.targetFound=true},_isNewTarget:function(b,a){if(!this.targetShape||(!this.targetFound&&b._id!==this.targetShape._id)){if(this.targetShape){var c=this.targetShape.eventListeners;if(c){this.mouseoutShape=this.targetShape}}return true}else{return false}},_traverseChildren:function(e,a){var d=e.children;var b;for(var c=d.length-1;c>=0;c--){var f=d[c];if(f.getListening()){if(f.nodeType==="Shape"){b=this._detectEvent(f,a);if(b){return true}}else{b=this._traverseChildren(f,a);if(b){return true}}}}return false},_handleStageEvent:function(b){var c=new Date();var f=c.getTime();this.lastEventTime=f;var e=Kinetic.GlobalObject;if(!b){b=window.event}this._setMousePosition(b);this._setTouchPosition(b);this.pathLayer.clear();this.targetFound=false;var a=false;for(var g=this.children.length-1;g>=0;g--){var d=this.children[g];if(d.isVisible()&&g>=0&&d.getListening()){if(this._traverseChildren(d,b)){a=true;break}}}if(!a&&this.mouseoutShape){this.mouseoutShape._handleEvent("mouseout",b);this.mouseoutShape=undefined}},_bindContentEvents:function(){var d=Kinetic.GlobalObject;var c=this;var a=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"];for(var e=0;e<a.length;e++){var b=a[e];(function(){var f=b;c.content.addEventListener(f,function(g){c["_"+f](g)},false)}())}},_mouseover:function(a){this._handleStageEvent(a)},_mouseout:function(a){var b=this.targetShape;if(b){b._handleEvent("mouseout",a);this.targetShape=undefined}this.mousePos=undefined;this._endDrag(a)},_mousemove:function(a){var d=this.attrs.throttle;var b=new Date();var f=b.getTime();var e=f-this.lastEventTime;var c=1000/d;if(e>=c||d>200){this.mouseDown=false;this.mouseUp=false;this.mouseMove=true;this._handleStageEvent(a)}this._startDrag(a)},_mousedown:function(a){this.mouseDown=true;this.mouseUp=false;this.mouseMove=false;this._handleStageEvent(a);if(this.attrs.draggable){this._initDrag()}},_mouseup:function(a){this.mouseDown=false;this.mouseUp=true;this.mouseMove=false;this._handleStageEvent(a);this.clickStart=false;this._endDrag(a)},_touchstart:function(a){a.preventDefault();this.touchStart=true;this.touchEnd=false;this.touchMove=false;this._handleStageEvent(a);if(this.attrs.draggable){this._initDrag()}},_touchend:function(a){this.touchStart=false;this.touchEnd=true;this.touchMove=false;this._handleStageEvent(a);this.tapStart=false;this._endDrag(a)},_touchmove:function(a){var d=this;var e=this.attrs.throttle;var b=new Date();var g=b.getTime();var f=g-this.lastEventTime;var c=1000/e;if(f>=c||e>200){a.preventDefault();d.touchEnd=false;d.touchMove=true;d._handleStageEvent(a)}this._startDrag(a)},_setMousePosition:function(a){var b=a.offsetX||(a.clientX-this._getContentPosition().left+window.pageXOffset);var c=a.offsetY||(a.clientY-this._getContentPosition().top+window.pageYOffset);this.mousePos={x:b,y:c}},_setTouchPosition:function(a){if(a.touches!==undefined&&a.touches.length===1){var d=a.touches[0];var b=d.clientX-this._getContentPosition().left+window.pageXOffset;var c=d.clientY-this._getContentPosition().top+window.pageYOffset;this.touchPos={x:b,y:c}}},_getContentPosition:function(){var c=this.content;var b=0;var a=0;while(c&&c.tagName!=="BODY"){b+=c.offsetTop-c.scrollTop;a+=c.offsetLeft-c.scrollLeft;c=c.offsetParent}return{top:b,left:a}},_modifyPathContext:function(a){a.stroke=function(){};a.fill=function(){};a.fillRect=function(b,e,c,d){a.rect(b,e,c,d)};a.strokeRect=function(b,e,c,d){a.rect(b,e,c,d)};a.drawImage=function(){};a.fillText=function(){};a.strokeText=function(){}},_endDrag:function(a){var b=Kinetic.GlobalObject;if(b.drag.node){if(b.drag.moving){b.drag.moving=false;b.drag.node._handleEvent("dragend",a)}}b.drag.node=undefined},_startDrag:function(g){var e=this;var d=Kinetic.GlobalObject;var c=d.drag.node;if(c){var f=e.getUserPosition();var h=c.attrs.dragConstraint;var i=c.attrs.dragBounds;var b={x:c.attrs.x,y:c.attrs.y};var a={x:f.x-d.drag.offset.x,y:f.y-d.drag.offset.y};if(i.left!==undefined&&a.x<i.left){a.x=i.left}if(i.right!==undefined&&a.x>i.right){a.x=i.right}if(i.top!==undefined&&a.y<i.top){a.y=i.top}if(i.bottom!==undefined&&a.y>i.bottom){a.y=i.bottom}c.setAbsolutePosition(a);if(h==="horizontal"){c.attrs.y=b.y}else{if(h==="vertical"){c.attrs.x=b.x}}if(d.drag.node.nodeType==="Stage"){d.drag.node.draw()}else{d.drag.node.getLayer().draw()}if(!d.drag.moving){d.drag.moving=true;d.drag.node._handleEvent("dragstart",g)}d.drag.node._handleEvent("dragmove",g)}},_buildDOM:function(){this.content=document.createElement("div");this.content.style.position="relative";this.content.style.display="inline-block";this.content.className="kineticjs-content";this.attrs.container.appendChild(this.content);this.bufferLayer=new Kinetic.Layer({name:"bufferLayer"});this.pathLayer=new Kinetic.Layer({name:"pathLayer"});this.bufferLayer.parent=this;this.pathLayer.parent=this;this._modifyPathContext(this.pathLayer.context);this.bufferLayer.getCanvas().style.display="none";this.pathLayer.getCanvas().style.display="none";this.bufferLayer.canvas.className="kineticjs-buffer-layer";this.content.appendChild(this.bufferLayer.canvas);this.pathLayer.canvas.className="kineticjs-path-layer";this.content.appendChild(this.pathLayer.canvas);this.setSize(this.attrs.width,this.attrs.height);this._resizeDOM()},_addId:function(a){if(a.attrs.id!==undefined){this.ids[a.attrs.id]=a}},_removeId:function(a){if(a.attrs.id!==undefined){this.ids[a.attrs.id]=undefined}},_addName:function(b){var a=b.attrs.name;if(a!==undefined){if(this.names[a]===undefined){this.names[a]=[]}this.names[a].push(b)}},_removeName:function(b){if(b.attrs.name!==undefined){var a=this.names[b.attrs.name];if(a!==undefined){for(var d=0;d<a.length;d++){var c=a[d];if(c._id===b._id){a.splice(d,1)}}if(a.length===0){delete this.names[b.attrs.name]}}}},_onContent:function(c,d){var b=c.split(" ");for(var e=0;e<b.length;e++){var a=b[e];this.content.addEventListener(a,d,false)}},_setStageDefaultProperties:function(){this.nodeType="Stage";this.lastEventTime=0;this.dblClickWindow=400;this.targetShape=undefined;this.targetFound=false;this.mouseoverShape=undefined;this.mouseoutShape=undefined;this.mousePos=undefined;this.mouseDown=false;this.mouseUp=false;this.mouseMove=false;this.clickStart=false;this.touchPos=undefined;this.touchStart=false;this.touchEnd=false;this.touchMove=false;this.tapStart=false;this.ids={};this.names={};this.anim=undefined;this.animRunning=false}};Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Node);Kinetic.GlobalObject.addSetters(Kinetic.Stage,["width","height","throttle"]);Kinetic.GlobalObject.addGetters(Kinetic.Stage,["width","height","throttle"]);Kinetic.Layer=function(a){this.setDefaultAttrs({throttle:80});this.nodeType="Layer";this.lastDrawTime=0;this.beforeDrawFunc=undefined;this.afterDrawFunc=undefined;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.style.position="absolute";Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[a])};Kinetic.Layer.prototype={draw:function(){var d=this.attrs.throttle;var a=new Date();var f=a.getTime();var e=f-this.lastDrawTime;var b=1000/d;if(e>=b||d>200){this._draw();if(this.drawTimeout!==undefined){clearTimeout(this.drawTimeout);this.drawTimeout=undefined}}else{if(this.drawTimeout===undefined){var c=this;this.drawTimeout=setTimeout(function(){c.draw()},17)}}},setThrottle:function(a){this.attrs.throttle=a},getThrottle:function(){return this.attrs.throttle},beforeDraw:function(a){this.beforeDrawFunc=a},afterDraw:function(a){this.afterDrawFunc=a},clear:function(){var b=this.getContext();var a=this.getCanvas();b.clearRect(0,0,a.width,a.height)},getCanvas:function(){return this.canvas},getContext:function(){return this.context},_draw:function(){var a=new Date();var b=a.getTime();this.lastDrawTime=b;if(this.beforeDrawFunc!==undefined){this.beforeDrawFunc.call(this)}this.clear();if(this.isVisible()){if(this.attrs.drawFunc!==undefined){this.attrs.drawFunc.call(this)}this._drawChildren()}if(this.afterDrawFunc!==undefined){this.afterDrawFunc.call(this)}}};Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Node);Kinetic.Group=function(a){this.nodeType="Group";Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[a])};Kinetic.Group.prototype={draw:function(){if(this.attrs.visible){this._drawChildren()}}};Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Node);Kinetic.Shape=function(a){this.setDefaultAttrs({fill:undefined,stroke:undefined,strokeWidth:undefined,lineJoin:undefined,detectionType:"path",shadow:{blur:10,alpha:1,offset:{x:0,y:0}}});this.data=[];this.nodeType="Shape";this.appliedShadow=false;Kinetic.Node.apply(this,[a])};Kinetic.Shape.prototype={getContext:function(){if(this.tempLayer===undefined){return null}else{return this.tempLayer.getContext()}},getCanvas:function(){return this.tempLayer.getCanvas()},stroke:function(){var a=false;var b=this.getContext();b.save();if(!!this.attrs.stroke||!!this.attrs.strokeWidth){if(!this.appliedShadow){a=this._applyShadow()}var d=!!this.attrs.stroke?this.attrs.stroke:"black";var c=!!this.attrs.strokeWidth?this.attrs.strokeWidth:2;b.lineWidth=c;b.strokeStyle=d;b.stroke()}b.restore();if(a){this.stroke()}},fill:function(){var a=false;var b=this.getContext();b.save();var k=this.attrs.fill;var g,c,d;if(!!k){if(!this.appliedShadow){a=this._applyShadow()}var l=k.start;var j=k.end;var h=null;if(typeof k=="string"){h=this.attrs.fill;b.fillStyle=h;b.fill()}else{if(k.image!==undefined){var i=k.repeat===undefined?"repeat":k.repeat;h=b.createPattern(k.image,i);b.save();if(k.scale!==undefined){b.scale(k.scale.x,k.scale.y)}if(k.offset!==undefined){b.translate(k.offset.x,k.offset.y)}b.fillStyle=h;b.fill();b.restore()}else{if(l.radius===undefined&&j.radius===undefined){b=this.getContext();g=b.createLinearGradient(l.x,l.y,j.x,j.y);c=k.colorStops;for(d=0;d<c.length;d+=2){g.addColorStop(c[d],c[d+1])}h=g;b.fillStyle=h;b.fill()}else{if(l.radius!==undefined&&j.radius!==undefined){b=this.getContext();g=b.createRadialGradient(l.x,l.y,l.radius,j.x,j.y,j.radius);c=k.colorStops;for(d=0;d<c.length;d+=2){g.addColorStop(c[d],c[d+1])}h=g;b.fillStyle=h;b.fill()}else{h="black";b.fillStyle=h;b.fill()}}}}}b.restore();if(a){this.fill()}},fillText:function(d,a,e){var b=false;var c=this.getContext();c.save();if(this.attrs.textFill!==undefined){if(!this.appliedShadow){b=this._applyShadow()}c.fillStyle=this.attrs.textFill;c.fillText(d,a,e)}c.restore();if(b){this.fillText(d,a,e)}},strokeText:function(d,a,e){var b=false;var c=this.getContext();c.save();if(this.attrs.textStroke!==undefined||this.attrs.textStrokeWidth!==undefined){if(!this.appliedShadow){b=this._applyShadow()}if(this.attrs.textStroke===undefined){this.attrs.textStroke="black"}else{if(this.attrs.textStrokeWidth===undefined){this.attrs.textStrokeWidth=2}}c.lineWidth=this.attrs.textStrokeWidth;c.strokeStyle=this.attrs.textStroke;c.strokeText(d,a,e)}c.restore();if(b){this.strokeText(d,a,e)}},drawImage:function(){var c=false;var d=this.getContext();d.save();var b=Array.prototype.slice.call(arguments);if(b.length===5||b.length===9){if(!this.appliedShadow){c=this._applyShadow()}switch(b.length){case 5:d.drawImage(b[0],b[1],b[2],b[3],b[4]);break;case 9:d.drawImage(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8]);break}}d.restore();if(c){this.drawImage.apply(this,b)}},applyLineJoin:function(){var a=this.getContext();if(this.attrs.lineJoin!==undefined){a.lineJoin=this.attrs.lineJoin}},_applyShadow:function(){var b=this.getContext();var c=this.attrs.shadow;if(c!==undefined){var d=this.getAbsoluteAlpha();var a=this.attrs.shadow.alpha;if(a!==undefined&&c.color!==undefined){b.globalAlpha=a*d;b.shadowColor=c.color;b.shadowBlur=c.blur;b.shadowOffsetX=c.offset.x;b.shadowOffsetY=c.offset.y;this.appliedShadow=true;return true}}return false},saveData:function(){var b=this.getStage();var a=b.attrs.width;var e=b.attrs.height;var d=b.bufferLayer;var c=d.getContext();d.clear();this._draw(d);var f=c.getImageData(0,0,a,e);this.data=f.data},clearData:function(){this.data=[]},intersects:function(){var f=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var b=this.getStage();if(this.attrs.detectionType==="path"){var c=b.pathLayer;var e=c.getContext();this._draw(c);return e.isPointInPath(f.x,f.y)}else{var a=b.attrs.width;var d=this.data[((a*f.y)+f.x)*4+3];return(d!==undefined&&d!==0)}},_draw:function(f){if(f!==undefined&&this.attrs.drawFunc!==undefined){var g=f.getStage();var a=f.getContext();var e=[];var h=this.parent;e.unshift(this);while(h){e.unshift(h);h=h.parent}a.save();for(var b=0;b<e.length;b++){var d=e[b];var i=d.getTransform();if(d.attrs.offset.x!==0||d.attrs.offset.y!==0){i.translate(-1*d.attrs.offset.x,-1*d.attrs.offset.y)}var c=i.getMatrix();a.transform(c[0],c[1],c[2],c[3],c[4],c[5])}this.tempLayer=f;if(this.getAbsoluteAlpha()!==1){a.globalAlpha=this.getAbsoluteAlpha()}this.applyLineJoin();this.appliedShadow=false;this.attrs.drawFunc.call(this);a.restore()}}};Kinetic.GlobalObject.extend(Kinetic.Shape,Kinetic.Node);Kinetic.GlobalObject.addSetters(Kinetic.Shape,["fill","stroke","lineJoin","strokeWidth","shadow","drawFunc"]);Kinetic.GlobalObject.addGetters(Kinetic.Shape,["fill","stroke","lineJoin","strokeWidth","shadow","drawFunc"]);Kinetic.Rect=function(a){this.setDefaultAttrs({width:0,height:0,cornerRadius:0});this.shapeType="Rect";a.drawFunc=function(){var b=this.getContext();b.beginPath();if(this.attrs.cornerRadius===0){b.rect(0,0,this.attrs.width,this.attrs.height)}else{b.moveTo(this.attrs.cornerRadius,0);b.lineTo(this.attrs.width-this.attrs.cornerRadius,0);b.arc(this.attrs.width-this.attrs.cornerRadius,this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI*3/2,0,false);b.lineTo(this.attrs.width,this.attrs.height-this.attrs.cornerRadius);b.arc(this.attrs.width-this.attrs.cornerRadius,this.attrs.height-this.attrs.cornerRadius,this.attrs.cornerRadius,0,Math.PI/2,false);b.lineTo(this.attrs.cornerRadius,this.attrs.height);b.arc(this.attrs.cornerRadius,this.attrs.height-this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI/2,Math.PI,false);b.lineTo(0,this.attrs.cornerRadius);b.arc(this.attrs.cornerRadius,this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI,Math.PI*3/2,false)}b.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[a])};Kinetic.Rect.prototype={setSize:function(){var a=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(a)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}}};Kinetic.GlobalObject.extend(Kinetic.Rect,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Rect,["width","height","cornerRadius"]);Kinetic.GlobalObject.addGetters(Kinetic.Rect,["width","height","cornerRadius"]);Kinetic.Ellipse=function(a){this.setDefaultAttrs({radius:{x:0,y:0}});this.shapeType="Ellipse";a.drawFunc=function(){var d=this.getCanvas();var c=this.getContext();var e=this.getRadius();c.beginPath();c.save();if(e.x!==e.y){c.scale(1,e.y/e.x)}c.arc(0,0,e.x,0,Math.PI*2,true);c.restore();c.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[a]);this._convertRadius();var b=this;this.on("radiusChange",function(){b._convertRadius()})};Kinetic.Circle=Kinetic.Ellipse;Kinetic.Ellipse.prototype={setRadius:function(){this.setAttrs({radius:Array.prototype.slice.call(arguments)})},_convertRadius:function(){var a=Kinetic.GlobalObject;var b=this.getRadius();if(a._isObject(b)){return false}var c=a._getXY(b);this.setAttrs({radius:c})}};Kinetic.GlobalObject.extend(Kinetic.Ellipse,Kinetic.Shape);Kinetic.GlobalObject.addGetters(Kinetic.Ellipse,["radius"]);Kinetic.Image=function(a){this.setDefaultAttrs({crop:{x:0,y:0,width:undefined,height:undefined}});this.shapeType="Image";a.drawFunc=function(){if(this.attrs.image!==undefined){var f=this.attrs.width!==undefined?this.attrs.width:this.attrs.image.width;var g=this.attrs.height!==undefined?this.attrs.height:this.attrs.image.height;var i=this.attrs.crop.x;var h=this.attrs.crop.y;var e=this.attrs.crop.width;var b=this.attrs.crop.height;var d=this.getCanvas();var c=this.getContext();c.beginPath();c.rect(0,0,f,g);c.closePath();this.fill();this.stroke();if(e!==undefined&&b!==undefined){this.drawImage(this.attrs.image,i,h,e,b,0,0,f,g)}else{this.drawImage(this.attrs.image,0,0,f,g)}}};Kinetic.Shape.apply(this,[a])};Kinetic.Image.prototype={setSize:function(){var a=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(a)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}},setCrop:function(){this.setAttrs({crop:Array.prototype.slice.call(arguments)})}};Kinetic.GlobalObject.extend(Kinetic.Image,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Image,["height","width","image"]);Kinetic.GlobalObject.addGetters(Kinetic.Image,["crop","height","width","image"]);Kinetic.Sprite=function(a){this.setDefaultAttrs({index:0,frameRate:17});a.drawFunc=function(){if(this.attrs.image!==undefined){var d=this.getContext();var g=this.attrs.animation;var c=this.attrs.index;var e=this.attrs.animations[g][c];d.beginPath();d.rect(0,0,e.width,e.height);d.closePath();this.drawImage(this.attrs.image,e.x,e.y,e.width,e.height,0,0,e.width,e.height)}};Kinetic.Shape.apply(this,[a]);var b=this;this.on("animationChange",function(){b.setIndex(0)})};Kinetic.Sprite.prototype={start:function(){var b=this;var a=this.getLayer();this.interval=setInterval(function(){b._updateIndex();a.draw();if(b.afterFrameFunc&&b.attrs.index===b.afterFrameIndex){b.afterFrameFunc()}},1000/this.attrs.frameRate)},stop:function(){clearInterval(this.interval)},afterFrame:function(a,b){this.afterFrameIndex=a;this.afterFrameFunc=b},_updateIndex:function(){var c=this.attrs.index;var b=this.attrs.animation;if(c<this.attrs.animations[b].length-1){this.attrs.index++}else{this.attrs.index=0}}};Kinetic.GlobalObject.extend(Kinetic.Sprite,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Sprite,["animation","animations","index"]);Kinetic.GlobalObject.addGetters(Kinetic.Sprite,["animation","animations","index"]);Kinetic.Polygon=function(a){this.setDefaultAttrs({points:[]});this.shapeType="Polygon";a.drawFunc=function(){var b=this.getContext();b.beginPath();b.moveTo(this.attrs.points[0].x,this.attrs.points[0].y);for(var c=1;c<this.attrs.points.length;c++){b.lineTo(this.attrs.points[c].x,this.attrs.points[c].y)}b.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[a])};Kinetic.GlobalObject.extend(Kinetic.Polygon,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Polygon,["points"]);Kinetic.GlobalObject.addGetters(Kinetic.Polygon,["points"]);Kinetic.RegularPolygon=function(a){this.setDefaultAttrs({radius:0,sides:0});this.shapeType="RegularPolygon";a.drawFunc=function(){var c=this.getContext();c.beginPath();c.moveTo(0,0-this.attrs.radius);for(var e=1;e<this.attrs.sides;e++){var b=this.attrs.radius*Math.sin(e*2*Math.PI/this.attrs.sides);var d=-1*this.attrs.radius*Math.cos(e*2*Math.PI/this.attrs.sides);c.lineTo(b,d)}c.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[a])};Kinetic.GlobalObject.extend(Kinetic.RegularPolygon,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Rect,["radius","sides"]);Kinetic.GlobalObject.addGetters(Kinetic.Rect,["radius","sides"]);Kinetic.Star=function(a){this.setDefaultAttrs({numPoints:0,innerRadius:0,outerRadius:0});this.shapeType="Star";a.drawFunc=function(){var c=this.getContext();c.beginPath();c.moveTo(0,0-this.attrs.outerRadius);for(var f=1;f<this.attrs.numPoints*2;f++){var d=f%2===0?this.attrs.outerRadius:this.attrs.innerRadius;var b=d*Math.sin(f*Math.PI/this.attrs.numPoints);var e=-1*d*Math.cos(f*Math.PI/this.attrs.numPoints);c.lineTo(b,e)}c.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[a])};Kinetic.GlobalObject.extend(Kinetic.Star,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Star,["numPoints","innerRadius","outerRadius"]);Kinetic.GlobalObject.addGetters(Kinetic.Star,["numPoints","innerRadius","outerRadius"]);Kinetic.Text=function(a){this.setDefaultAttrs({fontFamily:"Calibri",text:"",fontSize:12,align:"left",verticalAlign:"top",padding:0,fontStyle:"normal",width:"auto",detectionType:"pixel"});this.shapeType="Text";a.drawFunc=function(){var c=this.getContext();c.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily;c.textBaseline="middle";var h=this.getTextHeight();var b=this.attrs.width==="auto"?this.getTextWidth():this.attrs.width;var d=this.attrs.padding;var j=0;var i=0;var g=this;switch(this.attrs.align){case"center":j=b/-2-d;break;case"right":j=-1*b-d;break}switch(this.attrs.verticalAlign){case"middle":i=h/-2-d;break;case"bottom":i=-1*h-d;break}c.save();c.beginPath();c.rect(j,i,b+d*2,h+d*2);c.closePath();this.fill();this.stroke();c.restore();var f=d+j;var e=h/2+d+i;c.save();if(this.attrs.width!=="auto"){c.beginPath();c.rect(j,i,b+d,h+d*2);c.closePath();c.clip()}this.fillText(this.attrs.text,f,e);this.strokeText(this.attrs.text,f,e);c.restore()};Kinetic.Shape.apply(this,[a])};Kinetic.Text.prototype={getTextWidth:function(){return this.getTextSize().width},getTextHeight:function(){return this.getTextSize().height},getTextSize:function(){var b=this.getContext();if(!b){var a=document.createElement("canvas");b=a.getContext("2d")}b.save();b.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily;var c=b.measureText(this.attrs.text);b.restore();return{width:c.width,height:parseInt(this.attrs.fontSize,10)}}};Kinetic.GlobalObject.extend(Kinetic.Text,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Text,["fontFamily","fontSize","fontStyle","textFill","textStroke","textStrokeWidth","padding","align","verticalAlign","text","width"]);Kinetic.GlobalObject.addGetters(Kinetic.Text,["fontFamily","fontSize","fontStyle","textFill","textStroke","textStrokeWidth","padding","align","verticalAlign","text","width"]);Kinetic.Line=function(a){this.setDefaultAttrs({points:[],lineCap:"butt",dashArray:[],detectionType:"pixel"});this.shapeType="Line";a.drawFunc=function(){var d=this.getContext();var c={};d.beginPath();d.moveTo(this.attrs.points[0].x,this.attrs.points[0].y);for(var h=1;h<this.attrs.points.length;h++){var b=this.attrs.points[h].x;var g=this.attrs.points[h].y;if(this.attrs.dashArray.length>0){var f=this.attrs.points[h-1].x;var e=this.attrs.points[h-1].y;this._dashedLine(f,e,b,g,this.attrs.dashArray)}else{d.lineTo(b,g)}}if(!!this.attrs.lineCap){d.lineCap=this.attrs.lineCap}this.stroke()};Kinetic.Shape.apply(this,[a])};Kinetic.Line.prototype={setPoints:function(a){this.setAttrs({points:a})},_dashedLine:function(n,l,a,k,e){var c=this.getContext();var g=e.length;var p=(a-n),o=(k-l);var i=p>o;var j=(i)?o/p:p/o;if(j>9999){j=9999}else{if(j<-9999){j=-9999}}var h=Math.sqrt(p*p+o*o);var f=0,m=true;while(h>=0.1&&f<10000){var b=e[f++%g];if(b===0){b=0.001}if(b>h){b=h}var d=Math.sqrt(b*b/(1+j*j));if(i){n+=p<0&&o<0?d*-1:d;l+=p<0&&o<0?j*d*-1:j*d}else{n+=p<0&&o<0?j*d*-1:j*d;l+=p<0&&o<0?d*-1:d}c[m?"lineTo":"moveTo"](n,l);h-=b;m=!m}c.moveTo(a,k)}};Kinetic.GlobalObject.extend(Kinetic.Line,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Line,["dashArray","lineCap"]);Kinetic.GlobalObject.addGetters(Kinetic.Line,["dashArray","lineCap","points"]);Kinetic.Path=function(a){this.shapeType="Path";this.dataArray=[];var b=this;a.drawFunc=function(){var g=this.getContext();var o=this.dataArray;g.beginPath();for(var k=0;k<o.length;k++){var s=o[k].command;var i=o[k].points;switch(s){case"L":g.lineTo(i[0],i[1]);break;case"M":g.moveTo(i[0],i[1]);break;case"C":g.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":g.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":var m=i[0],l=i[1],h=i[2],f=i[3],j=i[4],e=i[5],t=i[6],q=i[7];var d=(h>f)?h:f;var u=(h>f)?1:h/f;var v=(h>f)?f/h:1;g.translate(m,l);g.rotate(t);g.scale(u,v);g.arc(0,0,d,j,j+e,1-q);g.scale(1/u,1/v);g.rotate(-t);g.translate(-m,-l);break;case"z":g.closePath();break}}this.fill();this.stroke()};Kinetic.Shape.apply(this,[a]);this.dataArray=this.getDataArray();this.on("dataChange",function(){b.dataArray=b.getDataArray()})};Kinetic.Path.prototype={getDataArray:function(){var f=this.attrs.data;if(!this.attrs.data){return[]}var k=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];f=f.replace(new RegExp(" ","g"),",");for(var s=0;s<k.length;s++){f=f.replace(new RegExp(k[s],"g"),"|"+k[s])}var a=f.split("|");var o=[];var j=0;var h=0;for(s=1;s<a.length;s++){var t=a[s];var A=t.charAt(0);t=t.slice(1);t=t.replace(new RegExp(",-","g"),"-");t=t.replace(new RegExp("-","g"),",-");var l=t.split(",");if(l.length>0&&l[0]===""){l.shift()}for(var v=0;v<l.length;v++){l[v]=parseFloat(l[v])}var m,q,y,u,w;var e,d,z,r,g,x,b;while(l.length>0){if(isNaN(l[0])){break}w=[];switch(A){case"l":j+=l.shift();h+=l.shift();u="L";w.push(j,h);break;case"L":j=l.shift();h=l.shift();w.push(j,h);break;case"m":j+=l.shift();h+=l.shift();u="M";w.push(j,h);A="l";break;case"M":j=l.shift();h=l.shift();u="M";w.push(j,h);A="L";break;case"h":j+=l.shift();u="L";w.push(j,h);break;case"H":j=l.shift();u="L";w.push(j,h);break;case"v":h+=l.shift();u="L";w.push(j,h);break;case"V":h=l.shift();u="L";w.push(j,h);break;case"C":w.push(l.shift(),l.shift(),l.shift(),l.shift());j=l.shift();h=l.shift();w.push(j,h);break;case"c":w.push(j+l.shift(),h+l.shift(),j+l.shift(),h+l.shift());j+=l.shift();h+=l.shift();u="C";w.push(j,h);break;case"S":m=j,q=h;y=o[o.length-1];if(y.command==="C"){m=j+(j-y.points[2]);q=h+(h-y.points[3])}w.push(m,q,l.shift(),l.shift());j=l.shift();h=l.shift();u="C";w.push(j,h);break;case"s":m=j;q=h;y=o[o.length-1];if(y.command==="C"){m=j+(j-y.points[2]);q=h+(h-y.points[3])}w.push(m,q,j+l.shift(),h+l.shift());j+=l.shift();h+=l.shift();u="C";w.push(j,h);break;case"Q":w.push(l.shift(),l.shift());j=l.shift();h=l.shift();w.push(j,h);break;case"q":w.push(j+l.shift(),h+l.shift());j+=l.shift();h+=l.shift();u="Q";w.push(j,h);break;case"T":m=j;q=h;y=o[o.length-1];if(y.command==="Q"){m=j+(j-y.points[0]);q=h+(h-y.points[1])}j=l.shift();h=l.shift();u="Q";w.push(m,q,j,h);break;case"t":m=j;q=h;y=o[o.length-1];if(y.command==="Q"){m=j+(j-y.points[0]);q=h+(h-y.points[1])}j+=l.shift();h+=l.shift();u="Q";w.push(m,q,j,h);break;case"A":e=l.shift();d=l.shift();z=l.shift();r=l.shift();g=l.shift();x=j;b=h;j=l.shift(),h=l.shift();u="A";w=this._convertEndpointToCenterParameterization(x,b,j,h,r,g,e,d,z);break;case"a":e=l.shift();d=l.shift();z=l.shift();r=l.shift();g=l.shift();x=j;b=h;j+=l.shift(),h+=l.shift();u="A";w=this._convertEndpointToCenterParameterization(x,b,j,h,r,g,e,d,z);break}o.push({command:u||A,points:w})}if(A==="z"||A==="Z"){o.push({command:"z",points:[]})}}return o},_convertEndpointToCenterParameterization:function(x,e,t,c,r,j,i,g,l){var z=l*(Math.PI/180);var n=Math.cos(z)*(x-t)/2+Math.sin(z)*(e-c)/2;var w=-1*Math.sin(z)*(x-t)/2+Math.cos(z)*(e-c)/2;var a=(n*n)/(i*i)+(w*w)/(g*g);if(a>1){i*=Math.sqrt(a);g*=Math.sqrt(a)}var y=Math.sqrt((((i*i)*(g*g))-((i*i)*(w*w))-((g*g)*(n*n)))/((i*i)*(w*w)+(g*g)*(n*n)));if(r==j){y*=-1}if(isNaN(y)){y=0}var h=y*i*w/g;var q=y*-g*n/i;var d=(x+t)/2+Math.cos(z)*h-Math.sin(z)*q;var b=(e+c)/2+Math.sin(z)*h+Math.cos(z)*q;var B=function(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])};var m=function(C,f){return(C[0]*f[0]+C[1]*f[1])/(B(C)*B(f))};var A=function(C,f){return(C[0]*f[1]<C[1]*f[0]?-1:1)*Math.acos(m(C,f))};var k=A([1,0],[(n-h)/i,(w-q)/g]);var p=[(n-h)/i,(w-q)/g];var o=[(-1*n-h)/i,(-1*w-q)/g];var s=A(p,o);if(m(p,o)<=-1){s=Math.PI}if(m(p,o)>=1){s=0}if(j===0&&s>0){s=s-2*Math.PI}if(j==1&&s<0){s=s+2*Math.PI}return[d,b,i,g,k,s,z,j]}};Kinetic.GlobalObject.extend(Kinetic.Path,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Path,["data"]);Kinetic.GlobalObject.addGetters(Kinetic.Path,["data"]);Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]};Kinetic.Transform.prototype={translate:function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b;this.m[5]+=this.m[1]*a+this.m[3]*b},scale:function(b,a){this.m[0]*=b;this.m[1]*=b;this.m[2]*=a;this.m[3]*=a},rotate:function(a){var h=Math.cos(a);var b=Math.sin(a);var e=this.m[0]*h+this.m[2]*b;var d=this.m[1]*h+this.m[3]*b;var g=this.m[0]*-b+this.m[2]*h;var f=this.m[1]*-b+this.m[3]*h;this.m[0]=e;this.m[1]=d;this.m[2]=g;this.m[3]=f},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},multiply:function(c){var e=this.m[0]*c.m[0]+this.m[2]*c.m[1];var d=this.m[1]*c.m[0]+this.m[3]*c.m[1];var g=this.m[0]*c.m[2]+this.m[2]*c.m[3];var f=this.m[1]*c.m[2]+this.m[3]*c.m[3];var b=this.m[0]*c.m[4]+this.m[2]*c.m[5]+this.m[4];var a=this.m[1]*c.m[4]+this.m[3]*c.m[5]+this.m[5];this.m[0]=e;this.m[1]=d;this.m[2]=g;this.m[3]=f;this.m[4]=b;this.m[5]=a},invert:function(){var g=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);var f=this.m[3]*g;var e=-this.m[1]*g;var c=-this.m[2]*g;var b=this.m[0]*g;var a=g*(this.m[2]*this.m[5]-this.m[3]*this.m[4]);var h=g*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=f;this.m[1]=e;this.m[2]=c;this.m[3]=b;this.m[4]=a;this.m[5]=h},getMatrix:function(){return this.m}};Kinetic.Transition=function(e,c){this.node=e;this.config=c;this.tweens=[];var d=this;function a(j,h){for(var i in j){if(i!=="duration"&&i!=="easing"&&i!=="callback"){if(Kinetic.GlobalObject._isObject(j[i])){a(j[i],h[i])}else{d._add(d._getTween(h,i,j[i]))}}}}a(c,e.attrs);var f=0;for(var g=0;g<this.tweens.length;g++){var b=this.tweens[g];b.onFinished=function(){f++;if(f>=d.tweens.length){d.onFinished()}}}};Kinetic.Transition.prototype={start:function(){for(var a=0;a<this.tweens.length;a++){this.tweens[a].start()}},stop:function(){for(var a=0;a<this.tweens.length;a++){this.tweens[a].stop()}},resume:function(){for(var a=0;a<this.tweens.length;a++){this.tweens[a].resume()}},_onEnterFrame:function(){for(var a=0;a<this.tweens.length;a++){this.tweens[a].onEnterFrame()}},_add:function(a){this.tweens.push(a)},_getTween:function(c,g,f){var b=this.config;var d=this.node;var e=b.easing;if(e===undefined){e="linear"}var a=new Kinetic.Tween(d,function(h){c[g]=h},Kinetic.Tweens[e],c[g],f,b.duration);return a}};Kinetic.Tween=function(e,d,c,b,a,f){this._listeners=[];this.addListener(this);this.obj=e;this.propFunc=d;this.begin=b;this._pos=b;this.setDuration(f);this.isPlaying=false;this._change=0;this.prevTime=0;this.prevPos=0;this.looping=false;this._time=0;this._position=0;this._startTime=0;this._finish=0;this.name="";this.func=c;this.setFinish(a)};Kinetic.Tween.prototype={setTime:function(a){this.prevTime=this._time;if(a>this.getDuration()){if(this.looping){this.rewind(a-this._duration);this.update();this.broadcastMessage("onLooped",{target:this,type:"onLooped"})}else{this._time=this._duration;this.update();this.stop();this.broadcastMessage("onFinished",{target:this,type:"onFinished"})}}else{if(a<0){this.rewind();this.update()}else{this._time=a;this.update()}}},getTime:function(){return this._time},setDuration:function(a){this._duration=(a===null||a<=0)?100000:a},getDuration:function(){return this._duration},setPosition:function(a){this.prevPos=this._pos;this.propFunc(a);this._pos=a;this.broadcastMessage("onChanged",{target:this,type:"onChanged"})},getPosition:function(a){if(a===undefined){a=this._time}return this.func(a,this.begin,this._change,this._duration)},setFinish:function(a){this._change=a-this.begin},getFinish:function(){return this.begin+this._change},start:function(){this.rewind();this.startEnterFrame();this.broadcastMessage("onStarted",{target:this,type:"onStarted"})},rewind:function(a){this.stop();this._time=(a===undefined)?0:a;this.fixTime();this.update()},fforward:function(){this._time=this._duration;this.fixTime();this.update()},update:function(){this.setPosition(this.getPosition(this._time))},startEnterFrame:function(){this.stopEnterFrame();this.isPlaying=true;this.onEnterFrame()},onEnterFrame:function(){if(this.isPlaying){this.nextFrame()}},nextFrame:function(){this.setTime((this.getTimer()-this._startTime)/1000)},stop:function(){this.stopEnterFrame();this.broadcastMessage("onStopped",{target:this,type:"onStopped"})},stopEnterFrame:function(){this.isPlaying=false},continueTo:function(a,b){this.begin=this._pos;this.setFinish(a);if(this._duration!==undefined){this.setDuration(b)}this.start()},resume:function(){this.fixTime();this.startEnterFrame();this.broadcastMessage("onResumed",{target:this,type:"onResumed"})},yoyo:function(){this.continueTo(this.begin,this._time)},addListener:function(a){this.removeListener(a);return this._listeners.push(a)},removeListener:function(d){var b=this._listeners;var c=b.length;while(c--){if(b[c]==d){b.splice(c,1);return true}}return false},broadcastMessage:function(){var b=[];for(var f=0;f<arguments.length;f++){b.push(arguments[f])}var g=b.shift();var d=this._listeners;var c=d.length;for(f=0;f<c;f++){if(d[f][g]){d[f][g].apply(d[f],b)}}},fixTime:function(){this._startTime=this.getTimer()-this._time*1000},getTimer:function(){return new Date().getTime()-this._time}};Kinetic.Tweens={"back-ease-in":function(g,e,k,j,f,i){var h=1.70158;return k*(g/=j)*g*((h+1)*g-h)+e},"back-ease-out":function(g,e,k,j,f,i){var h=1.70158;return k*((g=g/j-1)*g*((h+1)*g+h)+1)+e},"back-ease-in-out":function(g,e,k,j,f,i){var h=1.70158;if((g/=j/2)<1){return k/2*(g*g*(((h*=(1.525))+1)*g-h))+e}return k/2*((g-=2)*g*(((h*=(1.525))+1)*g+h)+2)+e},"elastic-ease-in":function(g,e,k,j,f,i){var h=0;if(g===0){return e}if((g/=j)==1){return e+k}if(!i){i=j*0.3}if(!f||f<Math.abs(k)){f=k;h=i/4}else{h=i/(2*Math.PI)*Math.asin(k/f)}return -(f*Math.pow(2,10*(g-=1))*Math.sin((g*j-h)*(2*Math.PI)/i))+e},"elastic-ease-out":function(g,e,k,j,f,i){var h=0;if(g===0){return e}if((g/=j)==1){return e+k}if(!i){i=j*0.3}if(!f||f<Math.abs(k)){f=k;h=i/4}else{h=i/(2*Math.PI)*Math.asin(k/f)}return(f*Math.pow(2,-10*g)*Math.sin((g*j-h)*(2*Math.PI)/i)+k+e)},"elastic-ease-in-out":function(g,e,k,j,f,i){var h=0;if(g===0){return e}if((g/=j/2)==2){return e+k}if(!i){i=j*(0.3*1.5)}if(!f||f<Math.abs(k)){f=k;h=i/4}else{h=i/(2*Math.PI)*Math.asin(k/f)}if(g<1){return -0.5*(f*Math.pow(2,10*(g-=1))*Math.sin((g*j-h)*(2*Math.PI)/i))+e}return f*Math.pow(2,-10*(g-=1))*Math.sin((g*j-h)*(2*Math.PI)/i)*0.5+k+e},"bounce-ease-out":function(e,a,g,f){if((e/=f)<(1/2.75)){return g*(7.5625*e*e)+a}else{if(e<(2/2.75)){return g*(7.5625*(e-=(1.5/2.75))*e+0.75)+a}else{if(e<(2.5/2.75)){return g*(7.5625*(e-=(2.25/2.75))*e+0.9375)+a}else{return g*(7.5625*(e-=(2.625/2.75))*e+0.984375)+a}}}},"bounce-ease-in":function(e,a,g,f){return g-Kinetic.Tweens["bounce-ease-out"](f-e,0,g,f)+a},"bounce-ease-in-out":function(e,a,g,f){if(e<f/2){return Kinetic.Tweens["bounce-ease-in"](e*2,0,g,f)*0.5+a}else{return Kinetic.Tweens["bounce-ease-out"](e*2-f,0,g,f)*0.5+g*0.5+a}},"ease-in":function(e,a,g,f){return g*(e/=f)*e+a},"ease-out":function(e,a,g,f){return -g*(e/=f)*(e-2)+a},"ease-in-out":function(e,a,g,f){if((e/=f/2)<1){return g/2*e*e+a}return -g/2*((--e)*(e-2)-1)+a},"strong-ease-in":function(e,a,g,f){return g*(e/=f)*e*e*e*e+a},"strong-ease-out":function(e,a,g,f){return g*((e=e/f-1)*e*e*e*e+1)+a},"strong-ease-in-out":function(e,a,g,f){if((e/=f/2)<1){return g/2*e*e*e*e*e+a}return g/2*((e-=2)*e*e*e*e+2)+a},linear:function(e,a,g,f){return g*e/f+a}};
/*!
* screenfull
* v1.1.1 - 2013-11-20
* https://github.com/sindresorhus/screenfull.js
* (c) Sindre Sorhus; MIT License
*/
(function(b,a){var c=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT" in Element,d=(function(){var m,h;var f=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var k=0;var g=f.length;var j={};for(;k<g;k++){m=f[k];if(m&&m[1] in a){for(k=0,h=m.length;k<h;k++){j[f[0][k]]=m[k]}return j}}return false})(),e={request:function(g){var f=d.requestFullscreen;g=g||a.documentElement;if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){g[f]()}else{g[f](c&&Element.ALLOW_KEYBOARD_INPUT)}},exit:function(){a[d.exitFullscreen]()},toggle:function(f){if(this.isFullscreen){this.exit()}else{this.request(f)}},onchange:function(){},onerror:function(){},raw:d};if(!d){b.screenfull=false;return}Object.defineProperties(e,{isFullscreen:{get:function(){return !!a[d.fullscreenElement]}},element:{enumerable:true,get:function(){return a[d.fullscreenElement]}},enabled:{enumerable:true,get:function(){return !!a[d.fullscreenEnabled]}}});a.addEventListener(d.fullscreenchange,function(f){e.onchange.call(e,f)});a.addEventListener(d.fullscreenerror,function(f){e.onerror.call(e,f)});b.screenfull=e})(window,document);
var SWFUpload=function(a){this.initSWFUpload(a)};SWFUpload.prototype.initSWFUpload=function(b){try{this.customSettings={};this.settings={};this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings(b);this.loadSupport();if(this.swfuploadPreload()){this.loadFlash()}this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.5.0 2010-01-15 Beta 2";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290,RESIZE:-300};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.UPLOAD_TYPE={NORMAL:-1,RESIZED:-2};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120,JAVASCRIPT:-130,NONE:-130};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.RESIZE_ENCODING={JPEG:-1,PNG:-2};SWFUpload.completeURL=function(a){try{var d="",c=-1;if(typeof(a)!=="string"||a.match(/^https?:\/\//i)||a.match(/^\//)||a===""){return a}c=window.location.pathname.lastIndexOf("/");if(c<=0){d="/"}else{d=window.location.pathname.substr(0,c)+"/"}return d+a}catch(b){return a}};SWFUpload.onload=function(){};SWFUpload.prototype.initSettings=function(a){this.ensureDefault=function(b,d){var c=a[b];if(c!=undefined){this.settings[b]=c}else{this.settings[b]=d}};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("flash9_url","swfupload_fp9.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_preload_handler",null);this.ensureDefault("swfupload_load_failed_handler",null);this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_resize_start_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("mouse_click_handler",null);this.ensureDefault("mouse_out_handler",null);this.ensureDefault("mouse_over_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime();this.settings.flash9_url=this.settings.flash9_url+(this.settings.flash9_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadSupport=function(){this.support={loading:swfobject.hasFlashPlayerVersion("9.0.28"),imageResize:swfobject.hasFlashPlayerVersion("10.0.0")}};SWFUpload.prototype.loadFlash=function(){var a,f,e,d,c;if(!this.support.loading){this.queueEvent("swfupload_load_failed_handler",["Flash Player doesn't support SWFUpload"]);return}if(document.getElementById(this.movieName)!==null){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Element ID already in use"]);return}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(a==undefined){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["button place holder not found"]);return}e=(a.currentStyle&&a.currentStyle.display||window.getComputedStyle&&document.defaultView.getComputedStyle(a,null).getPropertyValue("display"))!=="block"?"span":"div";f=document.createElement(e);d=this.getFlashHTML();try{f.innerHTML=d}catch(b){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Exception loading Flash HTML into placeholder"]);return}c=f.getElementsByTagName("object");if(!c||c.length>1||c.length===0){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Unable to find movie after adding to DOM"]);return}else{if(c.length===1){this.movieElement=c[0]}}a.parentNode.replaceChild(f.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(a){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',(this.support.imageResize?this.settings.flash_url:this.settings.flash9_url),'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',(this.support.imageResize?this.settings.flash_url:this.settings.flash9_url),'" />','<param name="quality" value="high" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var a,b;b=this.buildParamString();a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var a,c,b=[];c=this.settings.post_params;if(typeof(c)==="object"){for(a in c){if(c.hasOwnProperty(a)){b.push(encodeURIComponent(a.toString())+"="+encodeURIComponent(c[a].toString()))}}}return b.join("&amp;")};SWFUpload.prototype.destroy=function(){var a;try{this.cancelUpload(null,false);a=this.cleanUp();if(a){try{a.parentNode.removeChild(a)}catch(b){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(c){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","flash9_url:                ",this.settings.flash9_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_cursor:            ",this.settings.button_cursor.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_preload_handler assigned:  ",(typeof this.settings.swfupload_preload_handler==="function").toString(),"\n","\t","swfupload_load_failed_handler assigned:  ",(typeof this.settings.swfupload_load_failed_handler==="function").toString(),"\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","mouse_click_handler assigned:       ",(typeof this.settings.mouse_click_handler==="function").toString(),"\n","\t","mouse_over_handler assigned:        ",(typeof this.settings.mouse_over_handler==="function").toString(),"\n","\t","mouse_out_handler assigned:         ",(typeof this.settings.mouse_out_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_resize_start_handler assigned:      ",(typeof this.settings.upload_resize_start_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n","Support:\n","\t","Load:                     ",(this.support.loading?"Yes":"No"),"\n","\t","Image Resize:             ",(this.support.imageResize?"Yes":"No"),"\n"].join(""))};SWFUpload.prototype.addSetting=function(b,c,a){if(c==undefined){return(this.settings[b]=a)}else{return(this.settings[b]=c)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){var movieElement,returnValue,returnString;argumentArray=argumentArray||[];movieElement=this.getMovieElement();try{if(movieElement!=undefined){returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}else{this.debug("Can't call flash because the movie wasn't found.")}}catch(ex){this.debug("Exception calling flash function '"+functionName+"': "+ex.message)}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.startResizedUpload=function(e,b,d,c,f,a){this.callFlash("StartUpload",[e,{width:b,height:d,encoding:c,quality:f,allowEnlarging:a}])};SWFUpload.prototype.cancelUpload=function(b,a){if(a!==false){a=true}this.callFlash("CancelUpload",[b,a])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.requeueUpload=function(a){return this.callFlash("RequeueUpload",[a])};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.getQueueFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByQueueIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(c,a,b){return this.callFlash("AddFileParam",[c,a,b])};SWFUpload.prototype.removeFileParam=function(b,a){this.callFlash("RemoveFileParam",[b,a])};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(b,a){this.settings.file_types=b;this.settings.file_types_description=a;this.callFlash("SetFileTypes",[b,a])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(b,c){this.settings.button_width=b;this.settings.button_height=c;var a=this.getMovieElement();if(a!=undefined){a.style.width=b+"px";a.style.height=c+"px"}this.callFlash("SetButtonDimensions",[b,c])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(b,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=b;this.callFlash("SetButtonTextPadding",[b,a])};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(b,c){var a=this;if(c==undefined){c=[]}else{if(!(c instanceof Array)){c=[c]}}if(typeof this.settings[b]==="function"){this.eventQueue.push(function(){this.settings[b].apply(this,c)});setTimeout(function(){a.executeNextEvent()},0)}else{if(this.settings[b]!==null){throw"Event handler "+b+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(c){var e=/[$]([0-9a-f]{4})/i,f={},d,a,b;if(c!=undefined){for(a in c.post){if(c.post.hasOwnProperty(a)){d=a;while((b=e.exec(d))!==null){d=d.replace(b[0],String.fromCharCode(parseInt("0x"+b[1],16)))}f[d]=c.post[a]}}c.post=f}return c};SWFUpload.prototype.swfuploadPreload=function(){var a;if(typeof this.settings.swfupload_preload_handler==="function"){a=this.settings.swfupload_preload_handler.call(this)}else{if(this.settings.swfupload_preload_handler!=undefined){throw"upload_start_handler must be a function"}}if(a===undefined){a=true}return !!a};SWFUpload.prototype.flashReady=function(){var a=this.cleanUp();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(){var c,a=this.getMovieElement();try{if(a&&typeof(a.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(c in a){try{if(typeof(a[c])==="function"){a[c]=null}}catch(b){}}}}catch(d){}window.__flash__removeCallback=function(e,f){try{if(e){e[f]=null}}catch(g){}};return a};SWFUpload.prototype.mouseClick=function(){this.queueEvent("mouse_click_handler")};SWFUpload.prototype.mouseOver=function(){this.queueEvent("mouse_over_handler")};SWFUpload.prototype.mouseOut=function(){this.queueEvent("mouse_out_handler")};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("file_queue_error_handler",[a,c,b])};SWFUpload.prototype.fileDialogComplete=function(a,c,b){this.queueEvent("file_dialog_complete_handler",[a,c,b])};SWFUpload.prototype.uploadResizeStart=function(b,a){b=this.unescapeFilePostParams(b);this.queueEvent("upload_resize_start_handler",[b,a.width,a.height,a.encoding,a.quality])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(b){var a;if(typeof this.settings.upload_start_handler==="function"){b=this.unescapeFilePostParams(b);a=this.settings.upload_start_handler.call(this,b)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(a===undefined){a=true}a=!!a;this.callFlash("ReturnUploadStart",[a])};SWFUpload.prototype.uploadProgress=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_progress_handler",[a,c,b])};SWFUpload.prototype.uploadError=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_error_handler",[a,c,b])};SWFUpload.prototype.uploadSuccess=function(b,a,c){b=this.unescapeFilePostParams(b);this.queueEvent("upload_success_handler",[b,a,c])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(c){var a,d,b;if(this.settings.debug){d=[];if(typeof c==="object"&&typeof c.name==="string"&&typeof c.message==="string"){for(b in c){if(c.hasOwnProperty(b)){d.push(b+": "+c[b])}}a=d.join("\n")||"";d=a.split("\n");a="EXCEPTION: "+d.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(a)}else{SWFUpload.Console.writeLine(c)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(d){var a,c;try{a=document.getElementById("SWFUpload_Console");if(!a){c=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(c);a=document.createElement("textarea");a.id="SWFUpload_Console";a.style.fontFamily="monospace";a.setAttribute("wrap","off");a.wrap="off";a.style.overflow="auto";a.style.width="700px";a.style.height="350px";a.style.margin="5px";c.appendChild(a)}a.value+=d+"\n";a.scrollTop=a.scrollHeight-a.clientHeight}catch(b){alert("Exception: "+b.name+" Message: "+b.message)}};swfobject.addDomLoadEvent(function(){if(typeof(SWFUpload.onload)==="function"){SWFUpload.onload.call(window)}});
if(typeof(SWFUpload)==="function"){SWFUpload.prototype.initSettings=function(a){return function(b){if(typeof(a)==="function"){a.call(this,b)}this.refreshCookies(false)}}(SWFUpload.prototype.initSettings);SWFUpload.prototype.refreshCookies=function(f){if(f===undefined){f=true}f=!!f;var g=this.settings.post_params;var b,j=document.cookie.split(";"),d=j.length,e,k,a,h;for(b=0;b<d;b++){e=j[b];while(e.charAt(0)===" "){e=e.substring(1,e.length)}k=e.indexOf("=");if(k>0){a=e.substring(0,k);h=e.substring(k+1);g[a]=h}}if(f){this.setPostParams(g)}}};
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
if(typeof document!=="undefined"&&!("classList" in document.createElement("a"))){(function(j){if(!("HTMLElement" in j)&&!("Element" in j)){return}var i="classList",c="prototype",l=(j.HTMLElement||j.Element)[c],f=Object,m=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},e=Array[c].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},a=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return e.call(p,o)},d=function(s){var p=m.call(s.className),r=p?p.split(/\s+/):[],q=0,o=r.length;for(;q<o;q++){this.push(r[q])}this._updateClassName=function(){s.className=this.toString()}},b=d[c]=[],h=function(){return new d(this)};n[c]=Error[c];b.item=function(o){return this[o]||null};b.contains=function(o){o+="";return a(this,o)!==-1};b.add=function(o){o+="";if(a(this,o)===-1){this.push(o);this._updateClassName()}};b.remove=function(p){p+="";var o=a(this,p);if(o!==-1){this.splice(o,1);this._updateClassName()}};b.toggle=function(o){o+="";if(a(this,o)===-1){this.add(o)}else{this.remove(o)}};b.toString=function(){return this.join(" ")};if(f.defineProperty){var k={get:h,enumerable:true,configurable:true};try{f.defineProperty(l,i,k)}catch(g){if(g.number===-2146823252){k.enumerable=false;f.defineProperty(l,i,k)}}}else{if(f[c].__defineGetter__){l.__defineGetter__(i,h)}}}(self))};
if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),c=this,d=function(){},b=function(){return c.apply(this instanceof d&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;b.prototype=new d();return b}};
Object.keys=Object.keys||(function(){var a=Object.prototype.hasOwnProperty,d=!{toString:null}.propertyIsEnumerable("toString"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=b.length;return function(h){if(typeof h!="object"&&typeof h!="function"||h===null){throw new TypeError("Object.keys called on a non-object")}var g=[];for(var e in h){if(a.call(h,e)){g.push(e)}}if(d){for(var f=0;f<c;f++){if(a.call(h,b[f])){g.push(b[f])}}}return g}})();
(function(){var a=$.ui.resizable.prototype._setOption;$.ui.resizable.prototype._setOption=function(b,c){a.apply(this,arguments);if(b==="aspectRatio"){this._aspectRatio=!!c}}}());
/*!
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(f,c){var k=Array.prototype.slice,E=decodeURIComponent,a=f.param,o,d,r,p=f.bbq=f.bbq||{},q,D,e,m=f.event.special,b="hashchange",w="querystring",z="fragment",y="elemUrlAttr",h="location",j="href",C="src",s=/^.*\?|#.*$/g,A=/^.*\#/,i,u={};function t(F){return typeof F==="string"}function x(G){var F=k.call(arguments,1);return function(){return G.apply(this,F.concat(k.call(arguments)))}}function l(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function n(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function g(G,N,F,H,K){var M,L,J,O,I;if(H!==undefined){J=F.match(G?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);I=J[3]||"";if(K===2&&t(H)){L=H.replace(G?A:s,"")}else{O=d(J[2]);H=t(H)?d[G?z:w](H):H;L=K===2?H:K===1?f.extend({},H,O):f.extend({},O,H);L=a(L);if(G){L=L.replace(i,E)}}M=J[1]+(G?"#":L||!J[1]?"?":"")+L+I}else{M=N(F!==undefined?F:c[h][j])}return M}a[w]=x(g,0,n);a[z]=o=x(g,1,l);o.noEscape=function(G){G=G||"";var F=f.map(G.split(""),encodeURIComponent);i=new RegExp(F.join("|"),"g")};o.noEscape(",/");f.deparam=d=function(I,G){var H={},F={"true":!0,"false":!1,"null":null};f.each(I.replace(/\+/g," ").split("&"),function(M,O){var L=O.split("="),P=E(L[0]),K,Q=H,N=0,R=P.split("]["),J=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[J])){R[J]=R[J].replace(/\]$/,"");R=R.shift().split("[").concat(R);J=R.length-1}else{J=0}if(L.length===2){K=E(L[1]);if(G){K=K&&!isNaN(K)?+K:K==="undefined"?undefined:F[K]!==undefined?F[K]:K}if(J){for(;N<=J;N++){P=R[N]===""?Q.length:R[N];Q=Q[P]=N<J?Q[P]||(R[N+1]&&isNaN(R[N+1])?{}:[]):K}}else{if(f.isArray(H[P])){H[P].push(K)}else{if(H[P]!==undefined){H[P]=[H[P],K]}else{H[P]=K}}}}else{if(P){H[P]=G?undefined:""}}});return H};function v(H,G,F){if(G===undefined||typeof G==="boolean"){F=G;G=a[H?z:w]()}else{G=t(G)?G.replace(H?A:s,""):G}return d(G,F)}d[w]=x(v,0);d[z]=r=x(v,1);if(!f[y]){f[y]=(function(F){return f.extend(u,F)})({a:j,base:j,iframe:C,img:C,input:C,form:"action",link:j,script:C})}e=f[y];function B(I,F,H,G){if(!t(H)&&typeof H!=="object"){G=H;H=F;F=undefined}return this.each(function(){var L=f(this),J=F||e()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,G))})}f.fn[w]=x(B,w);f.fn[z]=x(B,z);p.pushState=q=function(I,H){if(t(I)&&/^#/.test(I)&&H===undefined){H=2}var G=I!==undefined,F=o(c[h][j],G?I:{},G?H:2);c[h][j]=F+(/#/.test(F)?"":"#")};p.getState=D=function(G,F){return G===undefined||typeof G==="boolean"?r(G):r(F)[G]};p.removeState=function(F){var G={};if(F!==undefined){G=D();f.each(f.isArray(F)?F:arguments,function(I,H){delete G[H]})}q(G,2)};m[b]=f.extend(m[b],{add:function(G){var H;function F(J){var I=J[z]=o();J.getState=function(L,K){return L===undefined||typeof L==="boolean"?d(I,L):d(I,K)[L]};H.apply(this,arguments)}if(f.isFunction(G)){H=G;return F}else{H=G.handler;G.handler=F}}})})(jQuery,this);
/*!
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,b,h){var j,k=$.event.special,d="location",e="hashchange",l="href",g=$.browser,i=document.documentMode,c=g.msie&&(i===h||i<8),f="on"+e in b&&!c;function a(m){m=m||b[d][l];return m.replace(/^[^#]*#?(.*)$/,"$1")}$[e+"Delay"]=100;k[e]=$.extend(k[e],{setup:function(){if(f){return false}$(j.start)},teardown:function(){if(f){return false}$(j.stop)}});j=(function(){var n={},r,m,o,q;function p(){o=q=function(s){return s};if(c){m=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;q=function(){return a(m.document[d][l])};o=function(u,s){if(u!==s){var t=m.document;t.open().close();t[d].hash="#"+u}};o(a())}}n.start=function(){if(r){return}var t=a();o||p();(function s(){var v=a(),u=q(t);if(v!==t){o(t=v,u);$(b).trigger(e)}else{if(u!==t){b[d][l]=b[d][l].replace(/#.*/,"")+"#"+u}}r=setTimeout(s,$[e+"Delay"])})()};n.stop=function(){if(!m){r&&clearTimeout(r);r=0}};return n})()})(jQuery,this);
(function(g){var f=new Date();f.setHours(0);f.setMinutes(0);f.setSeconds(0);var c=86400;var h={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:false,timeFormat:"g:ia",scrollDefaultNow:false,scrollDefaultTime:false};var e={init:function(n){return this.each(function(){var p=g(this);if(p[0].tagName=="SELECT"){var o=g("<input />");var q={type:"text",value:p.val()};var u=p[0].attributes;for(var r=0;r<u.length;r++){q[u[r].nodeName]=u[r].nodeValue}o.attr(q);p.replaceWith(o);p=o}var s=g.extend({},h);if(n){s=g.extend(s,n)}if(s.minTime){s.minTime=d(s.minTime)}if(s.maxTime){s.maxTime=d(s.maxTime)}if(s.durationTime){s.durationTime=d(s.durationTime)}p.data("settings",s);p.attr("autocomplete","off");p.click(e.show).focus(e.show).keydown(b);p.addClass("ui-timepicker-input");if(p.val()){var v=i(d(p.val()),s.timeFormat);p.val(v)}var t=g('<span class="ui-timepicker-container" />');p.wrap(t);g("body").attr("tabindex",-1).focusin(function(w){if(g(w.target).closest(".ui-timepicker-container").length===0){e.hide()}})})},show:function(t){var n=g(this);var s=n.siblings(".ui-timepicker-list");if(n.hasClass("ui-timepicker-hideme")){n.removeClass("ui-timepicker-hideme");s.hide();return}if(s.is(":visible")){return}e.hide();if(s.length===0){j(n);s=n.siblings(".ui-timepicker-list")}var r=parseInt(n.css("marginTop").slice(0,-2),10);if((n.offset().top+n.outerHeight(true)+s.outerHeight())>g(window).height()+g(window).scrollTop()){s.css({top:n.position().top+r-s.outerHeight()})}else{s.css({top:n.position().top+r+n.outerHeight()})}s.show();var q=n.data("settings");var p=s.find(".ui-timepicker-selected");if(!p.length){if(n.val()){p=m(n,s,d(n.val()))}else{if(q.minTime===null&&q.scrollDefaultNow){p=m(n,s,d(new Date()))}else{if(q.scrollDefaultTime!==false){p=m(n,s,d(q.scrollDefaultTime))}}}}if(p&&p.length){var o=s.scrollTop()+p.position().top-p.outerHeight();s.scrollTop(o)}else{s.scrollTop(0)}n.trigger("showTimepicker")},hide:function(n){g(".ui-timepicker-list:visible").each(function(){var p=g(this);var o=p.siblings(".ui-timepicker-input");k(o);p.hide();o.trigger("hideTimepicker")})},option:function(o,r){var n=g(this);var p=n.data("settings");var q=n.siblings(".ui-timepicker-list");if(typeof o=="object"){p=g.extend(p,o)}else{if(typeof o=="string"&&typeof r!="undefined"){p[o]=r}else{if(typeof o=="string"){return p[o]}}}if(p.minTime){p.minTime=d(p.minTime)}if(p.maxTime){p.maxTime=d(p.maxTime)}if(p.durationTime){p.durationTime=d(p.durationTime)}n.data("settings",p);q.remove()},getSecondsFromMidnight:function(){return d(g(this).val())},getTime:function(){return new Date(f.valueOf()+(d(g(this).val())*1000))},setTime:function(o){var n=g(this);var p=i(d(o),n.data("settings").timeFormat);n.val(p)}};function j(v){var p=v.data("settings");var t=v.siblings(".ui-timepicker-list");if(t&&t.length){t.remove()}t=g("<ul />");t.attr("tabindex",-1);t.addClass("ui-timepicker-list");if(p.className){t.addClass(p.className)}var x=v.css("zIndex");x=(x+0==x)?x+2:2;t.css({display:"none",position:"absolute",left:(v.position().left),zIndex:x});if(p.minTime!==null&&p.showDuration){t.addClass("ui-timepicker-with-duration")}var o=(p.durationTime!==null)?p.durationTime:p.minTime;var n=(p.minTime!==null)?p.minTime:0;var q=(p.maxTime!==null)?p.maxTime:(n+c-1);if(q<=n){q+=c}for(var s=n;s<=q;s+=p.step*60){var u=s%c;var w=g("<li />");w.data("time",u);w.text(i(u,p.timeFormat));if(p.minTime!==null&&p.showDuration){var r=g("<span />");r.addClass("ui-timepicker-duration");r.text(" ("+a(s-o)+")");w.append(r)}t.append(w)}v.after(t);l(v,t);t.delegate("li","click",{timepicker:v},function(y){v.addClass("ui-timepicker-hideme");v[0].focus();t.find("li").removeClass("ui-timepicker-selected");g(this).addClass("ui-timepicker-selected");k(v);t.hide()})}function m(n,r,q){if(!q&&q!==0){return false}var p=n.data("settings");var o=false;r.find("li").each(function(s,u){var t=g(u);if(Math.abs(t.data("time")-q)<=p.step*30){o=t;return false}});return o}function l(n,q){var p=d(n.val());var o=m(n,q,p);if(o&&o.data("time")==p){o.addClass("ui-timepicker-selected")}}function b(q){var n=g(this);var p=n.siblings(".ui-timepicker-list");var o;if(!p.is(":visible")){if(q.keyCode==40){n.focus()}else{return true}}switch(q.keyCode){case 13:k(n);e.hide.apply(this);q.preventDefault();return false;case 38:o=p.find(".ui-timepicker-selected");if(!o.length){p.children().each(function(r,s){if(g(s).position().top>0){o=g(s);return false}});o.addClass("ui-timepicker-selected")}else{if(!o.is(":first-child")){o.removeClass("ui-timepicker-selected");o.prev().addClass("ui-timepicker-selected");if(o.prev().position().top<o.outerHeight()){p.scrollTop(p.scrollTop()-o.outerHeight())}}}break;case 40:o=p.find(".ui-timepicker-selected");if(o.length===0){p.children().each(function(r,s){if(g(s).position().top>0){o=g(s);return false}});o.addClass("ui-timepicker-selected")}else{if(!o.is(":last-child")){o.removeClass("ui-timepicker-selected");o.next().addClass("ui-timepicker-selected");if(o.next().position().top+2*o.outerHeight()>p.outerHeight()){p.scrollTop(p.scrollTop()+o.outerHeight())}}}break;case 27:p.find("li").removeClass("ui-timepicker-selected");p.hide();break;case 9:case 16:case 17:case 18:case 19:case 20:case 33:case 34:case 35:case 36:case 37:case 39:case 45:return;default:p.find("li").removeClass("ui-timepicker-selected");return}}function k(n){var q=n.data("settings");var r=n.siblings(".ui-timepicker-list");var p=null;var s=r.find(".ui-timepicker-selected");if(s.length){p=s.data("time")}else{if(n.val()){p=d(n.val());l(n,r)}}if(p!==null){var o=i(p,q.timeFormat);n.attr("value",o)}n.trigger("change").trigger("changeTime")}function a(p){var o=Math.round(p/60);if(o<60){return o+" mins"}else{if(o==60){return"1 hr"}else{var n=o/60;return n.toFixed(1)+" hrs"}}}function i(t,u){var s=new Date(f.valueOf()+(t*1000));var q="";var p;for(var o=0;o<u.length;o++){var r=u.charAt(o);switch(r){case"a":q+=(s.getHours()>11)?"pm":"am";break;case"A":q+=(s.getHours()>11)?"PM":"AM";break;case"g":var n=s.getHours()%12;q+=(n===0)?"12":n;break;case"G":q+=s.getHours();break;case"h":n=s.getHours()%12;if(n!==0&&n<10){n="0"+n}q+=(n===0)?"12":n;break;case"H":n=s.getHours();q+=(n>9)?n:"0"+n;break;case"i":p=s.getMinutes();q+=(p>9)?p:"0"+p;break;case"s":t=s.getSeconds();q+=(t>9)?t:"0"+t;break;default:q+=r}}return q}function d(q){var o;if(q===""){return null}if(q+0==q){return q}if(typeof(q)=="object"){q=q.getHours()+":"+q.getMinutes()}var s=new Date(0);var r=q.toLowerCase().match(/(\d+)(?::(\d\d))?\s*([pa]?)/);if(!r){return null}var n=parseInt(r[1]*1,10);if(r[3]){if(n==12){o=(r[3]=="p")?12:0}else{o=(n+(r[3]=="p"?12:0))}}else{o=n}var p=(r[2]*1||0);return o*3600+p*60}g.fn.timepicker=function(n){if(e[n]){return e[n].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof n==="object"||!n){return e.init.apply(this,arguments)}else{g.error("Method "+n+" does not exist on jQuery.timepicker")}}}})(jQuery);
(function(a){a.fn.menuAim=function(c){this.each(function(){b.call(this,c)});return this};function b(d){var c=a(this),r=null,f=[],p=null,s=null,n=a.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:a.noop,exit:a.noop,activate:a.noop,deactivate:a.noop,exitMenu:a.noop},d);var k=3,e=300;var m=function(t){f.push({x:t.pageX,y:t.pageY});if(f.length>k){f.shift()}};var q=function(){if(s){clearTimeout(s)}if(n.exitMenu(this)){if(r){n.deactivate(r)}r=null}};var h=function(){if(s){clearTimeout(s)}n.enter(this);i(this)},g=function(){n.exit(this)};var l=function(){j(this)};var j=function(t){if(t==r){return}if(r){n.deactivate(r)}n.activate(t);r=t};var i=function(u){var t=o();if(t){s=setTimeout(function(){i(u)},t)}else{j(u)}};var o=function(){if(!r||!a(r).is(n.submenuSelector)){return 0}var z=c.offset(),t={x:z.left,y:z.top-n.tolerance},G={x:z.left+c.outerWidth(),y:t.y},F={x:z.left,y:z.top+c.outerHeight()+n.tolerance},A={x:z.left+c.outerWidth(),y:F.y},C=f[f.length-1],u=f[0];if(!C){return 0}if(!u){u=C}if(u.x<z.left||u.x>A.x||u.y<z.top||u.y>A.y){return 0}if(p&&C.x==p.x&&C.y==p.y){return 0}function D(I,H){return(H.y-I.y)/(H.x-I.x)}var w=G,x=A;if(n.submenuDirection=="left"){w=F;x=t}else{if(n.submenuDirection=="below"){w=A;x=F}else{if(n.submenuDirection=="above"){w=t;x=G}}}var B=D(C,w),v=D(C,x),E=D(u,w),y=D(u,x);if(B<E&&v>y){p=C;return e}p=null;return 0};c.mouseleave(q).find(n.rowSelector).mouseenter(h).mouseleave(g).click(l);a(document).mousemove(m)}})(jQuery);
(function(f){f.tools=f.tools||{version:"@VERSION"};var c;c=f.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:undefined,vertical:0,keyboard:true,progress:false,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var h,e;f.fn.drag=function(i){i=f.extend({x:true,y:true,drag:true},i);h=h||f(document).on("mousedown mouseup",function(m){var k=f(m.target);if(m.type=="mousedown"&&k.data("drag")){var n=k.position(),j=m.pageX-n.left,l=m.pageY-n.top,o=true;h.on("mousemove.drag",function(r){var p=r.pageX-j,s=r.pageY-l,q={};if(i.x){q.left=p}if(i.y){q.top=s}if(o){k.trigger("dragStart");o=false}if(i.drag){k.css(q)}k.trigger("drag",[s,p]);e=k});m.preventDefault()}else{try{if(e){e.trigger("dragEnd")}}finally{h.off("mousemove.drag");e=null}}});return this.data("drag",true)};function a(j,i){var k=Math.pow(10,i);return Math.round(j*k)/k}function g(l,j){var i=parseInt(l.css(j),10);if(i){return i}var k=l[0].currentStyle;return k&&k.width&&parseInt(k.width,10)}function b(i){var j=i.data("events");return j&&j.onSlide}function d(q,n){var u=this,p=n.css,x=f("<div><div/><a href='#'/></div>").data("rangeinput",u),o,w,k,A,m;q.before(x);var v=x.addClass(p.slider).find("a").addClass(p.handle),j=x.find("div").addClass(p.progress);f.each("min,max,step,value".split(","),function(F,E){var G=q.attr(E);if(parseFloat(G)){n[E]=parseFloat(G,10)}});var t=n.max-n.min,l=n.step=="any"?0:n.step,y=n.precision;if(y===undefined){y=l.toString().split(".");y=y.length===2?y[1].length:0}if(q.attr("type")=="range"){var s=q.clone().wrap("<div/>").parent().html(),B=f(s.replace(/type/i,"type=text data-orig-type"));B.val(n.value);q.replaceWith(B);q=B}q.addClass(p.input);var D=f(u).add(q),r=true;function i(F,E,K,H){if(K===undefined){K=E/A*t}else{if(H){K-=n.min}}if(l){K=Math.round(K/l)*l}if(E===undefined||l){E=K*A/t}if(isNaN(K)){return u}E=Math.max(0,Math.min(E,A));K=E/A*t;if(H||!o){K+=n.min}if(o){if(H){E=A-E}else{K=n.max-K}}K=a(K,y);var J=F.type=="click";if(r&&w!==undefined&&!J){F.type="onSlide";D.trigger(F,[K,E]);if(F.isDefaultPrevented()){return u}}var G=J?n.speed:0,I=J?function(){F.type="change";D.trigger(F,[K])}:null;if(o){v.animate({top:E},G,I);if(n.progress){j.animate({height:A-E+v.height()/2},G)}}else{v.animate({left:E},G,I);if(n.progress){j.animate({width:E+v.width()/2},G)}}w=K;m=E;q.val(K);return u}f.extend(u,{getValue:function(){return w},setValue:function(F,E){z();return i(E||f.Event("api"),undefined,F,true)},getConf:function(){return n},getProgress:function(){return j},getHandle:function(){return v},getInput:function(){return q},step:function(F,G){G=G||f.Event();var E=n.step=="any"?1:n.step;u.setValue(w+E*(F||1),G)},stepUp:function(E){return u.step(E||1)},stepDown:function(E){return u.step(-E||-1)}});f.each("onSlide,change".split(","),function(F,E){if(f.isFunction(n[E])){f(u).on(E,n[E])}u[E]=function(G){if(G){f(u).on(E,G)}return u}});v.drag({drag:false}).on("dragStart",function(){z();r=b(f(u))||b(q)}).on("drag",function(F,G,E){if(q.is(":disabled")){return false}i(F,o?G:E)}).on("dragEnd",function(E){if(!E.isDefaultPrevented()){E.type="change";D.trigger(E,[w])}}).click(function(E){return E.preventDefault()});x.click(function(F){if(q.is(":disabled")||F.target==v[0]){return F.preventDefault()}z();var E=o?v.height()/2:v.width()/2;i(F,o?A-k-E+F.pageY:F.pageX-k-E)});if(n.keyboard){q.keydown(function(G){if(q.attr("readonly")){return}var F=G.keyCode,E=f([75,76,38,33,39]).index(F)!=-1,H=f([74,72,40,34,37]).index(F)!=-1;if((E||H)&&!(G.shiftKey||G.altKey||G.ctrlKey)){if(E){u.step(F==33?10:1,G)}else{if(H){u.step(F==34?-10:-1,G)}}return G.preventDefault()}})}q.blur(function(E){var F=f(this).val();if(F!==w){u.setValue(F,E)}});f.extend(q[0],{stepUp:u.stepUp,stepDown:u.stepDown});function z(){o=n.vertical||g(x,"height")>g(x,"width");if(o){A=g(x,"height")-g(v,"height");k=x.offset().top+A}else{A=g(x,"width")-g(v,"width");k=x.offset().left}}function C(){z();u.setValue(n.value!==undefined?n.value:n.min)}C();if(!A){f(window).load(C)}}f.expr[":"].range=function(j){var i=j.getAttribute("type");return i&&i=="range"||!!f(j).filter("input").data("rangeinput")};f.fn.rangeinput=function(i){if(this.data("rangeinput")){return this}i=f.extend(true,{},c.conf,i);var j;this.each(function(){var l=new d(f(this),f.extend(true,{},i));var k=l.getInput().data("rangeinput",l);j=j?j.add(k):k});return j?j:this}})(jQuery);
(function(d){var k,a,e,f=d(window),b={jqueryui:{container:"ui-widget ui-widget-content ui-corner-all",notice:"ui-state-highlight",notice_icon:"ui-icon ui-icon-info",info:"",info_icon:"ui-icon ui-icon-info",success:"ui-state-default",success_icon:"ui-icon ui-icon-circle-check",error:"ui-state-error",error_icon:"ui-icon ui-icon-alert",closer:"ui-icon ui-icon-close",pin_up:"ui-icon ui-icon-pin-w",pin_down:"ui-icon ui-icon-pin-s",hi_menu:"ui-state-default ui-corner-bottom",hi_btn:"ui-state-default ui-corner-all",hi_btnhov:"ui-state-hover",hi_hnd:"ui-icon ui-icon-grip-dotted-horizontal"},bootstrap:{container:"alert",notice:"",notice_icon:"icon-exclamation-sign",info:"alert-info",info_icon:"icon-info-sign",success:"alert-success",success_icon:"icon-ok-sign",error:"alert-error",error_icon:"icon-warning-sign",closer:"icon-remove",pin_up:"icon-pause",pin_down:"icon-play",hi_menu:"well",hi_btn:"btn",hi_btnhov:"",hi_hnd:"icon-chevron-down"}};var i=function(){e=d("body");f=d(window);f.bind("resize",function(){if(a){clearTimeout(a)}a=setTimeout(d.pnotify_position_all,10)})};if(document.body){i()}else{d(i)}d.extend({pnotify_remove_all:function(){var m=f.data("pnotify");if(m&&m.length){d.each(m,function(){if(this.pnotify_remove){this.pnotify_remove()}})}},pnotify_position_all:function(){if(a){clearTimeout(a)}a=null;var m=f.data("pnotify");if(!m||!m.length){return}d.each(m,function(){var n=this.opts.stack;if(!n){return}n.nextpos1=n.firstpos1;n.nextpos2=n.firstpos2;n.addpos2=0;n.animation=true});d.each(m,function(){this.pnotify_position()})},pnotify:function(t){var w;var m;if(typeof t!="object"){m=d.extend({},d.pnotify.defaults);m.text=t}else{m=d.extend({},d.pnotify.defaults,t)}for(var q in m){if(typeof q=="string"&&q.match(/^pnotify_/)){m[q.replace(/^pnotify_/,"")]=m[q]}}if(m.before_init){if(m.before_init(m)===false){return null}}var r;var p=function(B,z){n.css("display","none");var A=document.elementFromPoint(B.clientX,B.clientY);n.css("display","block");var y=d(A);var x=y.css("cursor");n.css("cursor",x!="auto"?x:"default");if(!r||r.get(0)!=A){if(r){g.call(r.get(0),"mouseleave",B.originalEvent);g.call(r.get(0),"mouseout",B.originalEvent)}g.call(A,"mouseenter",B.originalEvent);g.call(A,"mouseover",B.originalEvent)}g.call(A,z,B.originalEvent);r=y};var u=b[m.styling];var n=d("<div />",{"class":"ui-pnotify "+m.addclass,css:{display:"none"},mouseenter:function(x){if(m.nonblock){x.stopPropagation()}if(m.mouse_reset&&w=="out"){n.stop(true);w="in";n.css("height","auto").animate({width:m.width,opacity:m.nonblock?m.nonblock_opacity:m.opacity},"fast")}if(m.nonblock){n.animate({opacity:m.nonblock_opacity},"fast")}if(m.hide&&m.mouse_reset){n.pnotify_cancel_remove()}if(m.sticker&&!m.nonblock){n.sticker.trigger("pnotify_icon").css("visibility","visible")}if(m.closer&&!m.nonblock){n.closer.css("visibility","visible")}},mouseleave:function(x){if(m.nonblock){x.stopPropagation()}r=null;n.css("cursor","auto");if(m.nonblock&&w!="out"){n.animate({opacity:m.opacity},"fast")}if(m.hide&&m.mouse_reset){n.pnotify_queue_remove()}if(m.sticker_hover){n.sticker.css("visibility","hidden")}if(m.closer_hover){n.closer.css("visibility","hidden")}d.pnotify_position_all()},mouseover:function(x){if(m.nonblock){x.stopPropagation()}},mouseout:function(x){if(m.nonblock){x.stopPropagation()}},mousemove:function(x){if(m.nonblock){x.stopPropagation();p(x,"onmousemove")}},mousedown:function(x){if(m.nonblock){x.stopPropagation();x.preventDefault();p(x,"onmousedown")}},mouseup:function(x){if(m.nonblock){x.stopPropagation();x.preventDefault();p(x,"onmouseup")}},click:function(x){if(m.nonblock){x.stopPropagation();p(x,"onclick")}},dblclick:function(x){if(m.nonblock){x.stopPropagation();p(x,"ondblclick")}}});n.opts=m;n.container=d("<div />",{"class":u.container+" ui-pnotify-container "+(m.type=="error"?u.error:(m.type=="info"?u.info:(m.type=="success"?u.success:u.notice)))}).appendTo(n);if(m.cornerclass!=""){n.container.removeClass("ui-corner-all").addClass(m.cornerclass)}if(m.shadow){n.container.addClass("ui-pnotify-shadow")}n.pnotify_version="1.2.0";n.pnotify=function(y){var z=m;if(typeof y=="string"){m.text=y}else{m=d.extend({},m,y)}for(var x in m){if(typeof x=="string"&&x.match(/^pnotify_/)){m[x.replace(/^pnotify_/,"")]=m[x]}}n.opts=m;if(m.cornerclass!=z.cornerclass){n.container.removeClass("ui-corner-all").addClass(m.cornerclass)}if(m.shadow!=z.shadow){if(m.shadow){n.container.addClass("ui-pnotify-shadow")}else{n.container.removeClass("ui-pnotify-shadow")}}if(m.addclass===false){n.removeClass(z.addclass)}else{if(m.addclass!==z.addclass){n.removeClass(z.addclass).addClass(m.addclass)}}if(m.title===false){n.title_container.slideUp("fast")}else{if(m.title!==z.title){if(m.title_escape){n.title_container.text(m.title).slideDown(200)}else{n.title_container.html(m.title).slideDown(200)}}}if(m.text===false){n.text_container.slideUp("fast")}else{if(m.text!==z.text){if(m.text_escape){n.text_container.text(m.text).slideDown(200)}else{n.text_container.html(m.insert_brs?String(m.text).replace(/\n/g,"<br />"):m.text).slideDown(200)}}}n.pnotify_history=m.history;n.pnotify_hide=m.hide;if(m.type!=z.type){n.container.removeClass(u.error+" "+u.notice+" "+u.success+" "+u.info).addClass(m.type=="error"?u.error:(m.type=="info"?u.info:(m.type=="success"?u.success:u.notice)))}if(m.icon!==z.icon||(m.icon===true&&m.type!=z.type)){n.container.find("div.ui-pnotify-icon").remove();if(m.icon!==false){d("<div />",{"class":"ui-pnotify-icon"}).append(d("<span />",{"class":m.icon===true?(m.type=="error"?u.error_icon:(m.type=="info"?u.info_icon:(m.type=="success"?u.success_icon:u.notice_icon))):m.icon})).prependTo(n.container)}}if(m.width!==z.width){n.animate({width:m.width})}if(m.min_height!==z.min_height){n.container.animate({minHeight:m.min_height})}if(m.opacity!==z.opacity){n.fadeTo(m.animate_speed,m.opacity)}if(!m.closer||m.nonblock){n.closer.css("display","none")}else{n.closer.css("display","block")}if(!m.sticker||m.nonblock){n.sticker.css("display","none")}else{n.sticker.css("display","block")}n.sticker.trigger("pnotify_icon");if(m.sticker_hover){n.sticker.css("visibility","hidden")}else{if(!m.nonblock){n.sticker.css("visibility","visible")}}if(m.closer_hover){n.closer.css("visibility","hidden")}else{if(!m.nonblock){n.closer.css("visibility","visible")}}if(!m.hide){n.pnotify_cancel_remove()}else{if(!z.hide){n.pnotify_queue_remove()}}n.pnotify_queue_position();return n};n.pnotify_position=function(y){var C=n.opts.stack;if(!C){return}if(!C.nextpos1){C.nextpos1=C.firstpos1}if(!C.nextpos2){C.nextpos2=C.firstpos2}if(!C.addpos2){C.addpos2=0}var x=n.css("display")=="none";if(!x||y){var E,D;var B={};var A;switch(C.dir1){case"down":A="top";break;case"up":A="bottom";break;case"left":A="right";break;case"right":A="left";break}E=parseInt(n.css(A));if(isNaN(E)){E=0}if(typeof C.firstpos1=="undefined"&&!x){C.firstpos1=E;C.nextpos1=C.firstpos1}var z;switch(C.dir2){case"down":z="top";break;case"up":z="bottom";break;case"left":z="right";break;case"right":z="left";break}D=parseInt(n.css(z));if(isNaN(D)){D=0}if(typeof C.firstpos2=="undefined"&&!x){C.firstpos2=D;C.nextpos2=C.firstpos2}if((C.dir1=="down"&&C.nextpos1+n.height()>f.height())||(C.dir1=="up"&&C.nextpos1+n.height()>f.height())||(C.dir1=="left"&&C.nextpos1+n.width()>f.width())||(C.dir1=="right"&&C.nextpos1+n.width()>f.width())){C.nextpos1=C.firstpos1;C.nextpos2+=C.addpos2+(typeof C.spacing2=="undefined"?25:C.spacing2);C.addpos2=0}if(C.animation&&C.nextpos2<D){switch(C.dir2){case"down":B.top=C.nextpos2+"px";break;case"up":B.bottom=C.nextpos2+"px";break;case"left":B.right=C.nextpos2+"px";break;case"right":B.left=C.nextpos2+"px";break}}else{n.css(z,C.nextpos2+"px")}switch(C.dir2){case"down":case"up":if(n.outerHeight(true)>C.addpos2){C.addpos2=n.height()}break;case"left":case"right":if(n.outerWidth(true)>C.addpos2){C.addpos2=n.width()}break}if(C.nextpos1){if(C.animation&&(E>C.nextpos1||B.top||B.bottom||B.right||B.left)){switch(C.dir1){case"down":B.top=C.nextpos1+"px";break;case"up":B.bottom=C.nextpos1+"px";break;case"left":B.right=C.nextpos1+"px";break;case"right":B.left=C.nextpos1+"px";break}}else{n.css(A,C.nextpos1+"px")}}if(B.top||B.bottom||B.right||B.left){n.animate(B,{duration:500,queue:false})}switch(C.dir1){case"down":case"up":C.nextpos1+=n.height()+(typeof C.spacing1=="undefined"?25:C.spacing1);break;case"left":case"right":C.nextpos1+=n.width()+(typeof C.spacing1=="undefined"?25:C.spacing1);break}}};n.pnotify_queue_position=function(x){if(a){clearTimeout(a)}if(!x){x=10}a=setTimeout(d.pnotify_position_all,x)};n.pnotify_display=function(){if(!n.parent().length){n.appendTo(e)}if(m.before_open){if(m.before_open(n)===false){return}}if(m.stack.push!="top"){n.pnotify_position(true)}if(m.animation=="fade"||m.animation.effect_in=="fade"){n.show().fadeTo(0,0).hide()}else{if(m.opacity!=1){n.show().fadeTo(0,m.opacity).hide()}}n.animate_in(function(){if(m.after_open){m.after_open(n)}n.pnotify_queue_position();if(m.hide){n.pnotify_queue_remove()}})};n.pnotify_remove=function(){if(n.timer){window.clearTimeout(n.timer);n.timer=null}if(m.before_close){if(m.before_close(n)===false){return}}n.animate_out(function(){if(m.after_close){if(m.after_close(n)===false){return}}n.pnotify_queue_position();if(m.remove){n.detach()}})};n.animate_in=function(y){w="in";var x;if(typeof m.animation.effect_in!="undefined"){x=m.animation.effect_in}else{x=m.animation}if(x=="none"){n.show();y()}else{if(x=="show"){n.show(m.animate_speed,y)}else{if(x=="fade"){n.show().fadeTo(m.animate_speed,m.opacity,y)}else{if(x=="slide"){n.slideDown(m.animate_speed,y)}else{if(typeof x=="function"){x("in",y,n)}else{n.show(x,(typeof m.animation.options_in=="object"?m.animation.options_in:{}),m.animate_speed,y)}}}}}};n.animate_out=function(y){w="out";var x;if(typeof m.animation.effect_out!="undefined"){x=m.animation.effect_out}else{x=m.animation}if(x=="none"){n.hide();y()}else{if(x=="show"){n.hide(m.animate_speed,y)}else{if(x=="fade"){n.fadeOut(m.animate_speed,y)}else{if(x=="slide"){n.slideUp(m.animate_speed,y)}else{if(typeof x=="function"){x("out",y,n)}else{n.hide(x,(typeof m.animation.options_out=="object"?m.animation.options_out:{}),m.animate_speed,y)}}}}}};n.pnotify_cancel_remove=function(){if(n.timer){window.clearTimeout(n.timer)}};n.pnotify_queue_remove=function(){n.pnotify_cancel_remove();n.timer=window.setTimeout(function(){n.pnotify_remove()},(isNaN(m.delay)?0:m.delay))};n.closer=d("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",visibility:m.closer_hover?"hidden":"visible"},click:function(){n.pnotify_remove();n.sticker.css("visibility","hidden");n.closer.css("visibility","hidden")}}).append(d("<span />",{"class":u.closer})).appendTo(n.container);if(!m.closer||m.nonblock){n.closer.css("display","none")}n.sticker=d("<div />",{"class":"ui-pnotify-sticker",css:{cursor:"pointer",visibility:m.sticker_hover?"hidden":"visible"},click:function(){m.hide=!m.hide;if(m.hide){n.pnotify_queue_remove()}else{n.pnotify_cancel_remove()}d(this).trigger("pnotify_icon")}}).bind("pnotify_icon",function(){d(this).children().removeClass(u.pin_up+" "+u.pin_down).addClass(m.hide?u.pin_up:u.pin_down)}).append(d("<span />",{"class":u.pin_up})).appendTo(n.container);if(!m.sticker||m.nonblock){n.sticker.css("display","none")}if(m.icon!==false){d("<div />",{"class":"ui-pnotify-icon"}).append(d("<span />",{"class":m.icon===true?(m.type=="error"?u.error_icon:(m.type=="info"?u.info_icon:(m.type=="success"?u.success_icon:u.notice_icon))):m.icon})).prependTo(n.container)}n.title_container=d("<h4 />",{"class":"ui-pnotify-title"}).appendTo(n.container);if(m.title===false){n.title_container.hide()}else{if(m.title_escape){n.title_container.text(m.title)}else{n.title_container.html(m.title)}}n.text_container=d("<div />",{"class":"ui-pnotify-text"}).appendTo(n.container);if(m.text===false){n.text_container.hide()}else{if(m.text_escape){n.text_container.text(m.text)}else{n.text_container.html(m.insert_brs?String(m.text).replace(/\n/g,"<br />"):m.text)}}if(typeof m.width=="string"){n.css("width",m.width)}if(typeof m.min_height=="string"){n.container.css("min-height",m.min_height)}n.pnotify_history=m.history;n.pnotify_hide=m.hide;var v=f.data("pnotify");if(v==null||typeof v!="object"){v=[]}if(m.stack.push=="top"){v=d.merge([n],v)}else{v=d.merge(v,[n])}f.data("pnotify",v);if(m.stack.push=="top"){n.pnotify_queue_position(1)}if(m.after_init){m.after_init(n)}if(m.history){var s=f.data("pnotify_history");if(typeof s=="undefined"){s=d("<div />",{"class":"ui-pnotify-history-container "+u.hi_menu,mouseleave:function(){s.animate({top:"-"+k+"px"},{duration:100,queue:false})}}).append(d("<div />",{"class":"ui-pnotify-history-header",text:"Redisplay"})).append(d("<button />",{"class":"ui-pnotify-history-all "+u.hi_btn,text:"All",mouseenter:function(){d(this).addClass(u.hi_btnhov)},mouseleave:function(){d(this).removeClass(u.hi_btnhov)},click:function(){d.each(v,function(){if(this.pnotify_history){if(this.is(":visible")){if(this.pnotify_hide){this.pnotify_queue_remove()}}else{if(this.pnotify_display){this.pnotify_display()}}}});return false}})).append(d("<button />",{"class":"ui-pnotify-history-last "+u.hi_btn,text:"Last",mouseenter:function(){d(this).addClass(u.hi_btnhov)},mouseleave:function(){d(this).removeClass(u.hi_btnhov)},click:function(){var y=-1;var x;do{if(y==-1){x=v.slice(y)}else{x=v.slice(y,y+1)}if(!x[0]){break}y--}while(!x[0].pnotify_history||x[0].is(":visible"));if(!x[0]){return false}if(x[0].pnotify_display){x[0].pnotify_display()}return false}})).appendTo(e);var o=d("<span />",{"class":"ui-pnotify-history-pulldown "+u.hi_hnd,mouseenter:function(){s.animate({top:"0"},{duration:100,queue:false})}}).appendTo(s);k=o.offset().top+2;s.css({top:"-"+k+"px"});f.data("pnotify_history",s)}}m.stack.animation=false;n.pnotify_display();return n}});var l=/^on/,c=/^(dbl)?click$|^mouse(move|down|up|over|out|enter|leave)$|^contextmenu$/,j=/^(focus|blur|select|change|reset)$|^key(press|down|up)$/,h=/^(scroll|resize|(un)?load|abort|error)$/;var g=function(n,m){var o;n=n.toLowerCase();if(document.createEvent&&this.dispatchEvent){n=n.replace(l,"");if(n.match(c)){d(this).offset();o=document.createEvent("MouseEvents");o.initMouseEvent(n,m.bubbles,m.cancelable,m.view,m.detail,m.screenX,m.screenY,m.clientX,m.clientY,m.ctrlKey,m.altKey,m.shiftKey,m.metaKey,m.button,m.relatedTarget)}else{if(n.match(j)){o=document.createEvent("UIEvents");o.initUIEvent(n,m.bubbles,m.cancelable,m.view,m.detail)}else{if(n.match(h)){o=document.createEvent("HTMLEvents");o.initEvent(n,m.bubbles,m.cancelable)}}}if(!o){return}this.dispatchEvent(o)}else{if(!n.match(l)){n="on"+n}o=document.createEventObject(m);this.fireEvent(n,o)}};d.pnotify.defaults={title:false,title_escape:false,text:false,text_escape:false,styling:"bootstrap",addclass:"",cornerclass:"",nonblock:false,nonblock_opacity:0.2,history:true,width:"300px",min_height:"16px",type:"notice",icon:true,animation:"fade",animate_speed:"slow",opacity:1,shadow:true,closer:true,closer_hover:true,sticker:true,sticker_hover:true,hide:true,delay:8000,mouse_reset:true,remove:true,insert_brs:true,stack:{dir1:"down",dir2:"left",push:"bottom",spacing1:25,spacing2:25}}})(jQuery);
/*!
 * jQuery Cookie Plugin v1.2
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f,a,g){var e=/\+/g;function c(h){return h}function b(h){return decodeURIComponent(h.replace(e," "))}var d=f.cookie=function(o,n,m){if(n!==g){m=f.extend({},d.defaults,m);if(n===null){m.expires=-1}if(typeof m.expires==="number"){var q=m.expires,r=m.expires=new Date();r.setDate(r.getDate()+q)}n=d.json?JSON.stringify(n):String(n);return(a.cookie=[encodeURIComponent(o),"=",d.raw?n:encodeURIComponent(n),m.expires?"; expires="+m.expires.toUTCString():"",m.path?"; path="+m.path:"",m.domain?"; domain="+m.domain:"",m.secure?"; secure":""].join(""))}var l=d.raw?c:b;var p=a.cookie.split("; ");for(var j=0,h;(h=p[j]&&p[j].split("="));j++){if(l(h.shift())===o){var k=l(h.join("="));return d.json?JSON.parse(k):k}}return null};d.defaults={};f.removeCookie=function(i,h){if(f.cookie(i)!==null){f.cookie(i,null,h);return true}return false}})(jQuery,document);
/*!
 * toggleAttr() jQuery plugin
 * @link http://github.com/mathiasbynens/toggleAttr-jQuery-Plugin
 * @description Used to toggle selected="selected", disabled="disabled", checked="checked" etc
 * @author Mathias Bynens <http://mathiasbynens.be/>
 */
jQuery.fn.toggleAttr=function(a){return this.each(function(){var b=$(this);b.attr(a)?b.removeAttr(a):b.attr(a,a)})};
!function(a){a(function(){a.support.transition=(function(){var b=(function(){var e=document.createElement("bootstrap"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},d;for(d in c){if(e.style[d]!==undefined){return c[d]}}}());return b&&{end:b}})()})}(window.jQuery);!function(e){var b=function(i,h){this.options=h;this.$element=e(i).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};b.prototype={constructor:b,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var h=this,i=e.Event("show");this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented()){return}e("body").addClass("modal-open");this.isShown=true;a.call(this);d.call(this,function(){var j=e.support.transition&&h.$element.hasClass("fade");if(!h.$element.parent().length){h.$element.appendTo(document.body)}h.$element.show();if(j){h.$element[0].offsetWidth}h.$element.addClass("in");j?h.$element.one(e.support.transition.end,function(){h.$element.trigger("shown")}):h.$element.trigger("shown")})},hide:function(i){i&&i.preventDefault();var h=this;i=e.Event("hide");this.$element.trigger(i);if(!this.isShown||i.isDefaultPrevented()){return}this.isShown=false;e("body").removeClass("modal-open");a.call(this);this.$element.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?g.call(this):f.call(this)}};function g(){var i=this,h=setTimeout(function(){i.$element.off(e.support.transition.end);f.call(i)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(h);f.call(i)})}function f(h){this.$element.hide().trigger("hidden");d.call(this)}function d(k){var j=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var h=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body);if(this.options.backdrop!="static"){this.$backdrop.click(e.proxy(this.hide,this))}if(h){this.$backdrop[0].offsetWidth}this.$backdrop.addClass("in");h?this.$backdrop.one(e.support.transition.end,k):k()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(c,this)):c.call(this)}else{if(k){k()}}}}function c(){this.$backdrop.remove();this.$backdrop=null}function a(){var h=this;if(this.isShown&&this.options.keyboard){e(document).on("keyup.dismiss.modal",function(i){i.which==27&&h.hide()})}else{if(!this.isShown){e(document).off("keyup.dismiss.modal")}}}e.fn.modal=function(h){return this.each(function(){var k=e(this),j=k.data("modal"),i=e.extend({},e.fn.modal.defaults,k.data(),typeof h=="object"&&h);if(!j){k.data("modal",(j=new b(this,i)))}if(typeof h=="string"){j[h]()}else{if(i.show){j.show()}}})};e.fn.modal.defaults={backdrop:true,keyboard:true,show:true};e.fn.modal.Constructor=b;e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(l){var k=e(this),j,h=e(k.attr("data-target")||(j=k.attr("href"))&&j.replace(/.*(?=#[^\s]+$)/,"")),i=h.data("modal")?"toggle":e.extend({},h.data(),k.data());l.preventDefault();h.modal(i)})})}(window.jQuery);!function(d){var c='[data-toggle="dropdown"]',b=function(e){var f=d(e).on("click.dropdown.data-api",this.toggle);d("html").on("click.dropdown.data-api",function(){f.parent().removeClass("open")})};b.prototype={constructor:b,toggle:function(j){var i=d(this),h,f,g;if(i.is(".disabled, :disabled")){return}f=i.attr("data-target");if(!f){f=i.attr("href");f=f&&f.replace(/.*(?=#[^\s]*$)/,"")}h=d(f);h.length||(h=i.parent());g=h.hasClass("open");a();if(!g){h.toggleClass("open")}return false}};function a(){d(c).parent().removeClass("open")}d.fn.dropdown=function(e){return this.each(function(){var g=d(this),f=g.data("dropdown");if(!f){g.data("dropdown",(f=new b(this)))}if(typeof e=="string"){f[e].call(g)}})};d.fn.dropdown.Constructor=b;d(function(){d("html").on("click.dropdown.data-api",a);d("body").on("click.dropdown",".dropdown form",function(f){f.stopPropagation()}).on("click.dropdown.data-api",c,b.prototype.toggle)})}(window.jQuery);!function(b){function a(e,f){var g=b.proxy(this.process,this),c=b(e).is("body")?b(window):b(e),d;this.options=b.extend({},b.fn.scrollspy.defaults,f);this.$scrollElement=c.on("scroll.scroll.data-api",g);this.selector=(this.options.target||((d=b(e).attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";this.$body=b("body");this.refresh();this.process()}a.prototype={constructor:a,refresh:function(){var c=this,d;this.offsets=b([]);this.targets=b([]);d=this.$body.find(this.selector).map(function(){var f=b(this),e=f.data("target")||f.attr("href"),g=/^#\w/.test(e)&&b(e);return(g&&e.length&&[[g.position().top,e]])||null}).sort(function(f,e){return f[0]-e[0]}).each(function(){c.offsets.push(this[0]);c.targets.push(this[1])})},process:function(){var h=this.$scrollElement.scrollTop()+this.options.offset,e=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=e-this.$scrollElement.height(),c=this.offsets,g=this.targets,j=this.activeTarget,f;if(h>=d){return j!=(f=g.last()[0])&&this.activate(f)}for(f=c.length;f--;){j!=g[f]&&h>=c[f]&&(!c[f+1]||h<=c[f+1])&&this.activate(g[f])}},activate:function(e){var d,c;this.activeTarget=e;b(this.selector).parent(".active").removeClass("active");c=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]';d=b(c).parent("li").addClass("active");if(d.parent(".dropdown-menu")){d=d.closest("li.dropdown").addClass("active")}d.trigger("activate")}};b.fn.scrollspy=function(c){return this.each(function(){var f=b(this),e=f.data("scrollspy"),d=typeof c=="object"&&c;if(!e){f.data("scrollspy",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.scrollspy.Constructor=a;b.fn.scrollspy.defaults={offset:10};b(function(){b('[data-spy="scroll"]').each(function(){var c=b(this);c.scrollspy(c.data())})})}(window.jQuery);!function(b){var a=function(c){this.element=b(c)};a.prototype={constructor:a,show:function(){var i=this.element,g=i.closest("ul:not(.dropdown-menu)"),d=i.attr("data-target"),f,c,h;if(!d){d=i.attr("href");d=d&&d.replace(/.*(?=#[^\s]*$)/,"")}if(i.parent("li").hasClass("active")){return}f=g.find(".active a").last()[0];h=b.Event("show",{relatedTarget:f});i.trigger(h);if(h.isDefaultPrevented()){return}c=b(d);this.activate(i.parent("li"),g);this.activate(c,c.parent(),function(){i.trigger({type:"shown",relatedTarget:f})})},activate:function(d,f,g){var c=f.find("> .active"),h=g&&b.support.transition&&c.hasClass("fade");function e(){c.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");d.addClass("active");if(h){d[0].offsetWidth;d.addClass("in")}else{d.removeClass("fade")}if(d.parent(".dropdown-menu")){d.closest("li.dropdown").addClass("active")}g&&g()}h?c.one(b.support.transition.end,e):e();c.removeClass("in")}};b.fn.tab=function(c){return this.each(function(){var e=b(this),d=e.data("tab");if(!d){e.data("tab",(d=new a(this)))}if(typeof c=="string"){d[c]()}})};b.fn.tab.Constructor=a;b(function(){b("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(c){c.preventDefault();b(this).tab("show")})})}(window.jQuery);!function(b){var a=function(c,d){this.init("tooltip",c,d)};a.prototype={constructor:a,init:function(g,e,f){var c,d;this.type=g;this.$element=b(e);this.options=this.getOptions(f);this.enabled=true;if(this.options.trigger!="manual"){c=this.options.trigger=="hover"?"mouseenter":"focus";d=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(c,this.options.selector,b.proxy(this.enter,this));this.$element.on(d,this.options.selector,b.proxy(this.leave,this))}this.options.selector?(this._options=b.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());if(c.delay&&typeof c.delay=="number"){c.delay={show:c.delay,hide:c.delay}}return c},enter:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show){return c.show()}clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){if(c.hoverState=="in"){c.show()}},c.options.delay.show)},leave:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout)}if(!c.options.delay||!c.options.delay.hide){return c.hide()}c.hoverState="out";this.timeout=setTimeout(function(){if(c.hoverState=="out"){c.hide()}},c.options.delay.hide)},show:function(){var g,d,i,e,h,c,f;if(this.hasContent()&&this.enabled){g=this.tip();this.setContent();if(this.options.animation){g.addClass("fade")}c=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement;d=/in/.test(c);g.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body);i=this.getPosition(d);e=g[0].offsetWidth;h=g[0].offsetHeight;switch(d?c.split(" ")[1]:c){case"bottom":f={top:i.top+i.height,left:i.left+i.width/2-e/2};break;case"top":f={top:i.top-h,left:i.left+i.width/2-e/2};break;case"left":f={top:i.top+i.height/2-h/2,left:i.left-e};break;case"right":f={top:i.top+i.height/2-h/2,left:i.left+i.width};break}g.css(f).addClass(c).addClass("in")}},isHTML:function(c){return typeof c!="string"||(c.charAt(0)==="<"&&c.charAt(c.length-1)===">"&&c.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(c)},setContent:function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.isHTML(c)?"html":"text"](c);d.removeClass("fade in top bottom left right")},hide:function(){var c=this,d=this.tip();d.removeClass("in");function e(){var f=setTimeout(function(){d.off(b.support.transition.end).remove()},500);d.one(b.support.transition.end,function(){clearTimeout(f);d.remove()})}b.support.transition&&this.$tip.hasClass("fade")?e():d.remove()},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("data-original-title"))!="string"){c.attr("data-original-title",c.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},(c?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,c=this.$element,d=this.options;e=c.attr("data-original-title")||(typeof d.title=="function"?d.title.call(c[0]):d.title);return e},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),e=f.data("tooltip"),d=typeof c=="object"&&c;if(!e){f.data("tooltip",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);!function(b){var a=function(c,d){this.init("popover",c,d)};a.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:a,setContent:function(){var e=this.tip(),d=this.getTitle(),c=this.getContent();e.find(".popover-title")[this.isHTML(d)?"html":"text"](d);e.find(".popover-content > *")[this.isHTML(c)?"html":"text"](c);e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var d,c=this.$element,e=this.options;d=c.attr("data-content")||(typeof e.content=="function"?e.content.call(c[0]):e.content);return d},tip:function(){if(!this.$tip){this.$tip=b(this.options.template)}return this.$tip}});b.fn.popover=function(c){return this.each(function(){var f=b(this),e=f.data("popover"),d=typeof c=="object"&&c;if(!e){f.data("popover",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.popover.Constructor=a;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function(c){var b='[data-dismiss="alert"]',a=function(d){c(d).on("click",b,this.close)};a.prototype.close=function(i){var h=c(this),d=h.attr("data-target"),g;if(!d){d=h.attr("href");d=d&&d.replace(/.*(?=#[^\s]*$)/,"")}g=c(d);i&&i.preventDefault();g.length||(g=h.hasClass("alert")?h:h.parent());g.trigger(i=c.Event("close"));if(i.isDefaultPrevented()){return}g.removeClass("in");function f(){g.trigger("closed").remove()}c.support.transition&&g.hasClass("fade")?g.on(c.support.transition.end,f):f()};c.fn.alert=function(d){return this.each(function(){var f=c(this),e=f.data("alert");if(!e){f.data("alert",(e=new a(this)))}if(typeof d=="string"){e[d].call(f)}})};c.fn.alert.Constructor=a;c(function(){c("body").on("click.alert.data-api",b,a.prototype.close)})}(window.jQuery);!function(b){var a=function(c,d){this.$element=b(c);this.options=b.extend({},b.fn.button.defaults,d)};a.prototype.setState=function(f){var h="disabled",c=this.$element,e=c.data(),g=c.is("input")?"val":"html";f=f+"Text";e.resetText||c.data("resetText",c[g]());c[g](e[f]||this.options[f]);setTimeout(function(){f=="loadingText"?c.addClass(h).attr(h,h):c.removeClass(h).removeAttr(h)},0)};a.prototype.toggle=function(){var c=this.$element.parent('[data-toggle="buttons-radio"]');c&&c.find(".active").removeClass("active");this.$element.toggleClass("active")};b.fn.button=function(c){return this.each(function(){var f=b(this),e=f.data("button"),d=typeof c=="object"&&c;if(!e){f.data("button",(e=new a(this,d)))}if(c=="toggle"){e.toggle()}else{if(c){e.setState(c)}}})};b.fn.button.defaults={loadingText:"loading..."};b.fn.button.Constructor=a;b(function(){b("body").on("click.button.data-api","[data-toggle^=button]",function(d){var c=b(d.target);if(!c.hasClass("btn")){c=c.closest(".btn")}c.button("toggle")})})}(window.jQuery);!function(a){var b=function(c,d){this.$element=a(c);this.options=a.extend({},a.fn.collapse.defaults,d);if(this.options.parent){this.$parent=a(this.options.parent)}this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var c=this.$element.hasClass("width");return c?"width":"height"},show:function(){var f,e,c,d;if(this.transitioning){return}f=this.dimension();e=a.camelCase(["scroll",f].join("-"));c=this.$parent&&this.$parent.find("> .accordion-group > .in");if(c&&c.length){d=c.data("collapse");if(d&&d.transitioning){return}c.collapse("hide");d||c.data("collapse",null)}this.$element[f](0);this.transition("addClass",a.Event("show"),"shown");this.$element[f](this.$element[0][e])},hide:function(){var c;if(this.transitioning){return}c=this.dimension();this.reset(this.$element[c]());this.transition("removeClass",a.Event("hide"),"hidden");this.$element[c](0)},reset:function(c){var d=this.dimension();this.$element.removeClass("collapse")[d](c||"auto")[0].offsetWidth;this.$element[c!==null?"addClass":"removeClass"]("collapse");return this},transition:function(g,f,c){var e=this,d=function(){if(f.type=="show"){e.reset()}e.transitioning=0;e.$element.trigger(c)};this.$element.trigger(f);if(f.isDefaultPrevented()){return}this.transitioning=1;this.$element[g]("in");a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,d):d()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};a.fn.collapse=function(c){return this.each(function(){var f=a(this),e=f.data("collapse"),d=typeof c=="object"&&c;if(!e){f.data("collapse",(e=new b(this,d)))}if(typeof c=="string"){e[c]()}})};a.fn.collapse.defaults={toggle:true};a.fn.collapse.Constructor=b;a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(g){var f=a(this),d,h=f.attr("data-target")||g.preventDefault()||(d=f.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),c=a(h).data("collapse")?"toggle":f.data();a(h).collapse(c)})})}(window.jQuery);!function(a){var b=function(c,d){this.$element=a(c);this.options=d;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.prototype={cycle:function(c){if(!c){this.paused=false}this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval));return this},to:function(g){var c=this.$element.find(".active"),d=c.parent().children(),e=d.index(c),f=this;if(g>(d.length-1)||g<0){return}if(this.sliding){return this.$element.one("slid",function(){f.to(g)})}if(e==g){return this.pause().cycle()}return this.slide(g>e?"next":"prev",a(d[g]))},pause:function(c){if(!c){this.paused=true}clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding){return}return this.slide("next")},prev:function(){if(this.sliding){return}return this.slide("prev")},slide:function(j,d){var k=this.$element.find(".active"),c=d||k[j](),i=this.interval,l=j=="next"?"left":"right",f=j=="next"?"first":"last",g=this,h=a.Event("slide");this.sliding=true;i&&this.pause();c=c.length?c:this.$element.find(".item")[f]();if(c.hasClass("active")){return}if(a.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(h);if(h.isDefaultPrevented()){return}c.addClass(j);c[0].offsetWidth;k.addClass(l);c.addClass(l);this.$element.one(a.support.transition.end,function(){c.removeClass([j,l].join(" ")).addClass("active");k.removeClass(["active",l].join(" "));g.sliding=false;setTimeout(function(){g.$element.trigger("slid")},0)})}else{this.$element.trigger(h);if(h.isDefaultPrevented()){return}k.removeClass("active");c.addClass("active");this.sliding=false;this.$element.trigger("slid")}i&&this.cycle();return this}};a.fn.carousel=function(c){return this.each(function(){var f=a(this),e=f.data("carousel"),d=a.extend({},a.fn.carousel.defaults,typeof c=="object"&&c);if(!e){f.data("carousel",(e=new b(this,d)))}if(typeof c=="number"){e.to(c)}else{if(typeof c=="string"||(c=d.slide)){e[c]()}else{if(d.interval){e.cycle()}}}})};a.fn.carousel.defaults={interval:5000,pause:"hover"};a.fn.carousel.Constructor=b;a(function(){a("body").on("click.carousel.data-api","[data-slide]",function(h){var g=a(this),d,c=a(g.attr("data-target")||(d=g.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=!c.data("modal")&&a.extend({},c.data(),g.data());c.carousel(f);h.preventDefault()})})}(window.jQuery);
!function(d){function f(){return new Date(Date.UTC.apply(Date,arguments))}function c(){var g=new Date();return f(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate())}var b=function(g,h){var i=this;this.element=d(g);this.language=h.language||this.element.data("date-language")||"en";this.language=this.language in e?this.language:this.language.split("-")[0];this.language=this.language in e?this.language:"en";this.isRTL=e[this.language].rtl||false;this.format=a.parseFormat(h.format||this.element.data("date-format")||e[this.language].format||"mm/dd/yyyy");this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false}this._attachEvents();this.forceParse=true;if("forceParse" in h){this.forceParse=h.forceParse}else{if("dateForceParse" in this.element.data()){this.forceParse=this.element.data("date-force-parse")}}this.picker=d(a.template).appendTo(this.isInline?this.element:"body").on({click:d.proxy(this.click,this),mousedown:d.proxy(this.mousedown,this)});if(this.isInline){this.picker.addClass("datepicker-inline")}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}if(this.isRTL){this.picker.addClass("datepicker-rtl");this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")}d(document).on("mousedown",function(j){if(d(j.target).closest(".datepicker.datepicker-inline, .datepicker.datepicker-dropdown").length===0){i.hide()}});this.autoclose=false;if("autoclose" in h){this.autoclose=h.autoclose}else{if("dateAutoclose" in this.element.data()){this.autoclose=this.element.data("date-autoclose")}}this.keyboardNavigation=true;if("keyboardNavigation" in h){this.keyboardNavigation=h.keyboardNavigation}else{if("dateKeyboardNavigation" in this.element.data()){this.keyboardNavigation=this.element.data("date-keyboard-navigation")}}this.viewMode=this.startViewMode=0;switch(h.startView||this.element.data("date-start-view")){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break}this.todayBtn=(h.todayBtn||this.element.data("date-today-btn")||false);this.todayHighlight=(h.todayHighlight||this.element.data("date-today-highlight")||false);this.calendarWeeks=false;if("calendarWeeks" in h){this.calendarWeeks=h.calendarWeeks}else{if("dateCalendarWeeks" in this.element.data()){this.calendarWeeks=this.element.data("date-calendar-weeks")}}if(this.calendarWeeks){this.picker.find("tfoot th.today").attr("colspan",function(j,k){return parseInt(k)+1})}this.weekStart=((h.weekStart||this.element.data("date-weekstart")||e[this.language].weekStart||0)%7);this.weekEnd=((this.weekStart+6)%7);this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(h.startDate||this.element.data("date-startdate"));this.setEndDate(h.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(h.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show()}};b.prototype={constructor:b,_events:[],_attachEvents:function(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:d.proxy(this.show,this),keyup:d.proxy(this.update,this),keydown:d.proxy(this.keydown,this)}]]}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:d.proxy(this.show,this),keyup:d.proxy(this.update,this),keydown:d.proxy(this.keydown,this)}],[this.component,{click:d.proxy(this.show,this)}]]}else{if(this.element.is("div")){this.isInline=true}else{this._events=[[this.element,{click:d.proxy(this.show,this)}]]}}}for(var g=0,h,j;g<this._events.length;g++){h=this._events[g][0];j=this._events[g][1];h.on(j)}},_detachEvents:function(){for(var g=0,h,j;g<this._events.length;g++){h=this._events[g][0];j=this._events[g][1];h.off(j)}this._events=[]},show:function(g){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();d(window).on("resize",d.proxy(this.place,this));if(g){g.stopPropagation();g.preventDefault()}this.element.trigger({type:"show",date:this.date})},hide:function(g){if(this.isInline){return}if(!this.picker.is(":visible")){return}this.picker.hide();d(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){d(document).off("mousedown",this.hide)}if(this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())){this.setValue()}this.element.trigger({type:"hide",date:this.date})},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker},getDate:function(){var g=this.getUTCDate();return new Date(g.getTime()+(g.getTimezoneOffset()*60000))},getUTCDate:function(){return this.date},setDate:function(g){this.setUTCDate(new Date(g.getTime()-(g.getTimezoneOffset()*60000)))},setUTCDate:function(g){this.date=g;this.setValue()},setValue:function(){var g=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(g)}this.element.data("date",g)}else{this.element.val(g)}},getFormattedDate:function(g){if(g===undefined){g=this.format}return a.formatDate(this.date,g,this.language)},setStartDate:function(g){this.startDate=g||-Infinity;if(this.startDate!==-Infinity){this.startDate=a.parseDate(this.startDate,this.format,this.language)}this.update();this.updateNavArrows()},setEndDate:function(g){this.endDate=g||Infinity;if(this.endDate!==Infinity){this.endDate=a.parseDate(this.endDate,this.format,this.language)}this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(g){this.daysOfWeekDisabled=g||[];if(!d.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)}this.daysOfWeekDisabled=d.map(this.daysOfWeekDisabled,function(h){return parseInt(h,10)});this.update();this.updateNavArrows()},place:function(){if(this.isInline){return}var h=parseInt(this.element.parents().filter(function(){return d(this).css("z-index")!="auto"}).first().css("z-index"))+10;var i=this.component?this.component.offset():this.element.offset();var g=this.component?this.component.outerHeight(true):this.element.outerHeight(true);this.picker.css({top:i.top+g,left:i.left,zIndex:h})},update:function(){var h,g=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0] instanceof Date)){h=arguments[0];g=true}else{h=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val()}this.date=a.parseDate(h,this.format,this.language);if(g){this.setValue()}if(this.date<this.startDate){this.viewDate=new Date(this.startDate)}else{if(this.date>this.endDate){this.viewDate=new Date(this.endDate)}else{this.viewDate=new Date(this.date)}}this.fill()},fillDow:function(){var i=this.weekStart,h="<tr>";if(this.calendarWeeks){var g='<th class="cw">&nbsp;</th>';h+=g;this.picker.find(".datepicker-days thead tr:first-child").prepend(g)}while(i<this.weekStart+7){h+='<th class="dow">'+e[this.language].daysMin[(i++)%7]+"</th>"}h+="</tr>";this.picker.find(".datepicker-days thead").append(h)},fillMonths:function(){var h="",g=0;while(g<12){h+='<span class="month">'+e[this.language].monthsShort[g++]+"</span>"}this.picker.find(".datepicker-months td").html(h)},fill:function(){var w=new Date(this.viewDate),m=w.getUTCFullYear(),y=w.getUTCMonth(),v=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,r=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,h=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,s=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,k=this.date&&this.date.valueOf(),x=new Date();this.picker.find(".datepicker-days thead th.switch").text(e[this.language].months[y]+" "+m);this.picker.find("tfoot th.today").text(e[this.language].today).toggle(this.todayBtn!==false);this.updateNavArrows();this.fillMonths();var p=f(m,y-1,28,0,0,0,0),u=a.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(u);p.setUTCDate(u-(p.getUTCDay()-this.weekStart+7)%7);var g=new Date(p);g.setUTCDate(g.getUTCDate()+42);g=g.valueOf();var l=[];var o;while(p.valueOf()<g){if(p.getUTCDay()==this.weekStart){l.push("<tr>");if(this.calendarWeeks){var A=new Date(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()-p.getDay()+10-(this.weekStart&&this.weekStart%7<5&&7)),z=new Date(A.getFullYear(),0,4),n=~~((A-z)/86400000/7+1.5);l.push('<td class="cw">'+n+"</td>")}}o="";if(p.getUTCFullYear()<m||(p.getUTCFullYear()==m&&p.getUTCMonth()<y)){o+=" old"}else{if(p.getUTCFullYear()>m||(p.getUTCFullYear()==m&&p.getUTCMonth()>y)){o+=" new"}}if(this.todayHighlight&&p.getUTCFullYear()==x.getFullYear()&&p.getUTCMonth()==x.getMonth()&&p.getUTCDate()==x.getDate()){o+=" today"}if(k&&p.valueOf()==k){o+=" active"}if(p.valueOf()<this.startDate||p.valueOf()>this.endDate||d.inArray(p.getUTCDay(),this.daysOfWeekDisabled)!==-1){o+=" disabled"}l.push('<td class="day'+o+'">'+p.getUTCDate()+"</td>");if(p.getUTCDay()==this.weekEnd){l.push("</tr>")}p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(l.join(""));var B=this.date&&this.date.getUTCFullYear();var j=this.picker.find(".datepicker-months").find("th:eq(1)").text(m).end().find("span").removeClass("active");if(B&&B==m){j.eq(this.date.getUTCMonth()).addClass("active")}if(m<v||m>h){j.addClass("disabled")}if(m==v){j.slice(0,r).addClass("disabled")}if(m==h){j.slice(s+1).addClass("disabled")}l="";m=parseInt(m/10,10)*10;var q=this.picker.find(".datepicker-years").find("th:eq(1)").text(m+"-"+(m+9)).end().find("td");m-=1;for(var t=-1;t<11;t++){l+='<span class="year'+(t==-1||t==10?" old":"")+(B==m?" active":"")+(m<v||m>h?" disabled":"")+'">'+m+"</span>";m+=1}q.html(l)},updateNavArrows:function(){var i=new Date(this.viewDate),g=i.getUTCFullYear(),h=i.getUTCMonth();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&g<=this.startDate.getUTCFullYear()&&h<=this.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&g>=this.endDate.getUTCFullYear()&&h>=this.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.startDate!==-Infinity&&g<=this.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&g>=this.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(l){l.stopPropagation();l.preventDefault();var n=d(l.target).closest("span, td, th");if(n.length==1){switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var i=a.modes[this.viewMode].navStep*(n[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,i);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,i);break}this.fill();break;case"today":var h=new Date();h=f(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0);this.showMode(-2);var m=this.todayBtn=="linked"?null:"view";this._setDate(h,m);break}break;case"span":if(!n.is(".disabled")){this.viewDate.setUTCDate(1);if(n.is(".month")){var k=n.parent().find("span").index(n);this.viewDate.setUTCMonth(k);this.element.trigger({type:"changeMonth",date:this.viewDate})}else{var j=parseInt(n.text(),10)||0;this.viewDate.setUTCFullYear(j);this.element.trigger({type:"changeYear",date:this.viewDate})}this.showMode(-1);this.fill()}break;case"td":if(n.is(".day")&&!n.is(".disabled")){var g=parseInt(n.text(),10)||1;var j=this.viewDate.getUTCFullYear(),k=this.viewDate.getUTCMonth();if(n.is(".old")){if(k===0){k=11;j-=1}else{k-=1}}else{if(n.is(".new")){if(k==11){k=0;j+=1}else{k+=1}}}this._setDate(f(j,k,g,0,0,0,0))}break}}},_setDate:function(h,i){if(!i||i=="date"){this.date=h}if(!i||i=="view"){this.viewDate=h}this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var g;if(this.isInput){g=this.element}else{if(this.component){g=this.element.find("input")}}if(g){g.change();if(this.autoclose&&(!i||i=="date")){this.hide()}}},moveMonth:function(j,h){if(!h){return j}var m=new Date(j.valueOf()),p=m.getUTCDate(),n=m.getUTCMonth(),l=Math.abs(h),g,o;h=h>0?1:-1;if(l==1){o=h==-1?function(){return m.getUTCMonth()==n}:function(){return m.getUTCMonth()!=g};g=n+h;m.setUTCMonth(g);if(g<0||g>11){g=(g+12)%12}}else{for(var k=0;k<l;k++){m=this.moveMonth(m,h)}g=m.getUTCMonth();m.setUTCDate(p);o=function(){return g!=m.getUTCMonth()}}while(o()){m.setUTCDate(--p);m.setUTCMonth(g)}return m},moveYear:function(h,g){return this.moveMonth(h,g*12)},dateWithinRange:function(g){return g>=this.startDate&&g<=this.endDate},keydown:function(n){if(this.picker.is(":not(:visible)")){if(n.keyCode==27){this.show()}return}var l=false,k,h,m,g,j;switch(n.keyCode){case 27:this.hide();n.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation){break}k=n.keyCode==37?-1:1;if(n.ctrlKey){g=this.moveYear(this.date,k);j=this.moveYear(this.viewDate,k)}else{if(n.shiftKey){g=this.moveMonth(this.date,k);j=this.moveMonth(this.viewDate,k)}else{g=new Date(this.date);g.setUTCDate(this.date.getUTCDate()+k);j=new Date(this.viewDate);j.setUTCDate(this.viewDate.getUTCDate()+k)}}if(this.dateWithinRange(g)){this.date=g;this.viewDate=j;this.setValue();this.update();n.preventDefault();l=true}break;case 38:case 40:if(!this.keyboardNavigation){break}k=n.keyCode==38?-1:1;if(n.ctrlKey){g=this.moveYear(this.date,k);j=this.moveYear(this.viewDate,k)}else{if(n.shiftKey){g=this.moveMonth(this.date,k);j=this.moveMonth(this.viewDate,k)}else{g=new Date(this.date);g.setUTCDate(this.date.getUTCDate()+k*7);j=new Date(this.viewDate);j.setUTCDate(this.viewDate.getUTCDate()+k*7)}}if(this.dateWithinRange(g)){this.date=g;this.viewDate=j;this.setValue();this.update();n.preventDefault();l=true}break;case 13:this.hide();n.preventDefault();break;case 9:this.hide();break}if(l){this.element.trigger({type:"changeDate",date:this.date});var i;if(this.isInput){i=this.element}else{if(this.component){i=this.element.find("input")}}if(i){i.change()}}},showMode:function(g){if(g){this.viewMode=Math.max(0,Math.min(2,this.viewMode+g))}this.picker.find(">div").hide().filter(".datepicker-"+a.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()}};d.fn.datepicker=function(g){var h=Array.apply(null,arguments);h.shift();return this.each(function(){var k=d(this),j=k.data("datepicker"),i=typeof g=="object"&&g;if(!j){k.data("datepicker",(j=new b(this,d.extend({},d.fn.datepicker.defaults,i))))}if(typeof g=="string"&&typeof j[g]=="function"){j[g].apply(j,h)}})};d.fn.datepicker.defaults={};d.fn.datepicker.Constructor=b;var e=d.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today"}};var a={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(g){return(((g%4===0)&&(g%100!==0))||(g%400===0))},getDaysInMonth:function(g,h){return[31,(a.isLeapYear(g)?29:28),31,30,31,30,31,31,30,31,30,31][h]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(i){var g=i.replace(this.validParts,"\0").split("\0"),h=i.match(this.validParts);if(!g||!g.length||!h||h.length===0){throw new Error("Invalid date format.")}return{separators:g,parts:h}},parseDate:function(o,v,p){if(o instanceof Date){return o}if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(o)){var t=/([\-+]\d+)([dmwy])/,q=o.match(/([\-+]\d+)([dmwy])/g),k,n;o=new Date();for(var r=0;r<q.length;r++){k=t.exec(q[r]);n=parseInt(k[1]);switch(k[2]){case"d":o.setUTCDate(o.getUTCDate()+n);break;case"m":o=b.prototype.moveMonth.call(b.prototype,o,n);break;case"w":o.setUTCDate(o.getUTCDate()+n*7);break;case"y":o=b.prototype.moveYear.call(b.prototype,o,n);break}}return f(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),0,0,0)}var q=o&&o.match(this.nonpunctuation)||[],o=new Date(),h={},x=["yyyy","yy","M","MM","m","mm","d","dd"],u={yyyy:function(s,i){return s.setUTCFullYear(i)},yy:function(s,i){return s.setUTCFullYear(2000+i)},m:function(s,i){i-=1;while(i<0){i+=12}i%=12;s.setUTCMonth(i);while(s.getUTCMonth()!=i){s.setUTCDate(s.getUTCDate()-1)}return s},d:function(s,i){return s.setUTCDate(i)}},m,j,k;u.M=u.MM=u.mm=u.m;u.dd=u.d;o=f(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0);var g=v.parts.slice();if(q.length!=g.length){g=d(g).filter(function(s,y){return d.inArray(y,x)!==-1}).toArray()}if(q.length==g.length){for(var r=0,l=g.length;r<l;r++){m=parseInt(q[r],10);k=g[r];if(isNaN(m)){switch(k){case"MM":j=d(e[p].months).filter(function(){var i=this.slice(0,q[r].length),s=q[r].slice(0,i.length);return i==s});m=d.inArray(j[0],e[p].months)+1;break;case"M":j=d(e[p].monthsShort).filter(function(){var i=this.slice(0,q[r].length),s=q[r].slice(0,i.length);return i==s});m=d.inArray(j[0],e[p].monthsShort)+1;break}}h[k]=m}for(var r=0,w;r<x.length;r++){w=x[r];if(w in h&&!isNaN(h[w])){u[w](o,h[w])}}}return o},formatDate:function(g,n,l){var m={d:g.getUTCDate(),D:e[l].daysShort[g.getUTCDay()],DD:e[l].days[g.getUTCDay()],m:g.getUTCMonth()+1,M:e[l].monthsShort[g.getUTCMonth()],MM:e[l].months[g.getUTCMonth()],yy:g.getUTCFullYear().toString().substring(2),yyyy:g.getUTCFullYear()};m.dd=(m.d<10?"0":"")+m.d;m.mm=(m.m<10?"0":"")+m.m;var g=[],k=d.extend([],n.separators);for(var j=0,h=n.parts.length;j<h;j++){if(k.length){g.push(k.shift())}g.push(m[n.parts[j]])}return g.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};a.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+a.headTemplate+"<tbody></tbody>"+a.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table></div></div>";d.fn.datepicker.DPGlobal=a}(window.jQuery);
!function(b){var a=function(c,d){this.init("tooltip",c,d)};a.prototype={constructor:a,init:function(g,e,f){var c,d;this.type=g;this.$element=b(e);this.options=this.getOptions(f);this.enabled=true;if(this.options.trigger=="click"){this.$element.on("click."+this.type,this.options.selector,b.proxy(this.toggle,this))}else{if(this.options.trigger!="manual"){c=this.options.trigger=="hover"?"mouseenter":"focus";d=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(c+"."+this.type,this.options.selector,b.proxy(this.enter,this));this.$element.on(d+"."+this.type,this.options.selector,b.proxy(this.leave,this))}}this.options.selector?(this._options=b.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());if(c.delay&&typeof c.delay=="number"){c.delay={show:c.delay,hide:c.delay}}return c},enter:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show){return c.show()}clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){if(c.hoverState=="in"){c.show()}},c.options.delay.show)},leave:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout)}if(!c.options.delay||!c.options.delay.hide){return c.hide()}c.hoverState="out";this.timeout=setTimeout(function(){if(c.hoverState=="out"){c.hide()}},c.options.delay.hide)},show:function(){var g,d,i,e,h,c,f;if(this.hasContent()&&this.enabled){g=this.tip();this.setContent();if(this.options.animation){g.addClass("fade")}c=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement;d=/in/.test(c);g.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body);i=this.getPosition(d);e=g[0].offsetWidth;h=g[0].offsetHeight;switch(d?c.split(" ")[1]:c){case"bottom":f={top:i.top+i.height,left:i.left+i.width/2-e/2};break;case"top":f={top:i.top-h,left:i.left+i.width/2-e/2};break;case"left":f={top:i.top+i.height/2-h/2,left:i.left-e};break;case"right":f={top:i.top+i.height/2-h/2,left:i.left+i.width};break}g.css(f).addClass(c).addClass("in")}},setContent:function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.options.html?"html":"text"](c);d.removeClass("fade in top bottom left right")},hide:function(){var c=this,d=this.tip();d.removeClass("in");function e(){var f=setTimeout(function(){d.off(b.support.transition.end).remove()},500);d.one(b.support.transition.end,function(){clearTimeout(f);d.remove()})}b.support.transition&&this.$tip.hasClass("fade")?e():d.remove();return this},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("data-original-title"))!="string"){c.attr("data-original-title",c.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},(c?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,c=this.$element,d=this.options;e=c.attr("data-original-title")||(typeof d.title=="function"?d.title.call(c[0]):d.title);return e},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),e=f.data("tooltip"),d=typeof c=="object"&&c;if(!e){f.data("tooltip",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:true}}(window.jQuery);
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}})(function(D,G){var M=6,f=D.event.add,z=D.event.remove,w=function(P,O,Q){D.event.trigger(O,Q,P)},F=(function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(P,O){return window.setTimeout(function(){P()},25)})})(),i={textarea:true,input:true,select:true},k={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},L={move:"touchmove",cancel:"touchend",end:"touchend"};function s(Q){var R=Q,S=false,O=false;function P(T){if(S){R();F(P);O=true;S=false}else{O=false}}this.kick=function(T){S=true;if(!O){P()}};this.end=function(U){var T=R;if(!U){return}if(!O){U()}else{R=S?function(){T();U()}:U;S=true}}}function K(){return true}function N(){return false}function o(O){O.preventDefault()}function b(O){if(i[O.target.tagName.toLowerCase()]){return}O.preventDefault()}function l(O){return(O.which===1&&!O.ctrlKey&&!O.altKey)}function J(Q,R){var P,O;if(Q.identifiedTouch){return Q.identifiedTouch(R)}P=-1;O=Q.length;while(++P<O){if(Q[P].identifier===R){return Q[P]}}}function r(P,O){var Q=J(P.changedTouches,O.identifier);if(!Q){return}if(Q.pageX===O.pageX&&Q.pageY===O.pageY){return}return Q}function t(P){var O;if(!l(P)){return}O={target:P.target,startX:P.pageX,startY:P.pageY,timeStamp:P.timeStamp};f(document,k.move,A,O);f(document,k.cancel,y,O)}function A(P){var O=P.data;x(P,O,P,q)}function y(O){q()}function q(){z(document,k.move,A);z(document,k.cancel,q)}function a(P){var Q,O;if(i[P.target.tagName.toLowerCase()]){return}Q=P.changedTouches[0];O={target:Q.target,startX:Q.pageX,startY:Q.pageY,timeStamp:P.timeStamp,identifier:Q.identifier};f(document,L.move+"."+Q.identifier,u,O);f(document,L.cancel+"."+Q.identifier,n,O)}function u(P){var O=P.data,Q=r(P,O);if(!Q){return}x(P,O,Q,c)}function n(P){var O=P.data,Q=J(P.changedTouches,O.identifier);if(!Q){return}c(O.identifier)}function c(O){z(document,"."+O,u);z(document,"."+O,n)}function x(S,Q,T,R){var P=T.pageX-Q.startX,O=T.pageY-Q.startY;if((P*P)+(O*O)<(M*M)){return}v(S,Q,T,P,O,R)}function I(){this._handled=K;return false}function g(O){O._handled()}function v(S,W,R,U,T,V){var P=W.target,Q,O;Q=S.targetTouches;O=S.timeStamp-W.timeStamp;W.type="movestart";W.distX=U;W.distY=T;W.deltaX=U;W.deltaY=T;W.pageX=R.pageX;W.pageY=R.pageY;W.velocityX=U/O;W.velocityY=T/O;W.targetTouches=Q;W.finger=Q?Q.length:1;W._handled=I;W._preventTouchmoveDefault=function(){S.preventDefault()};w(W.target,W);V(W.identifier)}function H(P){var O=P.data.event,Q=P.data.timer;m(O,P,P.timeStamp,Q)}function e(P){var O=P.data.event,Q=P.data.timer;d();B(O,Q,function(){setTimeout(function(){z(O.target,"click",N)},0)})}function d(O){z(document,k.move,H);z(document,k.end,e)}function E(P){var O=P.data.event,R=P.data.timer,Q=r(P,O);if(!Q){return}P.preventDefault();O.targetTouches=P.targetTouches;m(O,Q,P.timeStamp,R)}function j(P){var O=P.data.event,R=P.data.timer,Q=J(P.changedTouches,O.identifier);if(!Q){return}p(O);B(O,R)}function p(O){z(document,"."+O.identifier,E);z(document,"."+O.identifier,j)}function m(P,S,O,R){var Q=O-P.timeStamp;P.type="move";P.distX=S.pageX-P.startX;P.distY=S.pageY-P.startY;P.deltaX=S.pageX-P.pageX;P.deltaY=S.pageY-P.pageY;P.velocityX=0.3*P.velocityX+0.7*P.deltaX/Q;P.velocityY=0.3*P.velocityY+0.7*P.deltaY/Q;P.pageX=S.pageX;P.pageY=S.pageY;R.kick()}function B(P,Q,O){Q.end(function(){P.type="moveend";w(P.target,P);return O&&O()})}function h(Q,P,O){f(this,"dragstart.move drag.move",o);f(this,"mousedown.move",b);f(this,"movestart.move",g);return true}function C(O){z(this,"dragstart drag",o);z(this,"mousedown touchstart",b);z(this,"movestart",g);return true}D.event.special.movestart={setup:h,teardown:C,_default:function(Q){var O,P;if(!Q._handled()){return}O={target:Q.target,startX:Q.startX,startY:Q.startY,pageX:Q.pageX,pageY:Q.pageY,distX:Q.distX,distY:Q.distY,deltaX:Q.deltaX,deltaY:Q.deltaY,velocityX:Q.velocityX,velocityY:Q.velocityY,timeStamp:Q.timeStamp,identifier:Q.identifier,targetTouches:Q.targetTouches,finger:Q.finger};P={event:O,timer:new s(function(R){w(Q.target,O)})};if(Q.identifier===G){f(Q.target,"click",N);f(document,k.move,H,P);f(document,k.end,e,P)}else{Q._preventTouchmoveDefault();f(document,L.move+"."+Q.identifier,E,P);f(document,L.end+"."+Q.identifier,j,P)}}};D.event.special.move={setup:function(){f(this,"movestart.move",D.noop)},teardown:function(){z(this,"movestart.move",D.noop)}};D.event.special.moveend={setup:function(){f(this,"movestart.moveend",D.noop)},teardown:function(){z(this,"movestart.moveend",D.noop)}};f(document,"mousedown.move",t);f(document,"touchstart.move",a);if(typeof Array.prototype.indexOf==="function"){(function(R,Q){var P=["changedTouches","targetTouches"],O=P.length;while(O--){if(R.event.props.indexOf(P[O])===-1){R.event.props.push(P[O])}}})(D)}});
/*!
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(a,c){var $=a.jQuery||a.Cowboy||(a.Cowboy={}),b;$.throttle=b=function(e,f,h,g){var j,d=0;if(typeof f!=="boolean"){g=h;h=f;f=c}function i(){var o=this,n=+new Date()-d,m=arguments;function l(){d=+new Date();h.apply(o,m)}function k(){j=c}if(g&&!j){l()}j&&clearTimeout(j);if(g===c&&n>e){l()}else{if(f!==true){j=setTimeout(g?k:l,g===c?e-n:e)}}}if($.guid){i.guid=h.guid=h.guid||$.guid++}return i};$.debounce=function(e,d,f){return f===c?b(e,d,false):b(e,f,d!==false)}})(this);
(function(k,o,r){var q="hashchange",l=document,n,m=k.event.special,j=l.documentMode,p="on"+q in o&&(j===r||j>7);function s(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}k.fn[q]=function(a){return a?this.bind(q,a):this.trigger(q)};k.fn[q].delay=50;m[q]=k.extend(m[q],{setup:function(){if(p){return false}k(n.start)},teardown:function(){if(p){return false}k(n.stop)}});n=(function(){var d={},e,a=s(),c=function(h){return h},b=c,f=c;d.start=function(){e||g()};d.stop=function(){e&&clearTimeout(e);e=r};function g(){var h=s(),i=f(a);if(h!==a){b(a=h,i);k(o).trigger(q)}else{if(i!==a){location.href=location.href.replace(/#.*/,"")+i}}e=setTimeout(g,k.fn[q].delay)}k.browser.msie&&!p&&(function(){var i,h;d.start=function(){if(!i){h=k.fn[q].src;h=h&&h+s();i=k('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){h||b(s());g()}).attr("src",h||"javascript:0").insertAfter("body")[0].contentWindow;l.onpropertychange=function(){try{if(event.propertyName==="title"){i.document.title=l.title}}catch(t){}}}};d.stop=c;f=function(){return s(i.location.href)};b=function(w,z){var x=i.document,y=k.fn[q].domain;if(w!==z){x.title=l.title;x.open();y&&x.write('<script>document.domain="'+y+'"<\/script>');x.close();i.location.hash=w}}})();return d})()})(jQuery,this);
(function(a){if(typeof define!=="undefined"&&define.amd){define(["jquery"],a)}else{if(typeof module!=="undefined"&&module.exports){var b=require("jquery");module.exports=a(b)}else{window.scrollMonitor=a(jQuery)}}})(function(f){var v={};var u=f(window);var C=f(document);var e=[];var w="visibilityChange";var y="enterViewport";var A="fullyEnterViewport";var l="exitViewport";var g="partiallyExitViewport";var E="locationChange";var h="stateChange";var p=[w,y,A,l,g,E,h];var D={top:0,bottom:0};v.viewportTop;v.viewportBottom;v.documentHeight;v.viewportHeight=u.height();var a;var r;var b;function s(){v.viewportTop=u.scrollTop();v.viewportBottom=v.viewportTop+v.viewportHeight;v.documentHeight=C.height();if(v.documentHeight!==a){b=e.length;while(b--){e[b].recalculateLocation()}a=v.documentHeight}}function c(){v.viewportHeight=u.height();s();q()}var o;function t(){clearTimeout(o);o=setTimeout(c,100)}var m;function q(){m=e.length;while(m--){e[m].update()}m=e.length;while(m--){e[m].triggerCallbacks()}}function k(I,P){var R=this;this.watchItem=I;if(!P){this.offsets=D}else{if(P===+P){this.offsets={top:P,bottom:P}}else{this.offsets=f.extend({},D,P)}}this.callbacks={};for(var Q=0,O=p.length;Q<O;Q++){R.callbacks[p[Q]]=[]}this.locked=false;var L;var G;var F;var K;var J;var H;function N(i){if(i.length===0){return}J=i.length;while(J--){H=i[J];H.callback.call(R,r);if(H.isOne){i.splice(J,1)}}}this.triggerCallbacks=function M(){if(this.isInViewport&&!L){N(this.callbacks[y])}if(this.isFullyInViewport&&!G){N(this.callbacks[A])}if(this.isAboveViewport!==F&&this.isBelowViewport!==K){N(this.callbacks[w]);if(!G&&!this.isFullyInViewport){N(this.callbacks[A]);N(this.callbacks[g])}if(!L&&!this.isInViewport){N(this.callbacks[y]);N(this.callbacks[l])}}if(!this.isFullyInViewport&&G){N(this.callbacks[g])}if(!this.isInViewport&&L){N(this.callbacks[l])}if(this.isInViewport!==L){N(this.callbacks[w])}switch(true){case L!==this.isInViewport:case G!==this.isFullyInViewport:case F!==this.isAboveViewport:case K!==this.isBelowViewport:N(this.callbacks[h])}L=this.isInViewport;G=this.isFullyInViewport;F=this.isAboveViewport;K=this.isBelowViewport};this.recalculateLocation=function(){if(this.locked){return}var S=this.top;var T=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;if(i==="none"){this.watchItem.style.display=""}var j=f(this.watchItem).offset();this.top=j.top;this.bottom=j.top+this.watchItem.offsetHeight;if(i==="none"){this.watchItem.style.display=i}}else{if(this.watchItem===+this.watchItem){if(this.watchItem>0){this.top=this.bottom=this.watchItem}else{this.top=this.bottom=v.documentHeight-this.watchItem}}else{this.top=this.watchItem.top;this.bottom=this.watchItem.bottom}}this.top-=this.offsets.top;this.bottom+=this.offsets.bottom;this.height=this.bottom-this.top;if((S!==undefined||T!==undefined)&&(this.top!==S||this.bottom!==T)){N(this.callbacks[E])}};this.recalculateLocation();this.update();L=this.isInViewport;G=this.isFullyInViewport;F=this.isAboveViewport;K=this.isBelowViewport}k.prototype={on:function(i,j,F){switch(true){case i===w&&!this.isInViewport&&this.isAboveViewport:case i===y&&this.isInViewport:case i===A&&this.isFullyInViewport:case i===l&&this.isAboveViewport&&!this.isInViewport:case i===g&&this.isAboveViewport:j();if(F){return}}if(this.callbacks[i]){this.callbacks[i].push({callback:j,isOne:F})}else{throw new Error("Tried to add a scroll monitor listener of type "+i+". Your options are: "+p.join(", "))}},off:function(G,H){if(this.callbacks[G]){for(var j=0,F;F=this.callbacks[G][j];j++){if(F.callback===H){this.callbacks[G].splice(j,1);break}}}else{throw new Error("Tried to remove a scroll monitor listener of type "+G+". Your options are: "+p.join(", "))}},one:function(i,j){this.on(i,j,true)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom;this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<v.viewportTop;this.isBelowViewport=this.bottom>v.viewportBottom;this.isInViewport=(this.top<=v.viewportBottom&&this.bottom>=v.viewportTop);this.isFullyInViewport=(this.top>=v.viewportTop&&this.bottom<=v.viewportBottom)||(this.isAboveViewport&&this.isBelowViewport)},destroy:function(){var H=e.indexOf(this),F=this;e.splice(H,1);for(var I=0,G=p.length;I<G;I++){F.callbacks[p[I]].length=0}},lock:function(){this.locked=true},unlock:function(){this.locked=false}};var n=function(i){return function(j,F){this.on.call(this,i,j,F)}};for(var z=0,x=p.length;z<x;z++){var d=p[z];k.prototype[d]=n(d)}s();function B(i){r=i;s();q()}u.on("scroll",B);u.on("resize",t);v.beget=v.create=function(F,i){if(typeof F==="string"){F=f(F)[0]}if(F instanceof f){F=F[0]}var j=new k(F,i);e.push(j);j.update();return j};v.update=function(){r=null;s();q()};v.recalculateLocations=function(){v.documentHeight=0;v.update()};return v});
(function(){if(typeof window.Element==="undefined"||"classList" in document.documentElement){return}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(m,n){for(var l=(n||0),k=this.length;l<k;l++){if(this[l]===m){return l}}return -1}}var i=Array.prototype,e=i.indexOf,f=i.slice,d=i.push,b=i.splice,a=i.join;function h(l){this._element=l;if(l.className!=this._classCache){this._classCache=l.className;if(!this._classCache){return}var k=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/),j;for(j=0;j<k.length;j++){d.call(this,k[j])}}}function g(k,j){k.className=j.join(" ")}h.prototype={add:function(j){if(this.contains(j)){return}d.call(this,j);g(this._element,f.call(this,0))},contains:function(j){return e.call(this,j)!==-1},item:function(j){return this[j]||null},remove:function(k){var j=e.call(this,k);if(j===-1){return}b.call(this,j,1);g(this._element,f.call(this,0))},toString:function(){return a.call(this," ")},toggle:function(j){if(!this.contains(j)){this.add(j)}else{this.remove(j)}return this.contains(j)}};window.DOMTokenList=h;function c(k,l,j){if(Object.defineProperty){Object.defineProperty(k,l,{get:j})}else{k.__defineGetter__(l,j)}}c(Element.prototype,"classList",function(){return new h(this)})})();
(function(b){if(typeof window.Element==="undefined"||"classList" in document.documentElement){var b=jQuery;var c=b.fn.addClass;var a=b.fn.removeClass;b.fn.hasClass=function(d){var g,f,e;for(f=0,e=this.length;f<e;++f){g=this[f];if(g.nodeType===1&&g.classList.contains(d)){return true}}return false};b.fn.addClass=function(g){var f,e,d;if(typeof g==="string"&&g&&g.indexOf(" ")<0){for(e=0,d=this.length;e<d;++e){f=this[e];if(f.nodeType===1){f.classList.add(g)}}}else{c.apply(this,arguments)}return this};b.fn.removeClass=function(g){var f,e,d;if(typeof g==="string"&&g&&g.indexOf(" ")<0){for(e=0,d=this.length;e<d;++e){f=this[e];if(f.nodeType===1){f.classList.remove(g)}}}else{a.apply(this,arguments)}return this}}})(jQuery);
(function(){var f=this;var m;if(typeof(f.require)=="function"){try{var h=f.require("crypto").randomBytes;m=h&&function(){return h(16)}}catch(t){}}if(!m&&f.crypto&&crypto.getRandomValues){var x=new Uint8Array(16);m=function q(){crypto.getRandomValues(x);return x}}if(!m){var b=new Array(16);m=function(){for(var e=0,y;e<16;e++){if((e&3)===0){y=Math.random()*4294967296}b[e]=y>>>((e&3)<<3)&255}return b}}var p=typeof(f.Buffer)=="function"?f.Buffer:Array;var j=[];var k={};for(var s=0;s<256;s++){j[s]=(s+256).toString(16).substr(1);k[j[s]]=s}function n(A,e,B){var y=(e&&B)||0,z=0;e=e||[];A.toLowerCase().replace(/[0-9a-f]{2}/g,function(i){if(z<16){e[y+z++]=k[i]}});while(z<16){e[y+z++]=0}return e}function w(e,z){var y=z||0,A=j;return A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+"-"+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]+A[e[y++]]}var l=m();var u=[l[0]|1,l[1],l[2],l[3],l[4],l[5]];var v=(l[6]<<8|l[7])&16383;var d=0,o=0;function g(G,z,D){var E=z&&D||0;var F=z||[];G=G||{};var C=G.clockseq!=null?G.clockseq:v;var e=G.msecs!=null?G.msecs:new Date().getTime();var J=G.nsecs!=null?G.nsecs:o+1;var y=(e-d)+(J-o)/10000;if(y<0&&G.clockseq==null){C=C+1&16383}if((y<0||e>d)&&G.nsecs==null){J=0}if(J>=10000){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}d=e;o=J;v=C;e+=12219292800000;var I=((e&268435455)*10000+J)%4294967296;F[E++]=I>>>24&255;F[E++]=I>>>16&255;F[E++]=I>>>8&255;F[E++]=I&255;var H=(e/4294967296*10000)&268435455;F[E++]=H>>>8&255;F[E++]=H&255;F[E++]=H>>>24&15|16;F[E++]=H>>>16&255;F[E++]=C>>>8|128;F[E++]=C&255;var B=G.node||u;for(var A=0;A<6;A++){F[E+A]=B[A]}return z?z:w(F)}function c(z,e,C){var y=e&&C||0;if(typeof(z)=="string"){e=z=="binary"?new p(16):null;z=null}z=z||{};var B=z.random||(z.rng||m)();B[6]=(B[6]&15)|64;B[8]=(B[8]&63)|128;if(e){for(var A=0;A<16;A++){e[y+A]=B[A]}}return e||w(B)}var r=c;r.v1=g;r.v4=c;r.parse=n;r.unparse=w;r.BufferClass=p;if(typeof define==="function"&&define.amd){define(function(){return r})}else{if(typeof(module)!="undefined"&&module.exports){module.exports=r}else{var a=f.uuid;r.noConflict=function(){f.uuid=a;return r};f.uuid=r}}}).call(this);
(function(a){a.fn.twentytwenty=function(b){var b=a.extend({default_offset_pct:0.5},b);return this.each(function(){var e=b.default_offset_pct;var k=a(this);var l=k.find("img:first");var i=k.find("img:last");k.append("<div class='twentytwenty-handle-wrapper'><div class='twentytwenty-handle'></div></div>");var j=k.find(".twentytwenty-handle");j.append("<div class='twentytwenty-left-arrow'></div>");j.append("<div class='twentytwenty-right-arrow'></div>");k.addClass("twentytwenty-container");l.addClass("twentytwenty-before");i.addClass("twentytwenty-after");var d=k.find("figcaption").height()||0;var f=function(p){var n=l.width();var o=l.height();return{w:n+"px",h:o+"px",cw:(p*n)+"px"}};var h=function(n){l.css("clip","rect(0,"+n.cw+","+n.h+",0)");k.css("height",n.h+d);k.find("a:last, .twentytwenty-handle-wrapper").css("height",n.h)};var g=function(n){var o=f(n);if(o.h==="0px"){l.on("load",function(){g(n)})}j.css("left",o.cw);h(o)};a(window).on("resize.twentytwenty",function(n){g(e)});var c=0;var m=0;k.on("movestart",function(n){if((n.distX>n.distY&&n.distX<-n.distY)||(n.distX<n.distY&&n.distX>-n.distY)){n.preventDefault()}k.addClass("active");c=k.offset().left;m=l.width()});k.on("moveend",function(n){k.removeClass("active")});k.on("move",function(n){if(k.hasClass("active")){e=(n.pageX-c)/m;if(e<0){e=0}if(e>1){e=1}g(e)}});k.find("img").on("mousedown",function(n){n.preventDefault()});j.on("mousedown",function(n){c=k.offset().left;m=l.width();e=(n.pageX-c)/m;if(e<0){e=0}if(e>1){e=1}g(e)});a(window).trigger("resize.twentytwenty")})}})(jQuery);$(function(){$('[data-embed-type="comparison"]').twentytwenty();if(typeof tinymce!=="undefined"){tinymce.onAddEditor.add(function(b,a){$(a.getDoc()).find('[data-embed-type="comparison"]').twentytwenty();a.onExecCommand.add(function(c,e,d,f){if(e=="mceEmbedImage"){$(c.getDoc()).find('[data-embed-type="comparison"]').twentytwenty()}});a.onInit.add(function(c){$(c.getDoc()).find('[data-embed-type="comparison"]').twentytwenty()})})}});
var _documentHiddenPropertyName=null;var _documentVisibilityChangeEventName=null;$.fn.hidden=function(){if(this[0]!==document){return false}if(_documentHiddenPropertyName===null&&_documentHiddenPropertyName!=="incompatible"){var a=[["hidden","visibilitychange"],["mozHidden","mozvisibilitychange"],["msHidden","msvisibilitychange"],["webkitHidden","webkitvisibilitychange"]];$.each(a,function(b,c){if(typeof document[c[0]]!=="undefined"){_documentHiddenPropertyName=c[0];_documentVisibilityChangeEventName=c[1];return false}});if(_documentHiddenPropertyName===null){_documentHiddenPropertyName="incompatible"}}if(arguments.length===0){if(_documentHiddenPropertyName===null){return true}return document[_documentHiddenPropertyName]}return this.on(_documentVisibilityChangeEventName,arguments[0])};
$(document).ready(function(){var c=function(){$("#feed-view-details").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-thirds").removeClass("on");$("#feed-view-grid").removeClass("on");$("#feed-view-quarters").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-details").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("details");h.removeClass("compact");h.removeClass("river");h.removeClass("thirds");h.removeClass("grid");h.removeClass("quarters")};var g=function(){$("#feed-view-compact").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-thirds").removeClass("on");$("#feed-view-grid").removeClass("on");$("#feed-view-quarters").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-compact").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("compact");h.removeClass("details");h.removeClass("list");h.removeClass("thirds");h.removeClass("grid");h.removeClass("quarters")};var b=function(){$("#feed-view-river").addClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-thirds").removeClass("on");$("#feed-view-grid").removeClass("on");$("#feed-view-quarters").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("river");h.removeClass("details");h.removeClass("compact");h.removeClass("thirds");h.removeClass("grid");h.removeClass("quarters")};var f=function(){$("#feed-view-grid").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-thirds").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-quarters").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("grid");h.removeClass("river");h.removeClass("thirds");h.removeClass("details");h.removeClass("compact");h.removeClass("quarters")};var e=function(){$("#feed-view-thirds").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-grid").removeClass("on");$("#feed-view-quarters").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("thirds");h.removeClass("river");h.removeClass("details");h.removeClass("compact");h.removeClass("grid");h.removeClass("quarters")};var a=function(){$("#feed-view-quarters").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-grid").removeClass("on");$("#feed-view-thirds").removeClass("on");var h=$("#river .editorial");if(h.length===0){h=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}h.addClass("quarters");h.removeClass("river");h.removeClass("details");h.removeClass("compact");h.removeClass("grid");h.removeClass("thirds")};var d=function(h,i){if(h!==undefined){$.cookie("feed-group-"+h,i,{expires:365,path:"/"})}};$(document).on("click","#feed-view-details",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");c();i.preventDefault();d(h,"Details")});$(document).on("click","#feed-view-compact",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");g();i.preventDefault();d(h,"Compact")});$(document).on("click","#feed-view-river",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");b();i.preventDefault();d(h,"River")});$(document).on("click","#feed-view-grid",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");f();i.preventDefault();d(h,"Grid")});$(document).on("click","#feed-view-thirds",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");e();i.preventDefault();d(h,"Thirds")});$(document).on("click","#feed-view-quarters",function(i){var h=$(this).parents("dl:first").attr("data-feed-group");a();i.preventDefault();d(h,"Quarters")})});
$(document).ready(function(){var h=0;var i="hide";var o={};var n={};var d=1000;var k=d*60;var g=k*60;var a=g*24;var e=function(t){return(t<10?"0":"")+t};var l=function(t,v){var u="";if(undefined===v){v="in "}if(t.swatch){u+="<em>@</em>"+t.swatch+" <em>.beats</em>"}else{if(t.days>0){u+=t.days+"<em>d</em> "}u+=e(t.hours)+"<em>h</em> ";u+=e(t.minutes)+"<em>m</em> ";u+=e(t.seconds)+"<em>s</em>"}return v+u};var j=function(y){var t=new Date();var B=y-t;if(B<=0){return null}var u=B;var v=$.deparam.querystring();if(v.swatch){var C=Math.round(((u/1000)/(1.264*60))*100)/100;return{swatch:isNaN(C)?0:C}}var x=Math.floor(u/a);u-=x*a;var z=Math.floor(u/g);u-=z*g;var A=Math.floor(u/k);u-=A*k;var w=Math.floor(u/d);return{days:isNaN(x)?0:x,hours:isNaN(z)?0:z,minutes:isNaN(A)?0:A,seconds:isNaN(w)?0:w}};var m=function(u,t){n[u]=t};var p=function(w){var u=q(w),t=n[u],v;if(undefined===t){t={};v=w.find(".js-time-unit");if(!v||0===v.length){t=null}else{v.each(function(){var y=$(this),z=y.find(".js-time-value"),x=y.find(".js-time-label"),A=y.data("unit");if(!!A){t[A]={labels:{singular:y.data("unit-singular"),plural:A},$element:y,$value:z,$label:x}}})}n[u]=t}return t};var s=function(x,y){var v=q(x),t=p(x),u=0,w=false;if(null!==t){$.each(y,function(B,E){var H=t[B];if(!H){return}var A=H.labels,C=A.plural,z=E.toString(),F=H.$element,G=H.$value,D=H.$label;if(F){if("days"!==B||(0<E)){if(E===1&&A.singular){C=A.singular}if(!!G&&0<G.length&&!!D&&0<D.length){if(F.data("show-lead-zero")){z=e(E)}G.text(z);D.text(C)}else{F.html(e(E))}u++}else{F.remove();delete t[B];w=true}}})}if(0===u){x.html(l(y));n[v]=null}if(w){m(v,t)}};var r=function(v,u){var w=j(u),t=q(v);if(!w){c(v);clearTimeout(o[t]);o[t]=null;return}s(v,w);o[t]=setTimeout(function(){r(v,u)},1000)};var c=function(t){var u=t.data("live-msg");t.trigger("complete");t.data("complete",true);if(null===u||undefined===u){u="is Live!"}t.html(u);t.data("")};var f="countdown-id";var q=function(u){var t=u.data(f);if(!t){h++;t=h;u.data(f,t)}return t};var b=function(){};$(document).ready(function(){var t=$(".js-time-countdown");t.each(function(){var w=$(this),x=w.data("timestamp")||w.text(),u;var v=new Date(parseInt(x,10)*1000);u=q(w);o[u]=null;r(w,v);w.removeClass(i);w.addClass("is-counting")})})});
$.ui.draggable.prototype._generatePosition=function(b){var c=this.options,j=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=(/(html|body)/i).test(j[0].tagName);var f=b.pageX;var e=b.pageY;if(this.originalPosition){var a;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();a=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else{a=this.containment}if(b.pageX-this.offset.click.left<a[0]){f=a[0]+this.offset.click.left}if(b.pageY-this.offset.click.top<a[1]){e=a[1]+this.offset.click.top}if(b.pageX-this.offset.click.left>a[2]){f=a[2]+this.offset.click.left}if(b.pageY-this.offset.click.top>a[3]){e=a[3]+this.offset.click.top}}if(c.grid){var h=c.grid[1]?this.originalPageY+Math.round((e-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;e=a?(!(h-this.offset.click.top<a[1]||h-this.offset.click.top>a[3])?h:(!(h-this.offset.click.top<a[1])?h-c.grid[1]:h+c.grid[1])):h;var d=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=a?(!(d-this.offset.click.left<a[0]||d-this.offset.click.left>a[2])?d:(!(d-this.offset.click.left<a[0])?d-c.grid[0]:d+c.grid[0])):d}}ret={top:(e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(g?0:j.scrollTop())))),left:(f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:j.scrollLeft())))};if($(this.element.parents("div")[0]).css("overflow-x")==="scroll"&&e-this.offset.click.top===ret.top){}return ret};
var Phoenix=function(){};Phoenix._$body=$("body");Phoenix._$window=$(window);Phoenix._$document=$(document);Phoenix._$messageBlock=$("#message-block");Phoenix.setWindow=function(){return Phoenix._$window};Phoenix.setDocument=function(){return Phoenix._$document};Phoenix.setBody=function(){return Phoenix._$body};Phoenix.setMessageBlock=function(){return Phoenix._$messageBlock};Phoenix.getWindow=function(){return Phoenix._$document};Phoenix.getDocument=function(){return Phoenix._$document};Phoenix.getBody=function(){return Phoenix._$body};Phoenix.getMessageBlock=function(){return Phoenix._$messageBlock};Phoenix._uniqueIdAlphabet="abcdefghijklmnopqrstuvwxyz0123456789";Phoenix._uniqueIdAlphabetLength=Phoenix._uniqueIdAlphabet.length-1;Phoenix.makeUniqueId=function(b,c){var g="";var e=0,a=Phoenix._uniqueIdAlphabetLength;var h=Phoenix._uniqueIdAlphabet;var d,f;if(b===undefined){b=""}for(d=0,f;d<c;d++){f=Math.floor(Math.random()*(a-e+1))+e;g+=h[f]}return b+g};
Phoenix.Cryptography=function(){};Phoenix.Cryptography.random=function(b,a){b=parseInt(b,10);a=parseInt(a,10);if(!isNaN(b)&&!isNaN(a)){return Math.floor(Math.random()*(a-b+1))+b}return Math.random()};Phoenix.Cryptography.randomString=function(g,j){if(!g){g=32}var f="0123456789";var a="abcdef";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var b=c.toLowerCase()+c+f+"+/";var e="";if(j!==undefined){if(j==="alphanumeric"){b=c.toLowerCase()+c+f}else{if(j==="base56"){b=c.toLowerCase()+c+f.substr(2)}else{if(j==="alpha"){b=c.toLowerCase()+c}else{if(j==="base36"){b=c+f}else{if(j==="hexadecimal"){b=a+f}else{if(j==="numeric"){b=f}}}}}}}for(var d=0,h=b.length-1;d<g;d++){e+=b.charAt(Phoenix.Cryptography.random(0,h))}return e};
Phoenix.CMS=function(){};
Phoenix.jQuery=(function(c,b){var a={};var e={setWindow:function(){a.win=$(c);return a.win},setDocument:function(){a.doc=$(b);return a.doc},setHtml:function(){a.html=$("html");return a.html},setBody:function(){a.body=$("body");return a.body},setWrapper:function(){a.wrapper=$("#wrapper");return a.wrapper},setMessageBlock:function(){a.messageBlock=$("#message-block");return a.messageBlock},setLoadingScreen:function(f){if(!f){f="Very busy&hellip;"}a.loadingScreen=$('<div class="modal-backdrop"></div><div class="loading-global">'+f+"</div>").data("msg",f);return a.loadingScreen}};var d={getWindow:function(){return a.win||e.setWindow()},getDocument:function(){return a.doc||e.setDocument()},getHtml:function(){return a.html||e.setHtml()},getBody:function(){return a.body||e.setBody()},getWrapper:function(){return a.wrapper||e.setWrapper()},getMessageBlock:function(){return a.messageBlock||e.setMessageBlock()},getLoadingScreen:function(g,f){return(a.loadingScreen&&(a.loadingScreen.data("msg")===g||f))?a.loadingScreen:e.setLoadingScreen(g)},getEvents:function(f){var h=function(){var j=$(this);var i=j.data("events");if(i===undefined){return}c.console.log(j,i);if(j.children().length!==0){h(j.children())}};var g=f.data("events");if(g!==undefined){c.console.log(f,f.data("events"))}f.children().each(h)}};return d})(this,this.document);
Phoenix.Grammar={};Phoenix.Grammar._humanizeCache={};Phoenix.Grammar._underscorizeCache={};Phoenix.Grammar._camelizeCache={upper:{},lower:{}};Phoenix.Grammar._rules={humanize:{},camelize:{},singularize:{},pluralize:{},underscorize:{}};Phoenix.Grammar._pluralizeCache={};Phoenix.Grammar._singularizeCache={};Phoenix.Grammar._singularToPluralRules=[[/([ml])ouse$/i,"ice"],[/(media|info(rmation)?|news)$/i,""],[/(phot|log|vide)o$/i,"os"],[/^(q)uiz$/i,"uizzes"],[/(c)hild$/i,"hildren"],[/(p)erson$/i,"eople"],[/(m)an$/i,"en"],[/([ieu]s|[ieuo]x)$/i,"es"],[/([cs]h)$/i,"es"],[/(ss)$/i,"es"],[/([aeo]l)f$/i,"ves"],[/([^d]ea)f$/i,"ves"],[/(ar)f$/i,"ves"],[/([nlw]i)fe$/i,"ves"],[/([aeiou]y)$/i,"s"],[/([^aeiou])y$/i,"ies"],[/([^o])o$/i,"oes"],[/s$/i,"ses"],[/(.)$/i,"s"]];Phoenix.Grammar._pluralToSingularRules=[[/([ml])ice$/i,"ouse"],[/(media|info(rmation)?|news)$/i,""],[/(q)uizzes$/i,"uiz"],[/(c)hildren$/i,"ild"],[/(p)eople$/i,"erson"],[/(m)en$/i,"an"],[/((?!sh).)oes$/i,"o"],[/((?!o)[ieu]s|[ieuo]x)es$/i,""],[/([cs]h)es$/i,""],[/(ss)es$/i,""],[/([aeo]l)ves$/i,"f"],[/([^d]ea)ves$/i,"f"],[/(ar)ves$/i,"f"],[/([nlw]i)ves$/i,"fe"],[/([aeiou]y)s$/i,""],[/([^aeiou])ies$/i,"y"],[/(la)ses$/i,"s"],[/(.)s$/i,""]];Phoenix.Grammar._commonize=function(e,d,b){if(b[e]){return b[e]}var c=e;e=e.charAt(0).toLowerCase()+e.substr(1);if(e.indexOf("_")!==-1&&e.toLowerCase()===e){}else{if(e.indexOf(" ")!==-1){e=e.replace(/\s+/g,"_").toLowerCase()}else{var a;do{a=e;e=e.replace(/([a-zA-Z])([0-9])/,"$1"+d+"$2");e=e.replace(/([a-z0-9A-Z])([A-Z])/,"$1"+d+"$2")}while(a!==e);e=e.toLowerCase()}}b[c]=e;return e};Phoenix.Grammar.underscorize=function(a){if(Phoenix.Grammar._rules.underscorize[a]!==undefined){return Phoenix.Grammar._rules.underscorize[a]}return Phoenix.Grammar._commonize(a,"_",Phoenix.Grammar._underscorizeCache)};Phoenix.Grammar.humanize=function(e){if(Phoenix.Grammar._rules.humanize[e]!==undefined){return Phoenix.Grammar._rules.humanize[e]}if(Phoenix.Grammar._humanizeCache[e]){return Phoenix.Grammar._humanizeCache[e]}var c=e;if(e.indexOf(" ")===-1){if(e.indexOf("_")===-1){e=Phoenix.Grammar.underscorize(e)}e=e.replace(/_/g," ");var b=e.split(" ");for(var a=0;a<b.length;a++){b[a]=b[a].charAt(0).toUpperCase()+b[a].substr(1)}e=b.join(" ");var d=/(\b(api|css|gif|html|id|jpg|js|mp3|pdf|php|png|sql|swf|url|xhtml|xml)\b)/gi;e=e.replace(d,function(f){return f.toUpperCase()});e=e.replace(/\.(\w+)$/,function(g,f){return"."+f.charAt(0).toUpperCase()+f.substr(1)})}Phoenix.Grammar._humanizeCache[c]=e;return e};Phoenix.Grammar.camelize=function(g,d,c){if(Phoenix.Grammar._rules.camelize[g]!==undefined){return Phoenix.Grammar._rules.camelize[g]}if(d&&Phoenix.Grammar._camelizeCache.upper[g]){return Phoenix.Grammar._camelizeCache.upper[g]}else{if(!d&&Phoenix.Grammar._camelizeCache.lower[g]){return Phoenix.Grammar._camelizeCache.lower[g]}}if(d===undefined){d=false}if(c===undefined){c="_"}var a=g;if(g.indexOf(" ")!==-1){g=g.replace(/\s+/g,c).toLowerCase()}if(g.indexOf(c)===-1){if(d){g=g.charAt(0).toUpperCase()+g.substr(1)}}else{var b=g.indexOf(c);var f;var e=[];while(b!==-1){f=g.charAt(0).toUpperCase();e.push(f+g.substr(1,b-1));g=g.substr(b+1);b=g.indexOf(c)}e.push(g.charAt(0).toUpperCase()+g.substr(1));g=e.join("");if(!d){g=g.charAt(0).toLowerCase()+g.substr(1)}}if(d){Phoenix.Grammar._camelizeCache.upper[a]=g}else{Phoenix.Grammar._camelizeCache.lower[a]=g}return g};Phoenix.Grammar.inflectOnQuantity=function(a,c,b){if(a!==1){return b.replace("%d",a.toString())}return c};Phoenix.Grammar._splitLastWord=function(b){if(b.indexOf(" ")!==-1){return[b.substr(0,b.lastIndexOf(" ")+1),b.substr(b.lastIndexOf(" ")+1)]}if(b===Phoenix.Grammar.underscorize(b)){if(b.indexOf(" ")===-1){return["",b]}return[b.substr(0,b.lastIndexOf("_")+1),b.substr(b.lastIndexOf("_")+1)]}var a=b.match(/(.*)((?=[a-zA-Z_]|^)(?:[0-9]+|[A-Z][a-z]*)|(?=[0-9A-Z_]|^)(?:[A-Z][a-z]*))$/);if(a.length&&a.length===3){return[a[1],a[2]]}return["",b]};Phoenix.Grammar.pluralize=function(j){if(Phoenix.Grammar._rules.pluralize[j]!==undefined){return Phoenix.Grammar._rules.pluralize[j]}if(Phoenix.Grammar._pluralizeCache[j]!==undefined){return Phoenix.Grammar._pluralizeCache[j]}var a=j;var h=null;var e,c;var d=Phoenix.Grammar._splitLastWord(j);var g,f,k;e=d[0];c=d[1];for(var b=0;b<Phoenix.Grammar._singularToPluralRules.length;b++){f=Phoenix.Grammar._singularToPluralRules[b][0];g=Phoenix.Grammar._singularToPluralRules[b][1];if(f.test(c)){k=c.match(f);h=e+c.replace(f,(k[1]?"$1":"")+g);break}}Phoenix.Grammar._pluralizeCache[a]=h;return h};Phoenix.Grammar.singularize=function(j){if(Phoenix.Grammar._rules.singularize[j]!==undefined){return Phoenix.Grammar._rules.singularize[j]}if(Phoenix.Grammar._singularizeCache[j]!==undefined){return Phoenix.Grammar._singularizeCache[j]}var a=j;var c=null;var e,h,d;var g,f,k;d=Phoenix.Grammar._splitLastWord(j);e=d[0];h=d[1];for(var b=0;b<Phoenix.Grammar._pluralToSingularRules.length;b++){f=Phoenix.Grammar._pluralToSingularRules[b][0];g=Phoenix.Grammar._pluralToSingularRules[b][1];if(f.test(h)){k=h.match(f);c=e+h.replace(f,(k[1]?"$1":"")+g);break}}Phoenix.Grammar._singularizeCache[a]=c;return c};Phoenix.Grammar.addSingularPluralRule=function(b,a){Phoenix.Grammar._rules.singularize[a]=b;Phoenix.Grammar._rules.pluralize[b]=a};Phoenix.Grammar.addHumanizeRule=function(a,b){Phoenix.Grammar._rules.humanize[a]=b};Phoenix.Grammar.addCamelUnderscoreRule=function(a,b){Phoenix.Grammar._rules.camelize[b]=a;Phoenix.Grammar._rules.underscorize[a]=b};
Phoenix.Request={};Phoenix.Request._REQUEST=null;Phoenix.Request._cast=function(d,e){var c,b={"true":1,yes:1,on:1,"false":0,no:0,off:0};var a=d;switch(e){case"number":a=parseInt(d,10);if(isNaN(a)){a=d?1:0}break;case"float":a=parseFloat(a);if(isNaN(a)){a=d?1:0}break;case"bool":case"boolean":c=d&&d.toLowerCase?d.toLowerCase():"";if(b[c]!==undefined){a=b[c]?true:false}else{a=d?true:false}break}return a};Phoenix.Request._initialize=function(){if(Phoenix.Request._REQUEST===null){var a=location.search.substr(1);var b=a.split("&");var d={},e;for(var c=0;c<b.length;c++){e=b[c].split("=");d[e[0]]=e[1]}Phoenix.Request._REQUEST=d}};Phoenix.Request.get=function(b,a,d,c){Phoenix.Request._initialize();if(c===undefined){c=false}if(d===undefined){d=null}if(a===undefined){a="string"}var e=Phoenix.Request._REQUEST[b];if(e===""&&c){return d}else{if(e===undefined){e=d}}if(d!==null){return d}return Phoenix.Request._cast(e,a)};
(function(c){var o=c.Phoenix,b=c.setTimeout,k=c.clearTimeout,t=1250,x=400,w=o.jQuery.getMessageBlock(),y=" ",a="in",e="message-success",j="message-danger",l="message-info",g="transitioning",u=[g,j,l,e],p="successReferrer",z="successMessage",d="errorReferrer",s="errorMessage",v="error",q="notification",f="success",A=[],i=false,m=null;var n=function(C){w.text("").removeClass(u.join(y));if(!!C){try{C()}catch(B){}}};var h=function(C,H,E){var K,L,B,I,F,G="",J=[],M=false,D=false;if(null!==m){k(m);m=null}switch(H){case v:J.push(j);M=d;D=s;break;case q:J.push(l);break;case f:J.push(e);M=p;D=z;break;default:break}if(J.length>0){J.push(a);G=J.join(y)}else{G=a}E=E||{};K=E.callback;L=E.afterPost||false;B=E.permanent||false;I=E.hideDelay||t;F=E.hideDuration||x;if(L===true&&!!M&&!!D){sessionStorage.setItem(M,location.href);sessionStorage.setItem(D,C)}else{if(i){r.clearPermanentMessage()}w.addClass(G).addClass(g).text(C).fadeIn();if(B===false){m=b(function(){k(m);m=null;w.fadeOut(F,function(){n(K)})},I)}else{i=true}}};var r={showSuccessMessage:function(C,B){h(C,f,B)},showMessageBar:function(B){h(B)},showErrorMessage:function(C,B){h(C,v,B)},showNotificationMessage:function(C,B){h(C,q,B)},showPermanentMessage:function(B){h(B,q,{permanent:true})},checkSuccessMessages:function(){var B=sessionStorage.getItem(p);if(B){if(B===document.referrer){var C=sessionStorage.getItem(z);h(C,f)}sessionStorage.removeItem(z);sessionStorage.removeItem(p)}},removePermanentMessage:function(B){w.fadeOut(x,function(){n(B)})},clearPermanentMessage:function(){w.hide();n()},checkErrorMessages:function(){var B=sessionStorage.getItem(d);if(B){if(B===document.referrer){var C=sessionStorage.getItem(s);h(C,v)}sessionStorage.removeItem(s);sessionStorage.removeItem(d)}},showLoadingScreen:function(C){var B=o.jQuery.getLoadingScreen(C);o.jQuery.getBody().append(B)},hideLoadingScreen:function(){var B=o.jQuery.getLoadingScreen(null,true);B.remove()},convertTime:function(E,C){if(!E){E=0}if(E<0||isNaN(E)){E=0}var D=Math.floor(E/60%60);var B=Math.floor((E/60)/60);var F=Math.floor(E%60);if(F<10){F="0"+F}if(D<10){D="0"+D}if(E>3600||C===true){return B+":"+D+":"+F}else{return D+":"+F}}};o.Ui=r;o.jQuery.getDocument().ready(function(){o.Ui.checkSuccessMessages();o.Ui.checkErrorMessages()})})(this);
Phoenix.Core={_debugEnabled:false,keycodes:{enterKey:13,rightArrow:39,leftArrow:37,upArrow:38,downArrow:40,escapeKey:27},isTrue:function(b,a){if(a===undefined){a=false}if(typeof b==="string"){b=b.toLowerCase()}return !!b||"true"===b||a},getDebug:function(){return Phoenix.Core._debugEnabled},enableDebugging:function(a){Phoenix.Core._debugEnabled=a?true:false},debug:function(a){if(Phoenix.Core._debugEnabled){console.log(a)}},basename:function(b){var a=b.split("/");return a[a.length-1]}};
Phoenix.Uploader=function(){return this};Phoenix.Uploader._init=function(b,f){var e;var a=["main","url","previous","search","progress"];var d={progressItem:true,searchItem:true,searchListItem:true,searchImageItem:true};var c={previewImage:true};var g=$.browser.msie&&$.browser.version>=10;$.each(f.modals["uploader"],function(h,i){if(d[h]!==undefined){b._templates[h]=$(i);if(g){b._templates[h].removeClass("fade");b._templates[h].find("*").removeClass("fade")}}else{if(c[h]!==undefined){b._templates[h]=$(i);if(g){b._templates[h].removeClass("fade");b._templates[h].find("*").removeClass("fade")}}else{b._modals[h]=$(i);if(g){b._modals[h].removeClass("fade");b._modals[h].find("*").removeClass("fade")}}}if(h!=="main"&&d[h]===undefined&&c[h]===undefined){b._modals[h].modal(Phoenix.Uploader.SUBMODAL_OPTIONS)}});for(e=0;e<a.length;e++){b._modals[a[e]].appendTo(document.body)}b._templates.previewImage.insertAfter(b._modals.search);b._modals.progress.on("hidden",function(){b._abortXHR();b._resetAll()});b._modals.main.find(".modal-footer").addClass("hide");b._modals.main.modal({show:false,keyboard:true,backdrop:"static"});b._modals.previous.on("hidden",function(){var h=$(this);b._templates.previewImage.find("img").attr("src","");b._templates.previewImage.find(".width").text("");b._templates.previewImage.find(".height").text("");h.find(".galleries > li:not(:first-child)").remove();h.find(".images-in-gallery > li:not(.loading)").remove()});if(typeof window.File==="undefined"){b._modals.main.find(".modal-body > p").addClass("hide")}Phoenix.jQuery.getDocument().trigger("uploaderReady");return b};Phoenix.Uploader.DEFAULT_OPTIONS={complete:function(a){Phoenix.Core.debug("> complete");Phoenix.Core.debug(a)},error:function(a){Phoenix.Core.debug("> error");Phoenix.Core.debug(a);if(a.message){Phoenix.Ui.showErrorMessage("Problem occured while uploading image: "+a.message)}},logger:function(a){Phoenix.Core.debug("> logger");Phoenix.Core.debug(a)},type:"image",headerText:"Where does your image live?",postURL:"/images/upload",urlPostURL:"/images/url-submit",placeholderIcon:"",fileType:["image/gif","image/jpeg","image/png"],multiple:false,drop:true,dropText:"Or drag and drop your image to this window.",urlFieldCount:3,showButtons:["desktop","url-address","search-site","previous-uploads"]};Phoenix.Uploader.SUBMODAL_OPTIONS={backdrop:false,show:false};Phoenix.Uploader.EVENT_NAMESPACE="uploader";Phoenix.Uploader.prototype._modals={main:null,url:null,search:null,previous:null,progress:null};Phoenix.Uploader.prototype._templates={progressItem:null,searchImageItem:null};Phoenix.Uploader._instance=null;Phoenix.Uploader._lastDroppedFiles=[];Phoenix.Uploader.getInstance=function(a){if(Phoenix.Uploader._instance===null){Phoenix.Uploader._instance=new Phoenix.Uploader()}if(typeof a==="function"){a.apply(Phoenix.Uploader._instance,[])}return Phoenix.Uploader._instance};Phoenix.Uploader.prototype.getDefaultProgressListener=function(b){var a=this;return function(g){if(!g.lengthComputable){Phoenix.Core.debug("defaultProgressListener(): length not computable!");a._currentOptions.logger({message:"Unable to calculate progress percentage."});b.find(".bar").css("width","100%");b.find(".percent").text("Saving... please wait");return}var c=g.loaded||g.position;var f=g.total||g.totalSize;var d=Math.round(((c/f)*100));b.find(".bar").css("width",d+"%");b.find(".percent").text(d+"%");if(d>99){b.find(".percent").text("Saving... please wait")}}};Phoenix.Uploader.prototype._resetAll=function(){var a=this._modals.progress;var c=this._modals.url;var e=this._modals.search;var b=this._modals.previous;var d=e.find(".galleries > li");this._lastDroppedFiles=[];a.find("li").remove();$.each(this._modals,function(g,f){f.modal("hide")});e.find("input").val("");b.find("input").val("");c.find("input").each(function(f){if(f===0){$(this).val("");return true}$(this).remove()});d.each(function(f){if(f===0){return true}$(this).remove();f++});b.find(".galleries > li").remove();this._templates.previewImage.find("img").attr("href","");this._templates.previewImage.find(".width").text("");this._templates.previewImage.find(".height").text("");return this};Phoenix.Uploader.prototype._xhr=null;Phoenix.Uploader.prototype._sendFiles=function(b){var d=this._lastDroppedFiles;var f=new FormData(this._modals.main.find("form")[0]);var h=this._xhr=new XMLHttpRequest();var a=this;var e=this._modals.progress.find("ul");if(d.length===0){Phoenix.Core.debug("_sendFiles(): files.length === 0!");return this}for(var c=0;c<d.length;c++){f.append("files["+c+"]",d[c])}if(b===undefined){b=this.getDefaultProgressListener(e)}h.ontimeout=function(){a._currentOptions.error($.extend({},{status:this.status},f));this.abort();a._resetAll()};var g=function(){var n={};var m=false;var j,p;var l;var k;if(this.readyState===4){if(this.status===200){n=$.parseJSON(this.responseText);m=$.isPlainObject(n);if(!m||!n.successful){a._currentOptions.error({message:'No "successful" array/object was returned in the JSON response.'});return}a._modals.progress.find(".progress").addClass("progress-success");a._modals.progress.find(".progress").removeClass("active");e.find(".bar").css("width","100%");e.find(".percent").text("Done!");k=0;$.each(n.successful,function(i,q){if(d[k]===undefined){return false}if(d[k].name){n.successful[i]["clientName"]=d[k].name}if(d[k].type){n.successful[i]["clientType"]=d[k].type}k++});a._currentOptions.complete(n);a._resetAll()}else{try{n=$.parseJSON(this.responseText);m=$.isPlainObject(n)}catch(o){m=true;n={errors:{file:"Failed to upload file. Please try again."}}}if(a._currentOptions.type==="image"){l="images"}else{l="files"}Phoenix.Ui.showErrorMessage("Error uploading "+l+": "+this.statusText);a._currentOptions.error($.extend({},{status:this.status},m?n:{successful:{}}));this.abort();a._resetAll()}try{a._modals.main.find("input")[0].value=""}catch(o){p=$("#js-uploader-file-input");j=$("#js-uploader-file-input").clone(true);j.val("");p.remove();a._modals.main.prepend(j)}}else{if(this.readyState>1){try{if(this.status===413){n={message:this.responseText};a._currentOptions.error($.extend({},{status:this.status},n));this.abort();a._resetAll()}else{if(this.status===504){n={message:"Request timed out"};a._currentOptions.error($.extend({},{status:this.status},n));this.abort();a._resetAll()}}}catch(o){a._currentOptions.error(o)}}}};$.get("/blank.html");h.upload.addEventListener("loadstart",function(){},false);h.upload.addEventListener("progress",b,false);h.addEventListener("error",function(){a._currentOptions.error({message:"An error occurred during the request.",args:arguments});Phoenix.Ui.showErrorMessage("Error")},false);h.addEventListener("readystatechange",g,false);h.open("POST",this._currentOptions.postURL);h.setRequestHeader("Cache-Control","no-cache");h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.send(f);return this};Phoenix.Uploader.prototype._abortXHR=function(){if(this._xhr!==null){this._xhr.abort()}return this};Phoenix.Uploader.prototype._commonFileOnRead=function(b,a){var c=this;return function(){var d=a._modals.progress;var e=d.find("ul");var f=a._templates.progressItem.clone();f.find("img").attr("src",c.type.substr(0,6)==="image/"?this.result:a._currentOptions.placeholderIcon);f.find(".details > .name").text(c.name);f.find(".details > .percent").text("1%");f.find(".progress > .bar").css("width","1%");e.append(f);if(b){var g="image";if(a._currentOptions.type==="media"){g="file"}if(a._currentOptions.multiple){g+="s"}d.find(".js-modal-title").text("Uploading "+g);d.modal("show");a._sendFiles()}}};Phoenix.Uploader.prototype._modalFileUpload=function(){var b=this._modals.progress;var h="image";var f;var c=b.find("ul");for(var e=0,d,g,a=this._lastDroppedFiles.length;e<a;e++){d=this._lastDroppedFiles[e];if(typeof window.FileReader!=="undefined"){g=new FileReader();g.onloadend=this._commonFileOnRead.call(d,e===(this._lastDroppedFiles.length-1),this);g.readAsDataURL(d)}else{f=this._templates.progressItem.clone();f.find("img").attr("src",this._currentOptions.placeholderIcon);f.find(".details > .name").text(d.name);f.find(".details > .percent").text("1%");f.find(".progress > .bar").css("width","1%");c.append(f);if(e===(this._lastDroppedFiles.length-1)){if(this._currentOptions.type==="media"){h="file"}if(this._currentOptions.multiple){h+="s"}b.find(".js-modal-title").text("Uploading "+h);b.modal("show");this._sendFiles()}}}};Phoenix.Uploader.prototype._createListItem=function(b,a){if(this._currentOptions.type!=="image"||a===undefined){a=this._currentOptions.placeholderIcon}var c=this._templates.progressItem.clone();c.find("img").attr("src",a);c.find(".details > .name").text(b);c.find(".details > .percent").text("1%");c.find(".progress > .bar").css("width","1%");return c};Phoenix.Uploader._sendURLsCallback=function(){var l=this._modals.url;var b=l.find('[type="url"]');var k={};var f=0;var a=typeof b[0].checkValidity==="function";var m=this;var h=this._modals.progress;var d=h.find("ul");var c=l.find(".error-message");var j=false;var g=0;c.addClass("hide");b.each(function(){var n=$(this).val();if(!n){return}if((a&&!this.checkValidity())||!/^https?\:\/\//.test(n)){c.removeClass("hide");j=true;return false}var i=n.split(/https?\:\/\//);var o;if(!i[0]){o=i[1]}else{o=i[0]}o=o.substr(0,20)+"...";var p;k["urls["+f+"]"]=n;p=m._createListItem(o,n);d.append(p);g++;f++});if(f===0||j){return}var e=function(o,i){var n=d.children("li");n.find(".progress > .bar").css("width",i+"%");n.find(".details > .percent").text(o)};e("",0);h.modal("show");setTimeout(function(){e("Saving... please wait",25)},200);this._xhr=$.post(this._currentOptions.urlPostURL,k,function(i){e("Done",100);h.find(".progress").addClass("progress-success");h.find(".progress").removeClass("active");$.each(i.successful,function(n,o){i.successful[n]["clientName"]=o.name?o.name:"";i.successful[n]["clientType"]=o.mimeType?o.mimeType:""});setTimeout(function(){m._resetAll();m._currentOptions.complete(i);m._resetAll()},300)},"json").error(function(o){var i;try{i=$.parseJSON(o.responseText)}catch(n){i={url:"An unknown error occurred. Please try again."}}m._resetAll();m._currentOptions.error(i)})};Phoenix.Uploader.prototype._eventsBound={desktopButtonClick:false,fileInputChange:false,urlModalNext:false,searchModalNext:false,searchModalClose:false,previousModalNext:false,previousModalClose:false,urlAddFieldClick:false,searchFieldAutocomplete:false,dragAndDrop:false,previousModalShown:false,modalEditClick:false,modalSelectButtonClick:false,modalPreviewClick:false,previousModalScroll:false,galleryImageClick:false,searchModalTagClick:false};Phoenix.Uploader._currentSearchGUID=null;Phoenix.Uploader._addURLFieldCallback=function(b){var d=$(this);var c=d.parent();var a=c.find("input").length;if(a===10){b.preventDefault();return false}var e=c.find("input:first-child").clone();e.val("").insertBefore(d);b.preventDefault();return false};Phoenix.Uploader.prototype._enableDragAndDrop=function(d){if(typeof window.File==="undefined"){return this}var b=Phoenix.jQuery.getBody();var a=this;var e=function(f){f.preventDefault();f.stopPropagation();if(!f.originalEvent.dataTransfer||!f.originalEvent.dataTransfer.files){return false}a._lastDroppedFiles=f.originalEvent.dataTransfer.files;if(!a._currentOptions.multiple){a._lastDroppedFiles=[a._lastDroppedFiles[0]]}a._modalFileUpload();return false};var c=function(f){f.preventDefault();f.stopPropagation();return false};if(!d&&this._eventsBound.dragAndDrop){b.unbind("dragover."+Phoenix.Uploader.EVENT_NAMESPACE);b.unbind("drop."+Phoenix.Uploader.EVENT_NAMESPACE);this._eventsBound.dragAndDrop=false;return this}if(!this._eventsBound.dragAndDrop){b.bind("dragover."+Phoenix.Uploader.EVENT_NAMESPACE,c);b.bind("dragenter."+Phoenix.Uploader.EVENT_NAMESPACE,c);b.bind("drop."+Phoenix.Uploader.EVENT_NAMESPACE,e);this._eventsBound.dragAndDrop=true}return this};Phoenix.Uploader.show=function(){var a=/Safari\/\d+/.test(navigator.userAgent)&&navigator.vendor==="Apple Computer, Inc.";var b;Phoenix.Uploader.getInstance(function(){var B=this;var C=this._modals.main;var u=false;var y,x,f;var E;if(!C){return}var s=$("#js-uploader-file-input");var h=$("#js-desktop-button");var t=this._modals.url;var c=t.find(".js-add-another");var F=$("#swfuploader-placeholder");var v="/bundles/phoenixsite/images/core/loose/loading-light.gif";C.find(".js-modal-title").text(this._currentOptions.headerText);if(a){C.on("shown",function(){s.css($.extend({},{width:h.outerWidth()},h.position()));s.css("top",parseInt(s.css("top"),10)+1);C.off("shown")})}else{if(!this._eventsBound.desktopButtonClick){if(typeof window.File==="function"||typeof window.File==="object"){$(window).bind("blur",function(){h.prop("disabled",true);setTimeout(function(){h.prop("disabled",false)},2000)}).bind("focus",function(){h.prop("disabled",false)});h.click(function(G){s.click();G.preventDefault();return false});s.css("left",-10000)}else{s.addClass("hide");if(F.length===0){F=$('<div id="swfuploader-placeholder">').insertAfter(h)}var w=0;var k=0;var i=[];b=new SWFUpload({upload_url:this._currentOptions.postURL,flash_url:"/bundles/phoenixsite/flash/swfupload.swf",file_size_limit:"10 MB",file_post_name:"files[]",button_placeholder_id:"swfuploader-placeholder",button_width:73,button_height:20,post_params:{"X-Requested-With":"SWFUpload"},file_upload_limit:this._currentOptions.multiple?10:1,prevent_swf_caching:false,button_text:h.text(),button_cursor:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,file_dialog_complete_handler:function(G){w=0;k=G;this.startUpload()},upload_start_handler:function(J){var I=B._modals.progress;var H=I.find("ul");var G;if(I.hasClass("hide")){I.modal("show")}G=B._templates.progressItem.clone();G.attr("id","swfupload-"+J.id);G.find("img").attr("src",v);G.find(".details > .name").text(J.name);G.find(".details > .percent").text("1%");G.find(".progress > .bar").css("width","1%");H.append(G)},upload_progress_handler:function(J,K,G){var I=Math.round((K/G)*100)+"%";var H=$("#swfupload-"+J.id);H.find(".details > .percent").text(I);H.find(".progress > .bar").css("width",I)},upload_error_handler:function(G,I,H){throw [G,I,H]},upload_success_handler:function(I,J){var H=$("#swfupload-"+I.id);H.find(".details > .percent").text("100%");H.find(".progress > .bar").css("width","100%");w++;if(!B._currentOptions.multiple){B._currentOptions.complete($.parseJSON(J))}else{if(w==k){i.push(J);var G={successful:{}};$.each(i,function(L,K){try{var N=$.parseJSON(K)["successful"];$.each(N,function(O,P){G.successful[O]=P})}catch(M){}});B._currentOptions.complete(G);i=[]}else{if(B._currentOptions.multiple){i.push(J)}}}},upload_complete_handler:function(){if(B._currentOptions.multiple&&w<k){this.startUpload()}},swfupload_loaded_handler:function(){h.prop("disabled",false);F=h.next("object").css({marginLeft:-h.outerWidth()-5,marginRight:5,opacity:0,width:h.outerWidth(),height:h.outerHeight(),position:"relative",top:12})}});h.prop("disabled",true)}this._eventsBound.desktopButtonClick=true}}if(!this._eventsBound.fileInputChange){if(typeof window.File==="function"||typeof window.File==="object"){s.change(function(){if(this.files&&this.files.length){B._lastDroppedFiles=this.files;B._modalFileUpload()}})}this._eventsBound.fileInputChange=true}s.prop("multiple",this._currentOptions.multiple);s.attr("accept",this._currentOptions.fileType.join(","));if(!this._currentOptions.multiple){c.addClass("hide")}else{c.removeClass("hide");if(!this._eventsBound.urlAddFieldClick){c.click(Phoenix.Uploader._addURLFieldCallback);this._eventsBound.urlAddFieldClick=true}}if(!this._eventsBound.urlModalNext){t.find(".js-btn-next").click(function(G){Phoenix.Uploader._sendURLsCallback.apply(B,[]);G.preventDefault();return false});this._eventsBound.urlModalNext=true}var r=function(){Phoenix.Core.debug("Error occurred while getting data.");Phoenix.Core.debug(arguments,true)};var q=B._modals.search.find(".images-in-gallery");var D=B._modals.search.find(".galleries");var p=function(G){return function(I,H){var K=H.original;var L=H.thumbnail;var M=B._templates.searchImageItem.clone();var J=M.find(".dimensions");M.attr("data-original-url",K);M.attr("data-original-width",H.width);M.attr("data-original-height",H.height);M.attr("data-image-id",H.id);M.attr("data-mimetype",H.mimetype);M.find("img").attr("src",L);M.find("a").attr("title",H.caption);J.find(".width").text(H.width);J.find(".height").text(H.height);M.insertBefore(G.children("li.loading"))}};var m=function(G){return function(K,J){var I=J.name;var M=J.id;var L,H;if(I.toLowerCase()==="all images"){H=G.find(".all-images-link").parent();if(H.length===0){H=$('<li class="selected"/>');H.append($('<a href="#" class="all-images-link"/>').text("All Images"));G.append(H)}H.children("a").attr("data-id",M);return}L=$("<li>");L.append($('<a href="#">').text(I).attr("data-id",M));G.append(L)}};var o=function(H,G){return function(M){var L=M.images;var J=M.tags;var N=q.parent().find(".js-no-images");var I=q.parent().find("li.loading");var K=q.parent().find(".js-error");I.addClass("hide");N.addClass("hide");K.addClass("hide");if(G===undefined||G){q.find("li:not(.loading)").remove()}if(L===undefined||J===undefined||L.length===0){N.removeClass("hide");return}$.each(L,p(q));if(H){$.each(J,m(D))}}};var e=function(I,G,H){return function(M){var O=$(this);var P=parseInt(O.attr("data-id"),10);var K={count:16,tag:P};var N=O.parent().find(".js-no-images");var J=q.parent().find("li.loading");var L=q.parent().find(".js-error");J.removeClass("hide");N.addClass("hide");L.addClass("hide");if(isNaN(P)){J.addClass("hide");L.removeClass("hide");M.preventDefault();return false}q.find("li:not(.loading)").remove();O.parents(".galleries").find("li").removeClass("selected");O.parent().addClass("selected");if(H){K=$.extend({},K,{object:B._currentSearchGUID})}$.post(I,K,G(false),"json").error(function(){r();J.addClass("hide");L.removeClass("hide")});M.preventDefault();return false}};if(!this._eventsBound.searchFieldAutocomplete){var g=this._modals.search.find("input");g.autocomplete({autoRedirect:false,delay:0,showNotificationBar:true,onItemSelect:function(I){if(!Object.keys(I).length){return false}B._modals.search.children("form").trigger("reset");if(isNaN(I.contentTypeId)){return false}if(isNaN(I.id)){return false}var H=I.contentTypeId+"-"+I.id;var G={object:H,count:16};B._modals.search.find("li:not(.loading)").remove();B._modals.search.find("li.loading").removeClass("hide");B._modals.search.find(".js-error").addClass("hide");B._modals.search.find(".js-no-images").addClass("hide");B._currentSearchGUID=H;AjaxApiRequest.makePostApiRequest("/api/image/object-image/",G,o(true),function(){r();B._modals.search.find("li.loading").addClass("hide");B._modals.search.find(".js-error").removeClass("hide")});return false}});this._eventsBound.searchFieldAutocomplete=true}if(!this._eventsBound.searchModalClose){var d=function(){var G=$(this);G.find(".galleries > li:not(:first-child)").removeAttr("data-id").remove();G.find(".images-in-gallery > li:not(.loading)").remove()};this._modals.search.on("hidden",d);this._eventsBound.searchModalClose=true}if(!this._eventsBound.searchModalTagClick){this._modals.search.on("click",".galleries > li > a",e("/api/image/object-image/",o,true));this._eventsBound.searchModalTagClick=true}E=function(H,G){return function(O){var N=O.images;var L=O.tags;var K=B._modals.previous.find(".images-in-gallery");var J=B._modals.previous.find(".galleries");var I=J.parent().find("li.loading");var P=J.parent().find(".js-no-images");var M=J.parent().find(".js-error");I.addClass("hide");P.addClass("hide");M.addClass("hide");if(G===undefined||G){K.children("li:not(.loading)").remove()}if(N===undefined||L===undefined||!N.length){P.removeClass("hide");return}$.each(N,p(K));if(H){$.each(L,m(J))}}};if(!this._eventsBound.previousModalShown){this._modals.previous.on("show",function(){var G=$(this).find(".loading");G.removeClass("hide");AjaxApiRequest.makePostApiRequest("/api/image/user-image/",{count:16},E(true),function(){G.addClass("hide")})});this._modals.previous.on("click",".galleries > li > a",function(H){var J=$(this);var K=parseInt(J.attr("data-id"),10);var I=J.parents(".galleries");var G=I.siblings(".images-in-gallery-container");if(isNaN(K)){G.find(".js-error").removeClass("hide");H.preventDefault();return false}G.find("li:not(.loading)").remove();G.find("li.loading").removeClass("hide");I.find("li").removeClass("selected");J.parent().addClass("selected");AjaxApiRequest.makePostApiRequest("/api/image/user-image/",{count:16,tag:K},E(),function(){r();G.find("li.loading").addClass("hide");G.find(".js-error").removeClass("hide")});H.preventDefault();return false});this._eventsBound.previousModalShown=true}var A=function(G){return function(){var J=$(this).parents("li");var I;var H=J.attr("data-original-url");if(!B._currentOptions.multiple){J.parent().children("li").removeClass("selected")}J.addClass("selected");I={successful:{}};I.successful[H]={url:H,clientName:Phoenix.Core.basename(H),clientType:J.attr("data-mimetype"),id:null,guid:null};I.from=G;B._currentOptions.complete(I)}};if(!this._eventsBound.modalEditClick){this._modals.previous.on("click","li span.js-edit",A("previous"));this._modals.search.on("click","li span.js-edit",A("search"));this._eventsBound.modalEditClick=true}if(!this._eventsBound.modalPreviewClick){var n=function(){var G=B._templates.previewImage;var L=$(this).parents("li");var J=L.attr("data-original-url");var I=L.attr("data-original-width");var K=L.attr("data-original-height");var H=L.find("a").attr("title");G.find(".width").text(I);G.find(".height").text(K);G.find("img").attr("src",J).attr("title",H);G.removeClass("hide")};this._modals.previous.on("click","li span.js-preview",n);this._modals.search.on("click","li span.js-preview",n);this._templates.previewImage.on("click",function(){$(this).addClass("hide")});this._eventsBound.modalPreviewClick=true}if(!this._eventsBound.modalSelectButtonClick){var l=function(G){return function(J){var I=B._modals[G];var H=I.find(".images-in-gallery > li.selected");var K={successful:{}};if(H.length!==0){H.each(function(){var L=$(this).attr("data-original-url");var M=parseInt($(this).attr("data-image-id"),10);K.successful[L]={url:L,id:isNaN(M)?null:M,guid:isNaN(M)?null:"1300-"+M}});B._currentOptions.complete(K);I.modal("hide");C.modal("hide")}J.preventDefault();return false}};this._modals.previous.on("click",".btn-success",l("previous"));this._modals.search.on("click",".btn-success",l("search"));this._eventsBound.modalSelectButtonClick=true}var j=function(K,L,G,J,H,I){return function(){if((this.scrollHeight-this.offsetHeight)===this.scrollTop&&!u){var P=J.find("li:not(.loading)").length;var O=parseInt(L.parent().find(".galleries > .selected > a").attr("data-id"),10);var N={count:16,start:P,tag:O};var M=L.find("li.loading");M.removeClass("hide");if(isNaN(O)){M.addClass("hide");return}if(I){N=$.extend({},N,{object:B._currentSearchGUID})}u=true;AjaxApiRequest.makePostApiRequest(K,N,function(Q){u=false;M.addClass("hide");(H(false,false))(Q);if(!Q||!Q.images||!Q.images.length){L.find(".js-no-images").hide()}},function(){M.addClass("hide");window.alert("Error loading images. Please try again")})}}};if(!this._eventsBound.previousModalScroll){y=this._modals.previous.find(".images-in-gallery-container");x=this._modals.previous.find(".images-in-gallery-container > .navigation");f=this._modals.previous.find(".images-in-gallery");y.on("scroll",j("/api/image/user-image/",y,x,f,E));this._eventsBound.previousModalScroll=true}if(!this._eventsBound.searchModalScroll){y=this._modals.search.find(".images-in-gallery-container");x=this._modals.search.find(".images-in-gallery-container > .navigation");f=this._modals.search.find(".images-in-gallery");y.on("scroll",j("/api/image/object-image/",y,x,f,o,true));this._eventsBound.searchModalScroll=true}if(!this._eventsBound.galleryImageClick){var z=function(G){var I=$(this);var H=I.parent();if(H.hasClass("selected")){H.removeClass("selected")}else{if(!B._currentOptions.multiple){H.parent().find(".selected").removeClass("selected")}H.addClass("selected")}G.preventDefault();return false};this._modals.previous.on("click",".images-in-gallery > li > a",z);this._modals.search.on("click",".images-in-gallery > li > a",z);this._eventsBound.galleryImageClick=true}this._enableDragAndDrop(this._currentOptions.drop);this._modals.main.find(".modal-body > p").text(this._currentOptions.dropText)})};Phoenix.Uploader.uploadDataURIImage=function(g,j,n,c){var d=typeof Blob==="function"&&typeof FormData==="function"&&typeof Uint8Array==="function"&&typeof ArrayBuffer==="function"&&typeof DataView==="function";var o,e,a;var f,k,l,m;var h,b;if(d){o=new XMLHttpRequest();e=new FormData();j=Phoenix.Core.basename(j);if(g.split(",")[0].indexOf("base64")>=0){f=window.atob(g.split(",")[1])}else{f=window.unescape(g.split(",")[1])}k=g.split(",")[0].split(":")[1].split(";")[0];l=new ArrayBuffer(f.length);m=new Uint8Array(l);for(h=0,b=f.length;h<b;h++){m[h]=f.charCodeAt(h)}e.append("filename",j);e.append("blob",new window.Blob([new DataView(l)],{type:k}));o.addEventListener("error",function(){Phoenix.Core.debug({message:"An error occurred during the request.",args:arguments})},false);o.addEventListener("readystatechange",function(){var p;if(this.readyState===4){if(this.status===200){try{p=$.parseJSON(this.responseText);n({successful:{editedImage:{name:j,id:p.id,url:p.url,guid:"1300-"+p.id}}})}catch(i){c()}}}},false);o.open("POST","/images/upload/blob/");o.setRequestHeader("Cache-Control","no-cache");o.setRequestHeader("X-Requested-With","XMLHttpRequest");o.send(e)}else{a={filename:j,data_uri:g};if(!a.filename){a.filename=Phoenix.Cryptography.randomString(16,"alphanumeric")}a.filename=Phoenix.Core.basename(a.filename);AjaxApiRequest.makePostApiRequest("/images/upload/data-uri/",a,function(i){n({successful:{editedImage:{name:a.filename,id:i.id,url:i.url,guid:"1300-"+i.id}}})})}};Phoenix.Uploader.prototype._currentOptions=Phoenix.Uploader.DEFAULT_OPTIONS;$(document).ready(function(){var a=$("meta[name=modal-cdn-url]").attr("content");$.getJSON(a,function(b){Phoenix.Uploader._init(Phoenix.Uploader.getInstance(),b)});$.uploader=function(b){Phoenix.Uploader.getInstance(function(){if(b.multiple===undefined){b.multiple=false}this._currentOptions=$.extend({},Phoenix.Uploader.DEFAULT_OPTIONS,b);this._originalCallback=this._currentOptions.complete;var c=this;var d=["desktop","url-address","search-site","previous-uploads"];if(!this._modals.progress){return}this._modals.progress.find(".modal-header > .close").click(function(f){c._abortXHR();c._resetAll();f.preventDefault();return false});$.each(d,function(e,g){var f=$('button[data-target="#js-'+g+'-modal"]');if(0<=$.inArray(g,c._currentOptions.showButtons)){f.removeClass("hide")}else{f.addClass("hide")}});Phoenix.Uploader.show()})}});
(function(c){var b="ViewGuid";var i="#view-guid-meta";var f=c.jQuery,h=c.Phoenix||{},a=c.uuid,g=!!h.getDocument?h.getDocument():f(c.document);var d;var e=function(){if(d===undefined){d=f(i)}return d};var j;var k=function(){var m=e();j=a.v1();if(m.length>0){m.attr("content",j)}};var l=function(){var m=e();j=f.cookie("vguid");if(j&&j!=null){m.attr("content",j)}else{j=m.attr("content");if(j===null){k()}if(!j){k()}}g.on("pre_page_event",function(){k()})};l();h[b]={get:function(){if(j===undefined){k()}return j}};c.Phoenix=h})(this);
(function(f){f.fn.autocomplete=function(j){var k=j||{},i=f();if(typeof j==="string"){throw new Error("Please pass options as an object.")}return this.each(function(){if(f(this).data().autocompleter){return}var l=f(this).data();var m=f.extend({},f.fn.autocomplete.defaults,k,l);if(typeof m.enableForMedia==="string"&&window.matchMedia&&!window.matchMedia(m.enableForMedia).matches){return false}if(m.multiple===false){m.podLimit=1}i.add(new b(f(this),m))})};f.fn.autocomplete.defaults={loadingClass:"loading",resultsClass:"dropdown-menu typeahead typeahead-full",resultListId:"resultsWrap",selectClass:"selected",queryParamName:"q",extraParams:{},url:"/jsonsearch/",minChars:1,maxItemsToShow:10,delay:300,useCache:false,maxCacheLength:10,matchSubset:true,matchCase:false,matchInside:true,mustMatch:false,selectFirst:false,selectOnly:false,showResult:null,preventDefaultReturn:true,preventDefaultTab:false,filterResults:false,sortResults:false,sortFunction:null,onActivate:null,onItemSelect:null,onNoMatch:null,onFinish:null,onRequestComplete:null,matchStringConverter:null,autoWidth:"min-width",useDelimiter:false,delimiterChar:",",delimiterKeyCode:188,onError:null,autoRedirect:false,placeholderGraphic:"/bundles/phoenixsite/images/core/loose/no-image-30x30.png",emptyText:"'tis but a barren wasteland",showEmptyText:true,podInputName:null,podInputNoIndex:false,searchIndex:null,searchField:null,resultPodTemplate:false,podLimit:5,parentClass:"autocomplete",podClass:"resultPod",inputRequired:null,showNotificationBar:false,parentModal:null,extraClasses:null,sortable:false,sortableOrderFieldName:null,multiple:true,notificationText:null,notificationClass:null,notificationBarSearch:false,notificationSearchUrl:null,afterShowResults:null,finishOnBlur:true,stopPositioning:false,bodyOnClickFilter:[],enableForMedia:null};var e=function(k){var j={},i=f.type(k);if(i==="string"){j.name=k.name;j.url=k.url;j.id=k.id}else{if(i==="object"){j.name=k.name||k.title;j.type=k.bundle||k.type||k.label;j.id=k.native_id||k.id;j.contentTypeId=k.content_type_id;j.image=k.image_thumbnail_url;j.url=k.url;j.full_name=k.full_name;j.label=k.label}}return j};var g=function(l,i,k){var j=parseInt(l,10);k=k||{};if(isNaN(j)||(k.min&&j<k.min)){j=i}return j};var a=function(i,j){return[i,encodeURIComponent(j)].join("=")};var c=function(j,k){var i=[];f.each(k,function(l,m){i.push(a(l,m))});if(i.length){j+=j.indexOf("?")===-1?"?":"&";j+=i.join("&")}return j};var h=function(j,i,k){j=String(j.id);i=String(i.id);if(!k){j=j.toLowerCase();i=i.toLowerCase()}if(j>i){return 1}if(j<i){return -1}return 0};var b=function(i,n){if(!i||!(i instanceof f)||i.length!==1||i.get(0).tagName.toUpperCase()!=="INPUT"){throw new Error("Invalid parameter for jquery.Autocompleter, jQuery object with one element with INPUT tag expected.")}var t=this;var q;this.options=n;this.cacheData_={};this.draggableOptions_={containment:"parent"};this.droppableOptions_={drop:function(w,x){var z=f(w.target);var y=x.draggable;var v=y.html();var A=z.html();var u=[];z.html(v);y.html(A);z.attr("style","position:relative");y.attr("style","position:relative");z.parent().find('input[type="hidden"]').each(function(C){var E=f(this);var B=E.attr("name");var D=B.match(/(.*\])\[\d+\]$/);if(!f.isArray(D)||D[1]===undefined){return}E.attr("name",D[1]+"["+C+"]")})}};this.canDoSortable_=!!(f.ui&&f.ui.draggable&&f.ui.droppable);this.cacheLength_=0;this.selectClass_=this.options.selectClass;this.lastKeyPressed_=null;this.lastProcessedValue_=null;this.lastSelectedValue_=null;this.active_=false;this.finishOnBlur_=this.options.finishOnBlur;this.paginationOffset_=0;this.pageNumber_=1;this.maxOffset_=0;this.extraParams_=f.extend({},this.options.extraParams)||{};this.podCount_=0;this.curJQXHR_=null;this.resultsShowing=false;this.resultsPaginating_=false;this.options.minChars=g(this.options.minChars,f.fn.autocomplete.defaults.minChars,{min:0});this.options.maxItemsToShow=g(this.options.maxItemsToShow,f.fn.autocomplete.defaults.maxItemsToShow,{min:0});this.options.maxCacheLength=g(this.options.maxCacheLength,f.fn.autocomplete.defaults.maxCacheLength,{min:1});this.options.delay=g(this.options.delay,f.fn.autocomplete.defaults.delay,{min:0});this.dom={};this.dom.$elem=i;this.dom.$parent=i.parent("."+this.options.parentClass);this.dom.$first=null;this.dom.$notificationBar=null;if(!this.options.autoRedirect&&this.dom.$parent){this.dom.$existingPods=this.dom.$parent.find("."+this.options.podClass);this.podCount_=this.dom.$existingPods.length}this.options.inputRequired=!!i.attr("required");if(this.options.extraClasses){this.options.resultsClass+=" "+f.trim(this.options.extraClasses)}this.options.podInputName=this.options.podInputName||this.dom.$elem.attr("name");this.dom.$elem.attr("autocomplete","off");this.dom.$results=f('<div class="'+this.options.resultsClass+'"></div>').hide();var o=this.dom.$elem.outerWidth();if(o>0){this.dom.$results.css("width",o+"px")}f(window).on("resize",function(u){if(!t.options.stopPositioning){var v=t.dom.$elem.outerWidth();if(v>0){t.dom.$results.css("width",v+"px")}t.position()}});this.dom.$resultList=f('<ul class="js-autocomplete-list" id="'+this.options.resultListId+'"></ul>');this.dom.$resultList.appendTo(this.dom.$results);this.dom.$container=(this.options.parentModal)?f(this.options.parentModal):Phoenix.jQuery.getBody();if(this.options.showNotificationBar){var p=f('<li class="notificationBar"><span id="notificationText">Searching for</span> <span id="notificationTerm"></span></li>');if(this.options.notificationClass){p.addClass(this.options.notificationClass)}this.dom.$first=p.prependTo(this.dom.$resultList);this.dom.$notificationTerm=this.dom.$results.find("#notificationTerm");this.dom.$notificationText=this.dom.$results.find("#notificationText");this.dom.$notificationBar=p;var j=this;if(this.options.notificationBarSearch){p.click(function(v){var w=j.dom.$elem.val();var u=j.makeUrl(w,j.options.notificationSearchUrl);window.location=u})}else{if(this.options.onNotificationBarClick){p.click(function(u){j.options.onNotificationBarClick(u,j)})}}}this.dom.$container.append(this.dom.$results);i.keydown(function(u,v){t.lastKeyPressed_=u.keyCode;switch(t.lastKeyPressed_){case t.options.delimiterKeyCode:if(t.options.useDelimiter&&t.active_){t.selectCurrent()}break;case 35:case 36:case 16:case 17:case 18:case 37:case 39:break;case 38:u.preventDefault();if(t.active_){t.focusPrev()}else{t.activate()}return false;case 40:u.preventDefault();if(t.active_){t.focusNext()}else{t.activate()}return false;case 9:if(t.active_){t.selectCurrent();if(t.options.preventDefaultTab){u.preventDefault();return false}}break;case 13:if(v===true){delete t.extraParams_.page;t.pageNumber_=1;t.activateNow(true);u.preventDefault();return false}if(t.active_){t.selectCurrent();u.preventDefault();return false}if(t.options.preventDefaultReturn){u.preventDefault();return false}break;case 27:if(t.active_){u.preventDefault();t.deactivate(true);return false}break;default:t.activate()}}).click(function(){t.activateNow()});this.bodyClickEvent=null;this.onClickHandler=function(w){var v=false;var u=f(w.target);f.each(t.options.bodyOnClickFilter,function(x,y){v=u.is(y)||f(y).find(u).length!==0;if(v){return false}});if(v){return}if(w.target==i[0]||u.hasClass("next")||u.hasClass("prev")){w.preventDefault();return false}t.resultsPaginating_=false;t.deactivate()};this.dom.$body=f("body");this.checkRequiredAttribute=function(){if(this.options.inputRequired){if(this.podCount_>0){i.removeAttr("required")}else{i.attr("required","required")}}};if(this.dom.$parent.length>0){var s="."+this.options.podClass,k=s+" i";this.dom.$parent.on("click",k,function(u){f(this).parent("."+t.options.podClass).remove();t.podCount_--;t.checkRequiredAttribute();if(t.options.podLimit===null||t.podCount_<t.options.podLimit){t.dom.$elem.removeClass("hide")}u.preventDefault();u.stopPropagation()})}if(this.options.podLimit!==null&&this.podCount_>=this.options.podLimit){this.dom.$elem.addClass("hide")}if(this.options.sortable&&this.canDoSortable_){q=this.dom.$parent.find("."+this.options.podClass);q.draggable(this.draggableOptions_);q.droppable(this.droppableOptions_);this.dom.$parent.droppable({drop:function(u,v){v.draggable.attr("style","position:relative;")}})}else{Phoenix.Core.debug("autocompleter: Wanted to make sortable but jQuery UI required libraries are not present.")}this.checkRequiredAttribute();f(window).on("scroll",function(u){t.checkScroll(u)});i.data("autocompleter",true);i.data("autocompleterObject",this);var m=this.dom.$parent.attr("data-seed-value");if(m){var l=m.split(":");var r={guid:l[0],name:l[1]};this.addResultPodFromTemplate(r)}return this.dom.$results};var d=b.prototype;d.position=function(){if(!this.options.stopPositioning){var j=this.dom.$elem.offset();var k=j.top+this.dom.$elem.outerHeight();var i={top:k,left:j.left};this.dom.$results.css(i)}};d.checkScroll=function(i){if(this.resultsShowing){this.position()}};d.cacheRead=function(i){var n,k,j,l,m;if(this.options.useCache){i=String(i);n=i.length;if(this.options.matchSubset){k=1}else{k=n}while(k<=n){if(this.options.matchInside){l=n-k}else{l=0}m=0;while(m<=l){j=i.substr(0,k);if(this.cacheData_[j]!==undefined){return this.cacheData_[j]}m++}k++}}return false};d.cacheWrite=function(i,j){if(this.options.useCache){if(this.cacheLength_>=this.options.maxCacheLength){this.cacheFlush()}i=String(i);if(this.cacheData_[i]!==undefined){this.cacheLength_++}this.cacheData_[i]=j;return this.cacheData_[i]}return false};d.cacheFlush=function(){this.cacheData_={};this.cacheLength_=0};d.callHook=function(k,j){var i=this.options[k];if(i&&f.isFunction(i)){return i(j,this)}return false};d.activate=f.debounce(400,function(){var i=this;this.maxOffset_=0;i.activateNow()});d.activateNow=function(k){var i=null;if(this.options.onActivate){i=this.options.onActivate.call(this)}if(this.bodyClickEvent===null){this.bodyClickEvent=this.onClickHandler;this.dom.$body.on("click.autocomplete",this.bodyClickEvent)}this.checkSearchIndex();this.checkSearchField();this.abandonAJAX();var j=this.dom.$elem.val();if(i){j=i}if(j){if(k||(j!==this.lastProcessedValue_&&j!==this.lastSelectedValue_)){if(this.options.showNotificationBar){this.showNotificationBar(j)}this.fetchData(j)}else{if(j===this.lastProcessedValue_){this.displayResults()}}}else{this.deactivate(false)}};d.abandonAJAX=function(){if(this.curJQXHR_&&this.curJQXHR_.readyState!=4){this.curJQXHR_.abort();this.dom.$results.find(".loading").remove()}};d.fetchData=function(k){var j=this,i=function(m,l){j.showResults(j.filterResults(m,l),l)};this.lastProcessedValue_=k;if(k.length<this.options.minChars){return false}else{if(this.options.data){i(this.options.data,k)}else{this.fetchRemoteData(k,function(l){if(f.isFunction(j.options.onRequestComplete)){j.options.onRequestComplete(l,k)}i(l,k)})}}};d.fetchRemoteData=function(j,n){var m=this.cacheRead(j);var i=this;var o=this.dom.$results;var l;var k=this.dom.$resultList;this.curJQXHR_=null;if(m){n(m)}else{l=function(q){var p=false;o.find(".loading").remove();if(q!==false){p=i.parseRemoteData(q);i.cacheWrite(j,p);n(p)}};k.find("li:not(.notificationBar)").remove();o.find(".loading").remove();o.find("#resultsWrap").append(f('<li class="loading"/>'));this.curJQXHR_=f.ajax({url:this.makeUrl(j),success:l,error:function(p,r,q){if(q==="abort"||this.readyState===0){return}if(f.isFunction(i.options.onError)){i.options.onError(p,r,q)}else{l(false)}},dataType:"json"})}};d.setExtraParam=function(j,k){var i=f.trim(String(j));if(i){if(!this.extraParams_){this.extraParams_={}}if(this.extraParams_[i]!==k){this.extraParams_[i]=k;this.cacheFlush()}}};d.checkSearchIndex=function(){var n=this.options.searchIndex;var o=[];var k=0;var j=this;var m=1;if(this.extraParams_.page!==undefined){m=parseInt(this.extraParams_.page,10);if(isNaN(m)){this.pageNumber_=m=1;this.paginationOffset_=0}}var l=this.dom.$elem.val();if(l!==this.lastProcessedValue_&&l!==this.lastSelectedValue_){this.pageNumber_=m=1;this.paginationOffset_=0}this.extraParams_=f.extend({},this.options.extraParams);if(n){if(f.type(n)!=="array"){n=n.split(",")}f.each(n,function(i,p){j.setExtraParam("indices["+k+"]",p);k++});j.setExtraParam("page",m)}};d.checkSearchField=function(){var l=this.options.searchField;var m=[];var k=0;var j=this;if(l){if(f.type(l)!=="array"){l=l.split(",")}f.each(l,function(i,n){j.setExtraParam("fields["+k+"]",n);k++})}};d.makeUrl=function(l,i){var j=this.options.url,k=f.extend({},this.extraParams_);if(typeof i!=="undefined"){j=i}if(this.options.queryParamName===false){j+=encodeURIComponent(l)}else{k[this.options.queryParamName]=l}return c(j,k)};d.parseRemoteData=function(j){var i,k=j;i=typeof(j);switch(i){case"object":k=j;break;case"string":k=f.parseJSON(j);break;default:throw new Error("Unexpected remote data type: "+i)}return k};d.filterResult=function(l,k){if(!l.name){return false}if(this.options.filterResults){var i=this.matchStringConverter(k);var m=this.matchStringConverter(l.name);if(!this.options.matchCase){i=i.toLowerCase();m=m.toLowerCase()}var j=m.indexOf(i);if(this.options.matchInside){return j>-1}else{return j===0}}return true};d.filterResults=function(l,j){var k=[];var i=this;var m;if(l.results){f.each(l.results,function(n,o){m=e(o);if(i.filterResult(m,j)){k.push(m)}if(i.options.sortResults){k=i.sortResults(k,j)}});this.calculateMaxOffset(l)}return k};d.calculateMaxOffset=function(j){var i=this.options.maxItemsToShow;this.maxOffset_=Math.floor(j.count/i)*i;if(j.count%i===0){this.maxOffset_-=i}};d.sortResults=function(l,k){var j=this;var i=this.options.sortFunction;if(!f.isFunction(i)){i=function(n,m){return h(n,m,j.options.matchCase)}}l.sort(function(n,m){return i(n,m,k,j.options)});return l};d.matchStringConverter=function(l,j,i){var k=this.options.matchStringConverter;if(f.isFunction(k)){l=k(l,j,i)}return l};d.enableFinishOnBlur=function(){this.finishOnBlur_=true};d.disableFinishOnBlur=function(){this.finishOnBlur_=false};d.showNotificationBar=function(i){i=i||this.getValue();if(i.length>=this.options.minChars){this.dom.$notificationTerm.text(i);if(this.options.notificationText){this.dom.$notificationText.text(this.options.notificationText)}else{this.dom.$notificationText.text("Search for")}this.position();this.displayResults();this.focusItem(this.dom.$first)}};d.createItemFromResult=function(j){var i=this,k=f("<li/>").append(f(this.showResult(j)));if(!this.options.autoRedirect){k.click(function(){if(k.find(".noResults").length>0){return}i.selectItem(k)})}k.data(j||{}).mousedown(i.disableFinishOnBlur).mouseup(i.enableFinishOnBlur);return k};d.showResult=function(n){var i,m="",o="",j="resultWrap",k,l;if(f.isFunction(this.options.showResult)){return this.options.showResult(n)}else{if(!n&&this.options.showEmptyText){return'<div class="noResults">'+this.options.emptyText+"</div>"}else{i=n.image||this.options.placeholderGraphic;if(!!n.label){m="<span>"+n.label+"</span>"}else{if(!!n.type){m="<span>"+n.type+"<span>"}}if(this.options.textOnly){j+=" resultTextOnly"}else{o='<img src="'+i+'">'}l=n.name;if(this.dom.$elem.data("display-field")&&n[this.dom.$elem.data("display-field")]){l=n[this.dom.$elem.data("display-field")];n.name=l}if(this.options.autoRedirect){k='<a href="'+n.url+'" class="'+j+'">'+o+"<h5>"+l+"</h5>"+m+"</a>"}else{k='<div class="'+j+'">'+o+"<h5>"+l+"</h5>"+m+"</div>"}return k}}};d.getItems=function(){return this.dom.$resultList.find(">li")};d.showResults=function(o){if(!o){o=[]}var k=o.length,s=this,m=f("<ul/>"),n,q,p,r,j=this.dom.$results,l=this.dom.$resultList;if(k>0){if(this.pageNumber_>1){m.append(this.addPagination("prev"))}for(n=0;n<k;n++){q=o[n];p=this.createItemFromResult(q);m.append(p);if(!this.dom.$first){this.dom.$first=p}if(n===k-1){p.addClass(this.options.lastItemClass)}}if(this.paginationOffset_<this.maxOffset_){m.append(this.addPagination("next"))}}else{m.append(this.createItemFromResult(q))}l.find("li:not(.notificationBar)").remove();l.append(m.find("li"));if(this.options.afterShowResults){this.options.afterShowResults(o,l,this)}this.displayResults();this.position();if(this.options.autoWidth){r=this.dom.$elem.outerWidth()-j.outerWidth()+j.width();j.css(this.options.autoWidth,r)}this.getItems().hover(function(){s.focusItem(this)},function(){});if(this.options.selectFirst||(this.options.selectOnly&&k===1)){this.focusItem(this.dom.$first)}this.active_=true};d.addPagination=function(j){var i=(j==="next")?f('<li class="next">See more results</li>').data("paginate",j):f('<li class="prev">See previous results</li>').data("paginate",j);if(!i.data("clickEventAdded")){this.addPaginationEvent(i,j)}return i};d.paginate=function(k){var j=this.dom.$results.find("li.loading").length>0;if(j){this.resultsPaginating_=true;return}if(this.pageNumber_<=1&&k==="prev"){this.resultsPaginating_=false;return}else{if(this.paginationOffset_>=this.maxOffset_&&k=="next"){this.resultsPaginating_=false;return}}var i=Number(this.options.maxItemsToShow);if(k==="next"){this.paginationOffset_+=i;this.pageNumber_++}else{if(k==="prev"){this.paginationOffset_-=i;this.pageNumber_--}}this.resultsPaginating_=true;this.setExtraParam("page",this.pageNumber_);this.activateNow(true)};d.addPaginationEvent=function(j,k){var i=this;j.click(function(){i.paginate(k)}).data("clickEventAdded",true)};d.focusNext=function(){this.focusMove(+1)};d.focusPrev=function(){this.focusMove(-1)};d.focusMove=function(k){var l=this.getItems(),j;k=g(k,0);if(k){for(j=0;j<l.length;j++){if(f(l[j]).hasClass(this.selectClass_)){this.focusItem(j+k);return}}}this.focusItem(0)};d.focusItem=function(j){var i,k=this.getItems();if(k.length){k.removeClass(this.selectClass_);if(typeof j==="number"){if(j<0){j=0;this.paginate("prev")}else{if(j>=k.length){j=k.length-1;this.paginate("next")}}i=f(k[j])}else{i=f(j)}if(i){i.addClass(this.selectClass_)}}};d.selectCurrent=function(){var i=f("li."+this.selectClass_,this.dom.$results);if(i&&i.length===1){if(this.dom.$notificationBar instanceof jQuery&&i.get(0)===this.dom.$notificationBar.get(0)){if(this.options.notificationBarSearch){var k=this.dom.$elem.val();var j=this.makeUrl(k,this.options.notificationSearchUrl);window.location=j}else{if(this.options.onNotificationBarClick){this.options.onNotificationBarClick(event,this)}}}else{this.selectItem(i)}}else{this.deactivate(false)}};d.selectItem=function(l){if(this.options.onItemSelect){var j=this.callHook("onItemSelect",l.data());if(!j){this.dom.$elem.focus();this.deactivate(true);this.hideResults();return}}var i=this.getValue(),k=l.data("paginate");this.lastProcessedValue_=i;this.lastSelectedValue_=i;if(k){this.paginate(k)}else{if(this.options.autoRedirect){if(l.get(0)===f(this.dom.$first).get(0)){this.dom.$elem.closest("form").submit()}else{window.location.href=l.data("url")}}else{if(this.options.podLimit===null||this.podCount_<this.options.podLimit){this.addResultPodFromTemplate(l.data())}else{Phoenix.Ui.showErrorMessage("You've exceeded the limit.");this.setValue("")}}}this.deactivate(true);this.hideResults()};d.addResultPodFromTemplate=function(j){var k=this.buildResultPod(j),i=this.dom.$elem;k.insertBefore(i);this.podCount_++;this.checkRequiredAttribute();this.setValue("");i.focus();if(this.options.podLimit!==null&&this.podCount_===this.options.podLimit){i.addClass("hide")}return k};d.buildResultPod=function(n){if(f.isFunction(this.options.resultPodTemplate)){return this.options.resultPodTemplate.call(this,n)}else{var m=this.dom.$parent.find('input[type="hidden"]').length;var l,k=this.options.podInputName+(this.options.podInputNoIndex||/\[\]$/.test(this.options.podInputName)?"":"["+m+"]"),j=this;if(typeof(n.guid)!="undefined"){l=n.guid}else{l=n.contentTypeId+"-"+n.id}if(k){var o=f('<span class="'+j.options.podClass+'"><span>'+(n.name||n.title)+'</span><i class="icon icon-remove-sign"></i><input type="hidden" name="'+k+'" value="'+l+'"></span>');if(this.options.sortable&&this.canDoSortable_){o.draggable(this.draggableOptions_);o.droppable(this.droppableOptions_)}return o}else{throw new Error("Missing required option: podInputName.")}}};d.hideResults=function(){this.dom.$results.hide();this.resultsShowing=false;if(this.options.onHideResults){this.options.onHideResults(this.dom.$results)}};d.displayResults=function(){this.dom.$results.show();this.dom.$results.addClass("visible");this.resultsShowing=true;if(this.options.onDisplayResults){this.options.onDisplayResults(this.dom.$results)}};d.deactivate=function(i){if(this.bodyClickEvent!==null){this.dom.$body.off("click.autocomplete",this.bodyClickEvent);this.bodyClickEvent=null}if(this.resultsPaginating_){return}if(i){if(this.lastProcessedValue_!==this.lastSelectedValue_){if(this.options.mustMatch){this.setValue("")}this.callHook("onNoMatch")}if(this.active_){this.callHook("onFinish")}this.lastKeyPressed_=null;this.lastProcessedValue_=null;this.lastSelectedValue_=null;this.active_=false;this.pageNumber_=1;this.paginationOffset_=0}this.hideResults()};d.getCaret=function(){var m=this.dom.$elem,j,l,n;if(f.browser.msie){var i=document.selection;if(m[0].tagName.toLowerCase()!=="textarea"){var o=m.val();j=i.createRange().duplicate();j.moveEnd("character",o.length);l=(j.text===""?o.length:o.lastIndexOf(j.text));j=i.createRange().duplicate();j.moveStart("character",-o.length);n=j.text.length}else{j=i.createRange();var k=j.duplicate();k.moveToElementText(m[0]);k.setEndPoint("EndToEnd",j);l=k.text.length-j.text.length;n=l+j.text.length}}else{l=m[0].selectionStart;n=m[0].selectionEnd}return{start:l,end:n}};d.setValue=function(k){if(this.options.useDelimiter){var m=this.dom.$elem.val();var l=this.getDelimiterOffsets();var j=m.substring(0,l.start);var i=m.substring(l.end);k=j+k+i}this.dom.$elem.val(k)};d.getValue=function(){var j=this.dom.$elem.val();if(this.options.useDelimiter){var i=this.getDelimiterOffsets();return j.substring(i.start,i.end).trim()}else{return j}};d.getDelimiterOffsets=function(){var l=this.dom.$elem.val(),m,i;if(this.options.useDelimiter){var j=l.substring(0,this.getCaret().start);m=j.lastIndexOf(this.options.delimiterChar)+1;var k=l.substring(this.getCaret().start);i=k.indexOf(this.options.delimiterChar);if(i===-1){i=l.length}i+=this.getCaret().start}else{m=0;i=l.length}return{start:m,end:i}};d.getValueForReal=function(){var i=this.dom.$parent.find('input[type="hidden"]');if(!i.length){return(null)}else{if(i.length==1){return(f(i[0]).val())}else{var j=[];i.each(function(k){j.push(f(k).val())});return(j)}}};d.setValueForReal=function(k,j){if(typeof(j)=="undefined"){j=false}if(!f.isArray(k)){k=[k]}if(!j){this.dom.$elem.empty()}var i=this;f.each(k,function(l){i.addResultPodFromTemplate(l)})}})(jQuery);
$(document).ready(function(){var a=function(){$(".js-autocompleter-checkbox-span").each(function(){var c=$(this);if(c.data("initialized")){return}var b=c.parent().find(".js-autocompleter-checkbox").find("input").first();c.on("click",function(d){if(b.attr("checked")==="checked"){b.removeAttr("checked");c.text("Click to match all above")}else{b.attr("checked","checked");c.text("Click to match individually above")}d.preventDefault()});c.data("initialized",true)})};a();$(document).ajaxStop(function(){a()})});
Phoenix.SiteSearch=null;$(function(){Phoenix.SiteSearch=(function(){var l=$("#siteSearch");var o=false;if(!l.length){return}var n=$("#search-toggle");n.find("a").first().click(function(p){p.preventDefault()});$(l).find("input").focusin(function(){$(l).addClass("is-focused");$("body").addClass("has-search-focused")});$(l).find("input").focusout(function(){$(l).removeClass("is-focused");$("body").removeClass("has-search-focused")});var b=l.find('input[type="checkbox"]'),d=l.find('.search-group-wiki input[type="checkbox"]'),k=l.find(".checkall"),c=l.find(".uncheck"),j=l.find(".wikionly"),m=[],a=function(){m.length=0;b.filter(":checked").each(function(){m.push($(this).val())})};var h=l.find("#search-main");var f={};if(l.find('[name="from_cms"]').length!==0){f.cms=1}var g=function(){var p;if(h.val().length){p=$.Event("keydown");p.keyCode=27;h.trigger(p);p=$.Event("keydown");p.keyCode=13;h.trigger(p,true)}};k.click(function(p){p.preventDefault();b.prop("checked",true);a();g()});c.click(function(p){p.preventDefault();b.prop("checked",false);a();g()});j.click(function(p){p.preventDefault();b.prop("checked",false);d.prop("checked",true);a();g()});b.click(function(){var p=$(this).prop("checked");if(!o&&p){b.not(this).prop("checked",false)}o=true;a();g()});a();var e={};b.each(function(){var p=$(this).parent();var q=$.trim(p.text());e[q]=$(this).val()});var i=function(w){var t=w.split(" ");if(t.length<=0){return null}var p=[];var r=[];var s=0;for(s=0;s<t.length;s=s+1){var x=t[s];x=$.trim(x);if(x===""){continue}var v=x.charAt(x.length-1);if(v!==":"){break}x=x.slice(0,-1);x=$.trim(x);if(x===""){continue}if(x==="person"||x==="persons"){x="people"}var q=e[x]||e[x+"s"]||e[x.substr(0,x.length-1)];if(q){p.push(q);r.push(x)}else{break}}if(p.length<=0){return null}var u=t.slice(s).join(" ");return{newIndicies:p,searchText:u,terms:r}};return h.autocomplete({autoRedirect:true,searchIndex:m,selectFirst:true,showNotificationBar:true,notificationBarSearch:true,notificationSearchUrl:"/search/",extraParams:f,parentModal:l,autoWidth:null,enableForMedia:"(min-width: 321px)",onActivate:function(){var p=this.dom.$elem.val();var q=i(p);if(!q){this.options.notificationText=null;a();return}if(q.terms.length===1){this.options.notificationText="Searching "+q.terms[0]+" for"}else{this.options.notificationText=null}m.length=0;$.extend(m,q.newIndicies);return q.searchText},preventDefaultReturn:false,finishOnBlur:false,bodyOnClickFilter:l})})()});$(function(){var i="/bundles/phoenixsite/images/core/loose/no-image.jpg";var e=$("#default-content .search-filters");var j=false;var f,b,g;var a;var d=$("#default-content .primary-content .search-results");var c=false;var h=$();if(e.length===0){return}f=e.find(":checkbox");b=e.find(".search-group-toggle");g=e.find(".search-group-wiki :checkbox");g=e.find(".search-group-wiki :checkbox");a=function(m,k){var o={page:1,q:Phoenix.Request.get("q","string"),srp:true};var l=0;var n;if(c){return}if(k){o=$.extend({},o,k)}if(m){o.client=m}d.addClass("loading");f.each(function(){var p=$(this);if(p.prop("checked")===true){o["indices["+l+"]"]=p.val();l=l+1}p.prop("disabled",true)});n=d.children("li").clone(true);d.children("li").remove();AjaxApiRequest.makeGetApiRequest("/jsonsearch/",o,function(s){var p=$(s.pagination);var r=_.template($("#resultTemplate").html());$.each(s.results,function(t,u){if(!u.image_url){u.image_url=i}if(u.deck){u.deck=u.deck.replace(/(<([^>]+)>)/ig,"")}else{u.deck=""}d.append(r(u))});if($(p[0]).hasClass("paginate")){var q=d.siblings(".paginate");if(q.length===0){p.insertAfter(d)}else{q.replaceWith(p)}p.find("a").each(function(){var x=$(this);var v=parseInt($(this).text(),10);var t="/search/?q="+o.q+"&page=";var u=0;var w=x.parent();if(w.hasClass("results")){return}if(isNaN(v)){if(w.hasClass("next")){v=o.page+1}else{if(w.hasClass("prev")){v=o.page-1}else{v=1}}}t+=v;$.each(o,function(y,z){if(y.substr(0,8)==="indices["){t+="&"+encodeURIComponent("indices["+u+"]")+"="+encodeURIComponent(z);u=u+1}else{if(y=="sort"&&o[z]){t+="&"+encodeURIComponent(y)+"="+encodeURIComponent(z)+"&"+encodeURIComponent(z)+"="+encodeURIComponent(o[z])}}});x.attr("href",t)})}else{var q=d.siblings(".paginate");q.replaceWith("")}c=false;f.prop("disabled",false);d.removeClass("loading")},function(){c=false;f.prop("disabled",false);d.append(n);d.removeClass("loading");f.prop("checked",false);h.prop("checked",true);Phoenix.Ui.showErrorMessage("Error occurred while loading results, showing previous results")})};e.on("click",":checkbox",function(){var k=$(this).prop("checked");h=f.filter(":checked").not(this);if(!j&&k){f.not(this).prop("checked",false)}jQuery.param.querystring(window.location.href,"q="+Phoenix.Request.get("q","string")+"&page=1");j=true;a("search")});b.on("click",".checkall",function(k){f.prop("checked",true);a("search");k.preventDefault();return false});b.on("click",".uncheck",function(k){f.prop("checked",false);a("search");k.preventDefault();return false});b.on("click",".wikionly",function(k){f.prop("checked",false);g.prop("checked",true);a("search");k.preventDefault();return false});$("select.ajax-js-filter").on("change",function(l){l.preventDefault();var k=$(this);var m={};if(k.val()&&k.val().length){m.sort=k.attr("data-filter-query");m[k.attr("data-filter-query")]=k.val()}a("search",m);return false})});
(function(b,d){var c=function(i,j){var g=d(i.target),h=i.data.callback,f;g.data("invalid",null);g.trigger("preSend");f=g.data("invalid");if(f){i.preventDefault();i.stopPropagation()}else{if(h!==undefined){h.call(this,i,j)}}};var a="data-ajaxForm";d.ajaxFormOn=function(f,e){d(document).on("submit",f,{callback:e},c)};d.fn.ajaxForm=function(e){return this.each(function(){var f=d(this);f.attr("data-ajaxForm","true").on("submit",{element:this,callback:e},function(g,h){c.call(this,g,h)})})};d.fn.isAjaxForm=function(){return(d(this).attr(a)==="true")}})(this,jQuery);
var FuzzyDate=function(){return this};FuzzyDate.prototype.selectors=[".fuzzy-datetime",".wiki-datetime"];FuzzyDate.prototype.initAll=function(){$(this.selectors.join(",")).each(function(){var b=$(this);var c=b.find('input[type="hidden"]');var a;if(c.length){a=parseInt(c.val(),10);if(isNaN(a)){a=0}}b.wikiDatePicker(a)});return this};Phoenix.jQuery.getDocument().ready(function(){var a=(new FuzzyDate()).initAll();$(this).ajaxComplete(a.initAll.bind(a))});(function(a){a.fn.wikiDatePicker=function(b){return this.each(function(){var i=a(this);if(i.data("fuzzy-date")){return}var n=i.find("input.datepicker-input");var r=i.find("select");var q=i.find('input[type="hidden"]');var o=i.find("a.swap");var s=i;var d=n.length!==0;var g=r.length===3;var m=q.length>=1;var f=o.length===1&&o.children("span").length===2;var z;var x;var w;var e=0;var v=1;var l=2;var p=3;var y=b===undefined?e:b;if(!y){y=e}var k=function(B){if(B===undefined){B=new Date(n.val())}var D=B.getMonth()+1;var A=Math.round(((D-1)/3)+1);var C=B.getFullYear();if(y===e||y===v){z.find("option").prop("selected",false);z.find('option[value="'+D+'"]').prop("selected",true)}if(y===l){w.find("option").prop("selected",false);w.find('option[value="'+A+'"]').prop("selected",true)}x.find("option").prop("selected",false);x.find('option[value="'+C+'"]').prop("selected",true)};var u=function(){var B=parseInt(q.val(),10);var A=[];if(B===e&&(!n.data().datepicker.date||!n.val())){r.each(function(){var C=a(this);C.find("option").prop("selected",false);C.find("option:first").prop("selected",true)})}else{r.each(function(){var C=parseInt(a(this).val(),10);if(C){A.push(C)}});if(!A.length){n.val("").prop("value","").attr("value","")}}};var t=function(){var B=!!parseInt(z.val(),10);var C=!!parseInt(w.val(),10);var A=!!parseInt(x.val(),10);if(!B&&!C&&A){y=p;q.val(p)}};var c=function(A){return function(){var C=parseInt(a(this).val(),10);var B=n.data().datepicker.date;var D="set"+A;if(!C){u();t();return}if(D!=="setFullYear"){C-=1}if(D==="setFullYear"){t()}if(D==="setMonth"){y=v;q.val(y);j()}B[D](C);B.setDate(1);n.datepicker("setValue",B);u()}};var j=function(){w.find("option").prop("selected",false);w.find("option:first").prop("selected",true)};var h=function(){z.find("option").prop("selected",false);z.find("option:first").prop("selected",true);var A=n.data().datepicker.date;A.setDate(1);n.datepicker("setValue",A)};if(isNaN(b)||b>p){y=e;q.val(e)}if(!(d&&g&&m&&f)){return}if(typeof n.data().datepicker==="undefined"){n.datepicker()}r.each(function(){var A=this.getAttribute("name");var B=a(this);if(/\]\[month\]$/.test(A)){z=B;B.on("change",c("Month"))}else{if(/\]\[year\]$/.test(A)){x=B;B.on("change",c("FullYear"))}}});r.filter(function(){var A=/\]\[quarter\]$/.test(this.getAttribute("name"));if(A){w=a(this)}return A}).on("change",function(){var B=parseInt(a(this).val(),10);var A=n.data().datepicker.date;var C={1:1,2:4,3:7,4:10};if(!B){t();u();return}A.setDate(1);A.setMonth(C[B]-1);n.datepicker("setValue",A);h();u();y=l;q.val(y)});if(n.val()){k()}n.on("changeDate",function(A){k(A.date)});i.on("click","a.swap",function(D){var C=a(this);var A=parseInt(q.val(),10);var B;if(isNaN(A)){A=e}if(A===e){B=v}else{B=e}q.val(B);C.children("span").toggleClass("hide");s.find("div").filter(function(){var F=a(this);var E=!!String(F.attr("id")).match(/_release_date$/);return F.hasClass("release-date-picker")||E}).toggleAttr("data-hide");if(!n.data().datepicker.date||!n.val()){r.each(function(){var E=a(this);E.find("option").prop("selected",false);E.find("option:first").prop("selected",true)})}if(B!==e&&parseInt(w.val(),10)){y=l;h();q.val(l)}if(B!==e&&!parseInt(w.val(),10)&&!parseInt(z.val(),10)){y=p;h();j();q.val(p)}D.preventDefault();return false});y=parseInt(y,10);if(y!==e&&!!z.parent().attr("data-hide")){o.trigger("click")}if(y===l){h();q.val(l)}if(y===v){j();q.val(v)}if(y===p){h();j();q.val(p)}i.find(".datetime-now-button").remove();i.data("fuzzy-date",true)})}}(window.jQuery));
var scrollToHeader=function(a){var b=a.offset().top;$("html, body").animate({scrollTop:b-100},1000)};$(document).ready(function(){var c=$(".js-toc-generate");if(c.length===0){var b=$(document).find(".js-toc-container");b.parent().find(".toc").remove();b.remove();return}var d={"&":"&amp;","<":"&lt;",">":"&gt;"};function a(f){return d[f]||f}function e(f){return f.replace(/[&<>]/g,a)}c.each(function(m){var q=$(this);var k=m;var j=q.find(".js-toc-container");var p=q.find(".js-toc-content");if(p.length===0){j.parent().find(".toc").remove();j.remove();return}var f=p.find("h2, h3, h4");var r=$('<ul class="sub-nav-toc"></ul>');var l=[];var n=r;var h=false;var i=false;f.each(function(v){var s=$(this);var u=$('<a href="#toc-'+k+"-"+v+'">'+e(s.text())+"</a>");var x=$("<li></li>");var w=null;var t=null;u.appendTo(x);u.click(function(y){y.preventDefault();scrollToHeader(s);location.hash="toc-"+k+"-"+v});s.attr("name","toc-"+k+"-"+v);if(s.is("h2")){if(h){w=l.pop();t=w.find("li:last");if(t.length>0){n.appendTo(t)}else{n.appendTo(w)}n=w;h=false}if(i){w=l.pop();t=w.find("li:last");if(t.length>0){n.appendTo(t)}else{n.appendTo(w)}n=w;i=false}}else{if(s.is("h3")){if(h){w=l.pop();t=w.find("li:last");if(t.length>0){n.appendTo(t)}else{n.appendTo(w)}n=w;h=false}if(!i){l.push(n);n=$("<ul></ul>");i=true}}else{if(s.is("h4")){if(!h){l.push(n);n=$("<ul></ul>");h=true}}}}x.appendTo(n)});var g=null;while((g=l.pop())!==undefined){if(h){var o=g.find("li:last");if(o.length>0){n.appendTo(o)}else{n.appendTo(g)}h=false}else{if(i){var o=g.find("li:last");if(o.length>0){n.appendTo(o)}else{n.appendTo(g)}i=false}else{n.appendTo(g);n=g}}}if(r.html()===""){j.parent().find(".toc").remove();j.remove()}if(r.is("ul")){r.children().appendTo(j)}else{r.appendTo(j)}})});$(document).ready(function(){$(".js-toc-static-links").click(function(b){b.preventDefault();var c=$(this).attr("href");c=c.slice(1);var a=$('[name="'+c+'"]');scrollToHeader(a);location.hash=c})});$(window).load(function(){var b=location.hash.slice(1);if(b.indexOf("toc-")>=0){var a=$("h2, h3, h4").filter("[name="+b+"]");scrollToHeader(a)}});
(function(c,g){var m=g(c.document);var l;var H;var h="Woops! Something happened and we are working on it!";var D="forum-add-ajax";var t="forum-edit-ajax";var k="."+D;var b="."+t;var s="textarea.js-editor-textarea";var w="messageElement";var F="messageBodyElement";var B="messageUserElement";var x="<div class='loading'></div>";var G=function(){return(g.fn.ajaxForm!==undefined)};var i=function(){return(g.fn.richTextEditor!==undefined)};var e=function(){if(l===undefined){l=g(".js-forum-comments, .js-forum-messages")}return l};var p=function(){if(H===undefined){H=g("#reply")}return H};var I=function(J){if(J===undefined){J=p()}return J.find(s)};var y=function(K){var J=K.data(w);if(J===undefined){J=K.parents(".js-message").first();K.data(w,J)}return J};var q=function(K){var J=K.data(F);if(J===undefined){J=y(K).find(".js-message-body").first();K.data(F,J)}return J};var a=function(L){var J=L.data(B);if(J===undefined){var K=y(L);J=null;if(K.length===0){J=y(L).find(".js-avatar-user").first()}else{J=y(L).find(".message-user").first()}L.data(B,J)}return J};var r=function(J){return J.hasClass(D)};var o=function(J){return J.hasClass(t)};var f=function(J){if(!G()){return}if(J===undefined){J=g([k,b].join(","))}g.ajaxFormOn([k,b].join(","),function(Q){Q.preventDefault();var M=g(Q.target),P=M.serializeArray(),O=g(x),L,K;var N=function(){Phoenix.Ui.showSuccessMessage("Saved.")};M.hide();O.insertAfter(M);if(r(M)){N=function(S){if(S.success===0){Phoenix.Ui.showErrorMessage(S.errMessage);O.remove();return}K=I(M);if(i()&&K.length>0){K.richTextEditor("remove")}M.remove();O.remove();var R=e();R.append(S.html);u();Phoenix.Ui.showSuccessMessage("Message added.")}}else{if(o(M)){N=function(R){L=q(M);K=I(M);if(i()&&K.length>0){K.richTextEditor("remove")}M.parents(".js-message").find(".js-forum-edit").removeClass("hide");M.remove();O.remove();L.html(R.html);Phoenix.Ui.showSuccessMessage("Message modified.")}}}g.ajax({type:"POST",url:M.attr("action"),data:P,success:N,error:function(){Phoenix.Ui.showErrorMessage(h);M.parents(".js-message").find(".js-forum-edit").removeClass("hide");O.remove();M.show()},complete:function(){g(document).trigger("image-viewer-rescrape")}})})};var v=function(){g(document).on("click",".js-forum-comments .js-forum-edit, .js-forum-messages .js-forum-edit",function(M){var L=g(M.target),K=L.attr("href");var N=g(this);if((L.is("a")===true)&&K!==""){M.preventDefault();var J=q(L);N.addClass("hide");g.ajax({url:L.attr("href"),success:function(O){var P;J.html(O.html);P=I(J);if(P.length===1){if(i()){P.richTextEditor()}}},error:function(){Phoenix.Ui.showErrorMessage(h)},complete:function(){g(document).trigger("image-viewer-rescrape")}})}})};var C=function(){var N=e();if(!N.hasClass("js-ajax-pagination")){return}if(!window.history.pushState){return}var L=location.href;var J=false;var K=false;g(document).on("click",'.paginate a[href*="page="]',function(Q){if(!J){window.history.replaceState({name:"ForumPaginate",url:L},"",L);J=true}Q.preventDefault();var P=g(this);var O=P.attr("href");M(O);window.history.pushState({name:"ForumPaginate",url:O},"",O);K=true});var M=function(O){var P=g(x);var R=g(".container").offset().top;var Q=g(window);P.height(N.height());N.hide();N.after(P);if(Q.scrollTop()>R){g("html, body").animate({scrollTop:R},300)}g.ajax({cache:false,url:O,success:function(T){var S=g(".paginate");if(!T.success){window.location=O;return}else{var U=Phoenix.getDocument();U.trigger("pre_page_event",["pageLoad"]);U.trigger("update_page_event",["pageLoad"]);U.trigger("on_page_event",["pageLoad"])}N.html(T.html.list);S.html(T.html.pagination);P.remove();N.show()},error:function(){P.remove();N.show();Phoenix.Ui.showErrorMessage(h)},complete:function(){g(document).trigger("image-viewer-rescrape")}})};g(window).on("popstate","",function(O){if(!K){return}var P=O.originalEvent.state;if(P&&P.name==="ForumPaginate"){M(P.url)}})};var z=function(){var J=g(".js-poll-form");J.ajaxForm(function(M){M.preventDefault();var K=g(M.target);var L=K.serializeArray();g.ajax({type:"POST",url:K.attr("action"),data:L,success:function(N){K.parents(".js-message-body").html(N.html)},error:function(){Phoenix.Ui.showErrorMessage(h)}})})};var u=function(){g(".js-forum-reply, .js-forum-quote").remove()};var n=function(){e().on("click",".js-forum-reply",function(M){var L=g(M.target),J=a(L),N=I(),K={};M.preventDefault();var O=N.parents(".editor").first().offset().top;g("html, body").animate({scrollTop:O-100},500);if(J.length===1){K.slug=J.data("user-slug");K.profile=J.data("user-profile")}if(i()===false){N.val("@"+K.slug+": "+N.val())}else{N.richTextEditor("reply",K)}})};var j=function(){e().on("click",".js-forum-quote",function(O){var N=g(O.target),L,K=a(N),P=I(),M={},J={};O.preventDefault();var Q=P.parents(".editor").first().offset().top;g("html, body").animate({scrollTop:Q-100},500);if(K.length===1){M.slug=K.data("user-slug");M.profile=K.data("user-profile")}L=q(N);J.user=M;J.html=L.html();P.richTextEditor("quote",J)})};var d=function(){g(document).on("click",'[data-embed-type="spoiler"] .header',function(){g(this).siblings(".content").toggleClass("hide")})};var E=function(){g(document).on("click",".js-best-answer",function(){var L=g(this);var K=false;g(".js-best-answer-header").remove();var J=L.parents(".js-message");if(J.hasClass("answer")){K=true}g(".js-message.answer").each(function(){var O=g(this);var M=O.find(".js-best-answer");var N=M.attr("data-toggle-value");M.attr("data-toggle-value"," "+M.text());M.text(N);O.removeClass("answer")});if(!K){J.addClass("answer")}})};var A=function(){g(document).on("click",".btn-toggle-visibility",function(L){var M=g(this);L.preventDefault();var K=M.attr("data-toggle-label");if(K){M.attr("data-toggle-label",M.text());M.text(K)}var J=M.attr("data-toggle-target");if(J){g(J).toggleClass("hide")}})};m.ready(function(){E();d();if(G()===false){return}C();v();f();z();A();n();if(i()===false){return}j()})})(this,this.jQuery);
(function(c,e){var g=e(c.document);var a="Woops! Something happened and we are working on it!";var f="<div class='loading'></div>";var d=e(f);var b=function(){g.on("click","#comments-block .feed-hdr a",function(k){k.preventDefault();var j=e(this).attr("href");var l=e(this).data("dir");e.cookie("comment-sort-dir",l,{path:"/",expires:30});i(j);s.pageName=h(s.pageName,j);void (s.t())});g.on("click","#comments-block #paginate-order-switch",function(k){k.preventDefault();var j=e("#comments-block .feed-hdr a:not(.on)").first().attr("href");var l=e("#comments-block .feed-hdr a:not(.on)").first().data("dir");e.cookie("comment-sort-dir",l,{path:"/",expires:30});i(j);s.pageName=h(s.pageName,j);void (s.t())});var i=function(j){var k=e("#comments-block");var m=k.offset().top;var l=e(window);d.height(k.height());k.hide();k.after(d);if(l.scrollTop()>m){e("html, body").animate({scrollTop:m},300)}e.ajax({url:j,success:function(n){if(n.success===0){Phoenix.Ui.showErrorMessage(n.errMessage);d.remove();k.show();return}d.remove();k.show();k.html(n.html)},error:function(){d.remove();k.show();Phoenix.Ui.showErrorMessage(a)},complete:function(){e(document).trigger("image-viewer-rescrape")}})};var h=function(j,l){var k=j.match(/:p([0-9]):/i)[1];var m=l.split("comment_page=")[1];if(!m){m=1}if(!k){return s.pageName}return j.split(":p"+k+":").join(":p"+(m)+":")}};g.ready(function(){b()})})(this,jQuery);
Phoenix._uploaderButtonAjaxBound=false;Phoenix._uploaderReadyBound=false;Phoenix._uploaderReadyNonAjaxTriggered=false;Phoenix.jQuery.getDocument().ready(function uploaderButton(g){var l=$(".image-widget-container");var f=$(document);var j,c,b,a;var e,d;var m=function(q,p){if(!b.hasClass("hide")&&b.children("img").length===0){b.addClass("hide")}var u=l.find("img");var r=u.length===0;var v=$();var t=function(){Phoenix.Ui.showErrorMessage("Unable to load image");a.parent().replaceWith(e)};var n=function(w){return function(){if(this.width<10||this.height<10){t()}if(typeof w==="function"){w()}}};if(r){a=$('<img class="clickable">');v=$('<a class="image-widget" href="#">').append(a)}else{a=$(u[0])}if(q.successful===undefined){return t()}var s=function(w,x){a.bind("error",t);a.bind("load",n(p));a[0].src=x.url;if(x.id){if(j.length===0||!j){j=l.parent().find(":input:hidden")}j.val(x.id)}else{t()}};$.each(q.successful,function(w,y){if(Phoenix.UploaderButton._successHandler){y.embargo=!!q["image-embargo"];var x=Phoenix.UploaderButton._successHandler(d,w,y);if(x===true){r=false}}else{s(w,y)}});if(r){l.find(".btn-primary").addClass("hide");v.appendTo(l)}else{b.removeClass("hide")}for(var o in Phoenix.UploaderButton._callbackFunctions){if(l.is(o)||l.find(o).length>0){Phoenix.UploaderButton._callbackFunctions[o].call(a)}}};var h=function(n){var o=n.errors;if(n.crossOriginError){Phoenix.Ui.showErrorMessage("An error occurred while loading the image. The image editor will be closed.");return m(n)}if(b.hasClass("hide")){b.removeClass("hide")}if(n.status===413){return Phoenix.Ui.showErrorMessage("Image is too large, please upload a smaller image.")}if(o!==undefined){if(o.url){return Phoenix.Ui.showErrorMessage(o.url)}if(o.file){return Phoenix.Ui.showErrorMessage(o.file)}}};var k=function(o){d=$(this);l=d.parent();j=l.find('[type="hidden"]');b=l.find(".image-widget, .btn-primary");e=b.parent().clone(true);var n=d.data("multiple");$.uploader({complete:m,error:h,type:"image",postURL:"/images/upload",urlPostURL:"/images/url-submit",headerText:"Where does your image live?",multiple:n,fileType:["image/jpeg","image/gif","image/png"],drop:true,dropText:"Or drag and drop your image to this window."});c.modal("show");o.preventDefault();return false};var i=function(n){n.each(function(){var o=$(this);if(o.data("uploader")){return}f.trigger("uploaderReady",[o])})};if(!Phoenix._uploaderButtonAjaxBound){f.ajaxComplete(function(){uploaderButton(true)});Phoenix._uploaderButtonAjaxBound=true}if(!Phoenix._uploaderReadyBound){f.on("uploaderReady",function(o,n){c=$("#js-uploader");if(n){l=n}if(l.data("uploader")){return}l.on("click.promoUploader",".btn,.clickable",k);l.data("uploader",true)});Phoenix._uploaderReadyBound=true}if(g===true){i(l)}else{if(!Phoenix._uploaderReadyNonAjaxTriggered){i(l);Phoenix._uploaderReadyNonAjaxTriggered=true}}});Phoenix.UploaderButton=function(){return this};Phoenix.UploaderButton._callbackFunctions={};Phoenix.UploaderButton._successHandler=null;Phoenix.UploaderButton.setCallbackFunction=function(b,a){Phoenix.UploaderButton._callbackFunctions[b]=a};Phoenix.UploaderButton.setSuccessHandler=function(a){Phoenix.UploaderButton._successHandler=a};
$(document).ready(function(){var a="_promos_seen";$("a[data-promo-id], .js-video-player[data-promo-id]").on("click",function(){var g=$.cookie(a);var c=new Date();var h=parseInt($(this).attr("data-promo-id"),10);var b=parseInt($(this).attr("data-top-slot-allowed"),10)===1;var e=[];var f=$("#promo-id-"+h).children("a").data();if(!h||(f&&f.cms===true)){return}if(parseInt($(this).parent().attr("data-pinned"),10)===1){return}c.setMonth(c.getMonth()+1);if(g&&g.charAt(0)==="["){g=$.parseJSON(g)}else{g=[]}for(var d=0;d<g.length;d=d+1){if(g[d]===h){continue}e.push(g[d])}e.push(h);$.cookie(a,JSON.stringify(e),{expires:c,path:"/"})})});
$(document).ready(function(){var a=$(".table-forums .is-topic-sticky").last();if(!a.hasClass("is-last-sticky")){a.addClass("is-last-sticky")}var c=function(){var e=$("#forums #default-content");var d=$.cookie("forumLayout");if(d=="container"){e.removeClass("container-fluid");e.addClass("container")}else{if(d=="container-fluid"){e.removeClass("container");e.addClass("container-fluid")}}};var b=function(d,e){if(d!==undefined){$.cookie(d,e,{expires:365,path:"/"})}};$(document).on("click",".js-forum-layout",function(f){var d=$(this).attr("data-type-layout");b("forumLayout",d);c()})});
"use strict";var PhoenixPopover=function(){var f={init:function(){$(".js-pop-over-toggle").each(function(l,o){var n=$(o);for(var k=n.parent();k[0].nodeName.toLowerCase()!="body";k=k.parent()){if(k.hasClass("js-pop-over-parent")){break}}var m=k.find(".js-pop-over-container");var j={element:m,width:m.width(),height:m.height(),clickOffsetX:parseInt(m.attr("data-click-open-offset-X")),clickOffsetY:parseInt(m.attr("data-click-open-offset-Y"))};n.data("popOverContainer",j);$("body").append(m.detach());m.css({position:"absolute"})}).click(function(j){if(h){g()}h=$(this).data("popOverContainer");if(h){j.stopPropagation();var i=0;if(j.clientX+h.width>$(document).width()){h.element.addClass("popover-position-left");i=j.clientX-h.width-h.clickOffsetX}else{h.element.addClass("popover-position-right");i=j.clientX+h.clickOffsetX}h.element.css({top:j.clientY+$(window).scrollTop()+h.clickOffsetY,left:i});h.element.show();$("body").bind("click",b);$(window).bind("resize",d)}})},eoo:null};var h=null;function b(i){if(!a(i,h.element)){g()}}function d(){g()}function g(){h.element.hide();h.element.removeClass("popover-position-left");h.element.removeClass("popover-position-right");h=null;$("body").unbind("click",b);$(window).unbind("resize",b)}function c(i){var j=i.offset();j.top-=$(window).scrollTop();j.left-=$(window).scrollLeft();return(j)}function e(i){var j=c(i);return({top:j.top,left:j.left,bottom:j.top+i.outerHeight(),right:j.left+i.outerWidth()})}function a(k,i){var j=e(i);return(k.clientY>=j.top&&k.clientY<=j.bottom&&k.clientX>=j.left&&k.clientX<=j.right)}return(f)}();$(document).ready(function(){$(".js-game-card-follow").each(function(d,h){var b=$(h);var j=b.find(".js-game-card-follow-controls");var f=b.find(".js-game-card-unfollow-controls");var g=j.find(".js-game-card-follow-select");var c=f.find(".js-game-card-follow-unfollow-link");g.change(function(){j.addClass("hidden");f.removeClass("hidden")});c.click(function(){j.removeClass("hidden");f.addClass("hidden");g.val("0")})});var a=false;$(".js-gamecard-stack-state").click(function(e){e.preventDefault();if(a){return false}var c=$(this).parents("li").first().hasClass("active");var d="";var f=false;if(!c){d=$(this).attr("data-add-href");$(this).parents("li").siblings().removeClass("active");$(this).parents("li").first().addClass("active");$(this).parents("li").siblings().find(".icon-check").addClass("icon-check-empty").removeClass("icon-check");$(this).find(".icon-check-empty").addClass("icon-check").removeClass("icon-check-empty")}else{d=$(this).attr("data-remove-href");$(this).parents("li").first().removeClass("active");$(this).find(".icon-check").addClass("icon-check-empty").removeClass("icon-check");f=true}a=true;$(this).parents("ul").first().addClass("disabled");var b=$(this);AjaxApiRequest.makeGetApiRequest(d,{},function(g){if(f){Phoenix.Ui.showSuccessMessage("Removed from stack.")}else{Phoenix.Ui.showSuccessMessage("Added to stack.")}a=false;b.parents("ul").first().removeClass("disabled")},function(){Phoenix.Ui.showErrorMessage("Error adding to stack.");a=false;b.parents("ul").first().removeClass("disabled")})});PhoenixPopover.init()});
var loadDataUserAgentPlatform=function(){var a=document.documentElement;a.setAttribute("data-useragent",navigator.userAgent);a.setAttribute("data-platform",navigator.platform)};loadDataUserAgentPlatform();$(document).ready(function(){var c=Phoenix.jQuery.getMessageBlock();if(c&&$.trim(c.html())!==""&&!c.hasClass("transitioning")){var d=$.trim(c.html());Phoenix.Ui.showMessageBar(d)}var b=$('meta[itemprop="deviceType"]').attr("content");if(b!=="phone"){$(".paginate a").tooltip();$(".tipsy").tooltip()}var a=function(){$(".search-autocomplete").each(function(){var f=$(this);var g=f.data("autocomplete-indexes");var h={};if(f.data("initialized")===true){return}if($(this).data("cms")){h.cms=1}if(g){f.autocomplete({autoRedirect:true,searchIndex:g,selectFirst:true,showNotificationBar:true,extraParams:h})}else{f.autocomplete({showNotificationBar:true,extraParams:h})}f.data("initialized",true)})};a();$(document).ajaxStop(a);$(document).on("newAutoCompleteAdded",a);var e=false;$(".js-prevent-mult-submit").on("submit",function(f){$(this).find("button[type=submit]").attr("disabled","disabled");if(e){f.preventDefault();f.stopPropagation()}else{e=true}return true})});
$(document).ready(function(){$(".js-load-forever").each(function(){var e=$(this);var g=e.attr("data-page-name")||"page";var i=e.attr("data-target");if(!i){i=".js-load-forever-container"}var h=$('<div class="loading"></div>');var a="Sorry that's all folks";var b=true;var f=1;var d=false;var c=typeof e.attr("data-no-scroll")!=="undefined";d=e.attr("data-max-page");if(!d){d=false}if(e.attr("data-end-of-line-text")){a=e.attr("data-end-of-line-text")}e.click(function(j){if(!b){return}if(d!==false&&f>=d){return}j.preventDefault();f=f+1;e.before(h);e.hide();$.get("?"+g+"="+f,function(l){var n="";if(l.river){n=$("<div>"+l.river+"</div>").find(i).html()}else{n=$(l).find(i).html()}if(n===""){var k=e.data("end-of-line");e.find("a").text(a);e.find("a").attr("href",k);e.find("a").attr("target","_blank");e.show();b=false;return}var m=$(n);$(i).append(m);if(!c){$("html, body").animate({scrollTop:m.first().offset().top})}if(d!==false&&f>=d){b=false;var k=e.data("end-of-line");e.find("a").text(a);e.find("a").attr("href",k);e.find("a").attr("target","_blank")}e.show()}).complete(function(){h.remove()})})})});
$(document).ready(function(){var e=$.cookie("skinSource"),f=$("#skin-switch a:first-child").attr("rel"),d=$.cookie("richTextEditorTheme"),b=$("#skin-switch a.skin-switch-btn"),c,a;if(e){$.cookie("skinSource",e,{expires:365,path:"/"});c=e.split("_");a=c[c.length-1];$(".switch__item").addClass("switch__item--"+a)}else{if(f){$.cookie("skinSource",f,{expires:365,path:"/"});c=f.split("_");a=c[c.length-1];$(".switch__item").addClass("switch__item--"+a)}}if(d){$.cookie("richTextEditorTheme",d,{expires:365,path:"/"})}b.click(function(){if($(this).parent().hasClass("switch__item--white")){$(this).parent().removeClass("switch__item--white");$(this).parent().addClass("switch__item--black")}else{if($(this).parent().hasClass("switch__item--black")){$(this).parent().removeClass("switch__item--black");$(this).parent().addClass("switch__item--white")}}});b.click(function(i){i.preventDefault();var h=$(this).attr("rel");$("link#skin-color").attr("href",$(this).attr("data-rel-url"));$.cookie("skinSource",h,{expires:365,path:"/"});var g=$(this).attr("data-richTextEditorTheme");$.cookie("richTextEditorTheme",g,{expires:365,path:"/"});$(document).trigger("updateRichTextEditorTheme",[$(this).attr("data-richTextEditorTheme-url")]);return false})});
(function(p){var n=$(document);var c=".js-video-player";var m=".js-vid-postplay";var C=".js-vid-postplay-countdown";var d=".js-vid-postplay-stop ";var l=".js-vid-postplay-next";var o="is-postplay-counting";var q="is-postplay-complete";var b="is-vid-postplay";var F="countdown-timeout-id";var y="postplay-started";var w="dest-url";var g="postplay-id";var z="enterViewport";var B=10;var s=0;var v={};var k;var u=function(I,O){var H=O.find(m),N=H.find(C),M=H.find(d),L=H.find(l),K=scrollMonitor.create(O),J={$player:O,$postPlay:H,$countdown:N,destUrl:H.data(w),watcher:K};J.enterViewportHandler=function(){D(J)};L.on("click",function(){i(J)});M.on("click",function(){A(J)});v[I]=J};var E=function(I){var H=I.data(g);if(!H){s++;H=s;I.data(g,H);u(H,I)}return v[H]};var x=function(I){var H=I.data(F);clearTimeout(H);H=null;I.data(F,H)};var h=function(I,K){var L=I.$countdown,J=K-1,H;x(L);L.text(K);if(0>K){i(I,true)}else{H=setTimeout(function(){h(I,J)},1000);L.data(F,H)}};var D=function(H){x(H.$countdown);G(H);H.$postPlay.removeClass(q).addClass(o);h(H,B)};var f=function(H){if(!H.deferred){H.deferred=true;H.watcher.on(z,H.enterViewportHandler)}};var G=function(H){if(H.deferred){H.deferred=false;H.watcher.off(z,H.enterViewportHandler)}};var r=function(H){x(H.$countdown);G(H);H.$postPlay.removeClass(o)};var i=function(H,I){r(H);H.$postPlay.addClass(q);if(I){window.location=H.destUrl}};var e=function(H){r(H);H.$player.removeClass(b)};var A=function(H){e(H);H.canceled=true};var t=function(I){var H;if(true===I.data(y)){return}k=H=E(I);I.data(y,true);if(H){H.canceled=false;if(H.watcher.isInViewport){D(H)}else{f(H)}}I.addClass(b)};var j=function(I){var H;if(!I.data(y)){return}H=E(I);I.data(y,false);if(H){e(H)}};var a=function(){n.on("contentProgress",c,function(H,I){if(I){if(10<(I.duration-I.currentTime)){j($(this))}else{t($(this))}}});n.on({rteBlur:function(){if(k&&!k.canceled){f(k)}},rteTyping:function(){if(k){r(k)}}},".js-editor-textarea")};n.on("ready",function(){var H=$(m);if(H&&0<H.length){a()}})})(this);
(function(ab){var ak={version:"v.2013.07.31",ageMessage:"Sorry you cannot access this content."};var V=".metisVideoPlayer";var p={};var am,A,Z,X;var L=function(){return ab.Phoenix||{}};var Y=function(){if(am===X){var aC=L();if(!!aC.jQuery&&!!aC.jQuery.getWindow){X=aC.jQuery.getWindow()}else{X=$(window)}}return X};var m=function(){if(am===A){var aC=L();if(!!aC.jQuery&&!!aC.jQuery.getDocument){A=aC.jQuery.getDocument()}else{A=$(document)}}return A};var G=function(){if(am===Z){Z=$("html, body")}return Z};var o=function(aC){if(!!aC){if(!!aC.preventDefault){aC.preventDefault()}}};var M=function(aF){var aD,aC=false;if(!!JSON&&!!JSON.stringify){try{aD=JSON.stringify(aF);aC=true}catch(aE){aC=false}}if(!aC){aD=false}return aD};var az=function(aD){var aC=L();if(!!aC.Ui&&!!aC.Ui.showSuccessMessage){aC.Ui.showSuccessMessage(aD)}};var x=function(aF,aH){if(!aF||!aH){return}var aD=0,aI=aH.width(),aG=aH.offset(),aC=aF.pageX-aG.left,aE;if(aC<aD){aC=aD}else{if(aC>aI){aC=aI}}aE=aC/aI;return aE};var aB=function(aD){var aC=(100*aD).toFixed(2),aE=aC.indexOf(".00");if(aE>0){aC=aC.substr(0,aE)}return aC+"%"};var an=60,ap=60,ag=3600,Q="0",aq=":";var j=function(aG){var aH,aF,aD,aC="",aE="",aI="";if(!aG){aG=0}if(aG<0||isNaN(aG)){aG=0}aH=Math.floor(aG%an);aF=Math.floor((aG/an)%ap);aD=Math.floor(aG/ag);if(aH<10){aC=Q}if(aF<10){aE=Q}aI=aE+aF.toString()+aq+aC+aH.toString();if(aG>=ag){aI=aD.toString()+aq+aI}return aI};var aA=false;var ac=false,H=[],au=function(){var aC=H.push;if(!!aC.apply){aC.apply(H,[arguments])}else{aC(Array.prototype.slice.call([arguments]))}};var ah=function(){var aD=ab.console||{},aC=H,aE;ac=true;if(!!aD.log){H={push:function(){var aJ=aD.log,aH="",aI="",aF=arguments[0],aG=aF[0];if("error"===aG||"warn"===aG||"info"===aG){aH=aG;if(!!aD[aH]){aJ=aD[aH]}else{aI=aH.toUpperCase()+": "}aF[0]=aI}aF[0]="[METIS] "+aF[0];if(!!aJ.apply){aJ.apply(aD,aF)}else{aJ(Array.prototype.slice.call(aF))}}};au("Enable metis logging");for(aE=0;aE<aC.length;aE++){H.push(aC[aE])}}};if(true===ac){ah()}var K="is-vid-disabled";var C,F=function(){if(undefined===C){var aD=navigator||{},aC=aD.userAgent||"";C=false;if((aC.indexOf("Safari")>=0)&&(aC.indexOf("Chrome")<0)){C=true}au("Browser is Safari? "+(C?"yes":"no"))}return C};var r,B="10",f="js-vid-flash",E=function(){if(undefined===r){if(!swfobject||!swfobject.hasFlashPlayerVersion||!swfobject.hasFlashPlayerVersion(B)){r=false}else{r=true}au("Browser supports flash? "+(r?"yes":"no"))}return r},w=function(aD){var aC;if(false===E()){aC=aD.find("."+f);aC.remove()}};var al,e=".js-vid-m3u8",z=function(){if(undefined===al){if((true===F())&&(true===ar())){al=true}else{al=false}au("Browser supports m3u8? "+(al?"yes":"no"))}return al},u=function(aC){var aD=aC.find(e);if(true===z()){ay(aD)}else{aD.remove()}};var W,h="js-vid-h264",aj="."+h,ar=function(){if(undefined===W){W=false;if(!!Modernizr){if(!!Modernizr.video&&Modernizr.video.h264){W=true}au("Browser supports H264? "+(W?"yes":"no"))}else{au("error","hasH264Support(): Modernizr not found")}}return W},ax=function(aD){var aC=aD.find(aj);if(false===ar()){aC.remove()}if(!aC||aC.length<1){W=false}};var D,aa=function(){if(undefined===D){if(navigator.appName.indexOf("Microsoft")!==-1){D=window}else{D=document}}return D};var av=function(aC){var aD=aC.data("video");if(!aD){return}au("getMetisVideoJSON() videoJSON:\n",$.extend({},aD));return aD};var I={name:"basePlayer",logPrefix:"",initialized:false,playerReady:false,contentLoading:false,load:function(){},init:function(){this.initialized=true},detach:function(){},play:function(){},pause:function(){},resume:function(){},stop:function(){},mute:function(){},unmute:function(){},setVolume:function(){},seekTo:function(){},seekToLive:function(){},getDuration:function(){},isInitialized:function(){return this.initialized},isReady:function(aC){return this.playerReady},setPlayerReady:function(aE){var aC=this,aD=aC.logPrefix;if(aC.playerReady!==aE){au(aD+"Set playerReady to ["+(aE?"TRUE":"FALSE")+"]");aC.playerReady=aE}if(aE){l.onPlayerReady()}},isContentLoading:function(){return this.contentLoading},setContentLoading:function(aE){var aC=this,aD=aC.logPrefix;if(aC.contentLoading!==aE){au(aD+"set contentLoading to ["+(aE?"TRUE":"FALSE")+"]");aC.contentLoading=aE;l.contentLoading(aE)}if(!aE){l.onPlayerReady()}}};var c=function(aC){return $.extend({},I,aC)};var at=(function(){var aP="flash";var aG="[FLASH] ";var aO="gamesVideoSwf_";var aH="__gamesVideoPlayer";var aF="object";var aJ;var aI=function(){return aJ};var aL=function(aQ){aJ=aQ};var aE={flashPlayerStarted:function(){au(aG+" flashPlayerStarted()");aN(true)},adError:function(aQ){au("error",aG+"AD ERROR: "+aQ)},adInfo:function(aQ){au("info",aG+"AD : "+aQ)},adProgress:function(){var aQ=aD(aC.playerApiId);au(aG+"AD PROGRESS MINDER =====>");l.videoProgress({currentTime:Math.floor(aQ.getCurrentTime_js()),duration:Math.floor(aQ.getDuration_js())});aC.setContentLoading(false)},contentProgress:function(){var aQ=aD(aC.playerApiId),aR={currentTime:Math.floor(aQ.getCurrentTime_js()),duration:Math.floor(aQ.getDuration_js()),bytesLoaded:aQ.bytesLoaded_js(),bytesTotal:aQ.bytesTotal_js()};aC.setContentLoading(false);l.videoProgress(aR)},loadMinder:function(){},onAdStart_flash:function(){au(aG+"onAdStart_flash()");l.adStart()},onAdEnd_flash:function(){au(aG+"onAdEnd_flash()");l.adEnd()},onCBSIPlayerReady:function(){au(aG+"onCBSIPlayerReady()")},onContentEnd_flash:function(){au(aG+"onContentEnd_flash()");l.contentEnd(aP)},onContentStart_flash:function(){au(aG+"onContentStart_flash() ===== ");l.contentStart()},onPlaylistEnd:function(){au(aG+"onPlaylistEnd() =====>");l.playlistEnd(aP)},onPlaylistStart:function(){au(aG+"onPlaylistStart() =====>")},userPause:function(){au(aG+"userPause() =====>");l.toggleUiPlayPause()},videoHasEnded:function(){au(aG+"VIDEO END =====>")}};var aM=function(aT){var aR=aT.playerId,aS,aQ=aT.videoJSON;var aU={uvpUri:aQ.uvp,uvpThird:aQ.uvpThird,imaUri:aQ.ima3,uvpcUri:aQ.uvpc};aS={id:aO+aR,swf:aQ.swfLocation,width:"100%",height:"100%",allowFullScreen:true,allowScriptAccess:"always",flashvars:{id:aQ.id,title:aQ.title,duration:aQ.lengthSeconds,mapp:aQ.mapp,autoPlay:"true",config:M(aU),guid:aQ.guid}};return aS};var aK=function(aR){au(aG+"BEG initFlashUvpObject() =====>");var aS,aQ;if(!!aR){aC.setContentLoading(true);aS=l.getVideoContainer(aP);aQ=aS.find(aF);if(aQ.length<=0){au(aG+"initFlashUvpObject(): Build new flash object tag");aS.flash(aM(aR));aQ=aS.find(aF);if(aQ.length<=0){aQ=undefined;au("error",aG+"initFlashUvpObject(): unable to create video embed")}}}else{au("error",aG+"initFlashUvpObject(): undefined video")}au(aG+"END initFlashUvpObject() =====>");aL(aQ);return aQ};var aD=function(aQ){var aS,aR=aa();aS=aR[aQ];return aS};var aN=(function(){var aQ=1000;var aR=null;return function(aV){var aT=true,aS=aD(aC.playerApiId);if(null!==aR){au(aG+"isApiAlive() > clear timeout id: ",aR);clearTimeout(aR);aR=null}try{au(aG+"isApiAlive()? YES");aT=aS.isAPIAlive_js();if(false===aC.playerReady){au(aG+"isApiAlive > setPlayerReady(true)");aC.setPlayerReady(true)}}catch(aU){au("error",aG+aU.message);aT=false;if(true===aC.playerReady){au(aG+"isApiAlive > setPlayerReady(false)");aC.setPlayerReady(false)}}if(false===aT&&true===aV){au(aG+"isApiAlive()? NO -- check again in "+aQ+"ms");aR=setTimeout(function(){aN(true)},aQ);au(aG+"isApiAlive() > timeout id: ",aR)}return aT}})();var aC=c({name:"flashPlayer",logPrefix:aG,playerApi:null,playerApiId:null,load:function(){if(!ab[aH]){ab[aH]=aE}},init:function(){var aQ=this,aT=l.getVideoUi(),aR=aI(),aS;if(aQ.isInitialized()){return}au(aG+"Init Player API");if(!!aT){if(!aR){aR=aK(aT)}if(undefined!==aR){aQ.initialized=true;aS=aR.attr("id");if(aS!==aQ.playerApiId){aQ.playerApiId=aS;aQ.playerApi=aD(aS)}}}else{au(aG+"Player API init failed :: no video")}},loadVideo:function(){var aS=this,aV=l.getVideoUi(),aT=aV.states,aR,aW,aU,aQ;aS.setContentLoading(true);aR={playback:aT.playback,streamToPlay:aV.getVideoUrl(),mute:aT.mute,volume:aT.volume};aU=aV.getAdCall();aQ=aV.getCuePoints();if(aU){aR.adCall=aU;aR.cuePoints=aQ}aW=M(aR);au(aG+"loadVideo() params: ",aR);aS.playerApi.newContentRequest_js(aW)},mute:function(){au(aG+"mute()");this.playerApi.mute_js()},pause:function(){au(aG+"pause()");this.playerApi.pauseButton_js()},play:function(){var aQ=this,aR=l.getVideoUi(),aS=false;if(!aR){return}aS=aQ.isInitialized();if(true===aS){aQ.loadVideo()}},replay:function(){au(aG+"replay()");this.playerApi.replay_js()},resume:function(){au(aG+"resume()");this.playerApi.playButton_js()},setVolume:function(aQ){au(aG+"setVolume("+aQ+")");this.playerApi.setVolume_js(aQ)},seekTo:function(aQ){au(aG+"seekTo: "+aQ);this.playerApi.seekTo_js(aQ)},seekToLive:function(){au(aG+"seekToLive");this.playerApi.seekToLive_js()},stop:function(){au(aG+"stopVideo");this.setContentLoading(false);this.playerApi.stopVideo_js()},unmute:function(){au(aG+"unMute()");this.playerApi.unMute_js()},fullscreenOn:function(){au(aG+"fullscreenOn");this.playerApi.userFullscreen_js(1)},fullscreenOff:function(){au(aG+"fullscreenOff");this.playerApi.userFullscreen_js(0)},getDuration:function(){var aQ=this,aR;aR=Math.floor(aQ.playerApi.getDuration_js());return aR},isLive:function(){var aR=this,aQ=aR.playerApi.getIsLive_js();return aQ},detach:function(){var aQ=this;if(!!aQ.playerApi){au("stop flash player");aQ.stop()}},isReady:function(){var aQ=this,aR=aN();return(aR&&aQ.playerReady)}});return aC})();var ao=(function(){var aM="html5";var aJ="[HI5] ";var aQ=false;var aU=false;var aV=false;var aO="click.hi5Player";var aL={isAd:false,profile:"prog",startTime:0,endTime:-1,mapp:"Hi5",contentVO:{chapterStartTimes:[],assetURLs:[]}};var aN,aR=function(aW){aN=aW},aT=function(){return aN};var aE={onPlayerLoaded_cbsi:function(){var aY=l.getVideoUi(),aZ=l.getVideoContainer(aM),aX=aZ.find("video"),aW=aY.videoJSON;if(!aY||!aW){return}aX.removeAttr("controls");au(aJ+"PLAYER LOADED =====>\n",aX)},onPlayerDataLoaded_cbsi:function(){au(aJ+"PLAYER DATA LOADED =====>")},onPlaylistStart_cbsi:function(){au(aJ+"PLAYLIST START =====>")},onPlayListEnd_cbsi:function(){au(aJ+"PLAYLIST END =====>");l.playlistEnd(aM)},onContentStart_cbsi:function(){au(aJ+"CONTENT START =====>");l.contentStart()},onContentEnd_cbsi:function(){au(aJ+"CONTENT END =====>");l.contentEnd(aM)},onAdSlotStart_cbsi:function(){au(aJ+"AD SLOT START =====>")},onAdStart_cbsi:function(){au(aJ+"AD START =====>");l.adStart()},onAdEnd_cbsi:function(){au(aJ+"AD END =====>");l.adEnd();aK.setContentLoading(true)},onStateChange_cbsi:function(aW){au(aJ+"STATE CHANGE =====>\nstate: ",aW)},onVideoProgress:function(aW){if((true===l.isAdPlaying())||(true===l.isContentStarted())){aK.setContentLoading(false)}l.videoProgress({currentTime:aW.getCurrentTime(),duration:aW.getDuration()})},onVideoDone:function(){au(aJ+"VIDEO DONE =====>")},onNoAdContent:function(){au(aJ+"NO AD CONTENT =====>")}};var aH={jsReady:false,setJSReady:function(){this.jsReady=true},isJSReady:function(){return this.jsReady},onCBSIPlayerReady:function(aX){var aW;if(!aX){return}au(aJ+"onCBSIPlayerReady!");aR(aX);aW=aT();$.each(aE,function(aZ,aY){aW.addEventJSCallback(aZ,aY)});aK.setPlayerReady(true)}};var aD;var aI=function(aW){aD=aW};var aS=function(){au("hi5 video click > togglePlay");l.toggleUiPlayPause()};var aG=function(){var a5=aT(),aX=l.video,a2,aZ,a0,a1,a3,aY=l.getVideoContainer(aM),a4,a6,aW;if(!!a5&&!!aY){aW=aY.find("video");if(aW.length<=0){aZ=aY.attr("id");if(aV){a3=aY.parent();a2=a3.attr("id");if(!a2){a2=aZ+"-wrap";a3.attr("id",a2)}a4=aX.els.$imaAdDiv;if(a4){a0=a4.attr("id")}a6=aX.els.$imaAdClickthru;if(a6){a1=a6.attr("id")}}if(a0){au(aJ+"Initialize UVP_IMA >\n- videoDivId: "+aZ+"\n- containerDivId: "+a2+"\n- imaAdDivId: "+a0+"\n- imaAdClickthruId: "+a1);a5.initialize(aZ,a2,a0,a1)}else{au(aJ+"Initialize basic UVP > \nvideoDivId: ",aZ);a5.initialize(aZ)}aW=aY.find("video");aW.attr("poster","/bundles/phoenixsite/images/core/loose/clear.gif");aW.on(aO,aS);aI(aW)}}};var aP=function(aY){var aZ,aX=aY.nativeControls||false,aW=aY.autoHide||false;aZ={partner:aY.partner,nativeControls:aX,autoHide:aW,uvpc:aY.uvpc,loadAnimation:"",logWindow:aA};return aZ};var aF=function(aW){au("!!!!!!!!!! SETTING GLOBAL uvp_sOpts AS: ",aW);ab.uvp_sOpts=aW};var aC=function(aW){var aX=aP(aW);aF(aX)};var aK=c({name:"html5Player",logPrefix:aJ,load:function(aZ){var aX=this,aW=aZ.videoJSON,aY=aW.uvpHi5,a0=aW.uvpHi5Ima;if(true===aQ||true===aU){if(true===aQ){au(aJ+"already loaded")}else{if(true===aU){au(aJ+"already loading")}}return}aU=true;aC(aW);$.each(aH,function(a1,a2){if(undefined===ab[a1]){ab[a1]=a2}});if(aZ.els.$imaAdDiv&&a0){au(aJ+"Load IMA js");$.ajax({url:a0,dataType:"script",error:function(){au(aJ+"IMA script failed to load")},success:function(){au(aJ+"IMA script successfully loaded");aV=true}})}au(aJ+"Load hi5 js: "+aY);$.ajax({url:aY,dataType:"script",beforeSend:function(){au(aJ+"load start: ",aY)},complete:function(){au(aJ+"load complete");aU=false},error:function(){au("error",aJ+"load failure");aX.playerApi=false},success:function(){au(aJ+"load success");aQ=true}})},init:function(){var aW=this;if(aW.isInitialized()){return}aG();aW.playerApi=aT();aW.initialized=true},play:function(){var a4=this,aW=l.getVideoUi(),aY=false,a1,aZ,a2,aX,a0,a3;if(!aW){return}aY=a4.isInitialized();if(!aY){au(aJ+"player is not initialized, quitting");return}au(aJ+"BEG play() =====>");a1=aT();aZ=aW.videoJSON;a2=aW.getVideoUrl();if(undefined===a2){return}aX=$.extend({},aL,{partner:aZ.partner,mediaId:aZ.id,cmsRefId:aZ.guid,videoTitle:decodeURIComponent(aZ.title),assetURL:a2});au("- Video Url: ",a2);a4.setContentLoading(true);a3=aW.getAdCall();if(undefined===a3){au("- load video url");a1.loadVideoByUrl(a2,aX)}else{a3=a3.replace("Giantbomb","Giantbomb_device");a3=a3+"&ad_rule=0";a0={pre_0:a3};au("- loadContentWithAds: ",a0);a1.loadContentWithAds(a0,aX)}au(aJ+"END play() =====>")},pause:function(){var aW=this;au(aJ+"pause video");aW.playerApi.pauseVideo();au(aJ+"paused video")},resume:function(){au(aJ+"resume video");this.playerApi.playVideo()},replay:function(){au("seek to 0");this.playerApi.seekTo(0);au("replay video");this.playerApi.playVideo()},stop:function(){this.playerApi.stopVideo()},mute:function(){au(aJ+"fire playerApi.mute()");this.playerApi.mute()},unmute:function(){au(aJ+"fire playerApi.unMute()");this.playerApi.unMute()},setVolume:function(aW){au("setting html volume");this.playerApi.setVolume(aW)},seekTo:function(aW){this.playerApi.seekTo(aW)},seekToLive:function(){},getDuration:function(){return this.playerApi.getDuration()},getCurrentTime:function(){return this.playerApi.getCurrentTime()},detach:function(){au(aJ+"stop player");this.stop()},});return aK})();var P="https://gdata.youtube.com/feeds/api/videos/",T="?v=2&alt=json-in-script",d=".js-vid-youtube",q=function(aD,aC){var aE=aC.youtubeID;if(undefined===aD){return}if(!aE){au("error","Invalid youtubeID");aD.remove()}else{$.ajax({url:P+aE+T,beforeSend:function(){au("Checking youtubeID "+aE+" against API")},error:function(aF,aG){if("error"===aG){aC.youtubeID=null;q(aD,aC)}}})}};var S=(function(){var aG="[YT]";var aJ="<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen/>";var aF="http://www.youtube.com/embed/";var aI={wmode:"transparent",autoplay:"1"};var aC;var aD=function(aL){var aK;if(!aL){return}aK=aF+aL+"?"+$.param(aI,true);au("youtube embed url: ",aK);return aK};var aE=function(){if(undefined===aC){aC=$(aJ,{frameborder:"0"})}return aC};var aH=c({name:"youtubePlayer",logPrefix:aG,playerApi:null,play:function(){var aO=l.getVideoContainer("youtube"),aM=aE(),aL=l.getVideoUi(),aK,aN;if(aL&&aL.videoJSON){aN=aL.videoJSON.youtubeID}if(!aN){return}au(this.name+" > play");au(aG+"play() > videoId: "+aN);aK=aD(aN);au(aG+"play() > embedUrl: "+aK);aM.attr("src",aK);aO.append(aM)},detach:function(){var aK=aE();aK.attr("src","").detach()},isReady:function(){return true},isContentLoading:function(){return true}});return aH})();var l=(function(){var aE="[SWITCH] ";var aG={flash:at,html5:ao,youtube:S};au(aE+"playerTypes: ",aG);var aD=false;var aH=function(aI,aK){var aJ=false;if(!!aI){aJ=(aI.videoJSON.id===aK.videoJSON.id)}return aJ};var aC=(function(){var aR="[RELAY] ";var a0={};var aM=[],aJ=[];var aI="pause",aU="play",aO="resume",aX="stop",aK="mute",a2="unmute";var aL=[aU,aX];var aV=function(a4){return(0<=$.inArray(a4,aL))};var aZ;var aQ=function(a4){aZ=a4};var aW=function(){return aF.player};var aS=function(a6,a5){var a4=aW();if(!a4){au(aR+"runPlayerMethod() failed :: undefined player");return}try{au(aR+"runPlayerMethod() >\n- methodName: "+a6+"\n- methodArgs: ",a5);if(!!a5&&a5.length>0){a4[a6](a5)}else{a4[a6]()}}catch(a7){au("error",aR+"runPlayerMethod(): ",a7.message)}};var a3=function(a5){var a6,a4=aR+"Use ";if(aV(a5)){a4+="preContentReadyQueue";a6=aM}else{a4+="contentReadyQueue";a6=aJ}a4+=" for ["+a5+"]";return a6};var a1=function(){return((0<aM.length)||(0<aJ.length))};var aN=function(a5){var a7=a3(a5),a4=$.inArray(a5,a7),a6=false;if(a4>=0){a7.splice(a4,1);if(a0[a5]){delete a0[a5]}au(aR+"removeQueueMethod() methodName removed: ",a5);a6=true}return a6};var aY=function(){var a5=Array.prototype.slice.call(arguments),a8=a5.shift(),a6,a4=false,a7;if(a8.length===0){return}a6=a8.shift(a8);a7=a3(a6);au(aR+"BEG queuePlayerMethod() queued methods: ",a7.join(", "));switch(a6){case aU:aN(aO);aN(aI);break;case aO:aN(aI);a4=true;break;case aI:aN(aO);break;case aK:aN(a2);break;case a2:aN(aK);a4=true;break}aN(a6);if(false===a4){a7.push(a6);if(a8.length>0){a0[a6]=a8}au(aR+"queuePlayerMethod() new queued method: ",a6)}au(aR+"END queuePlayerMethod() queued methods: ",a7.join(", "))};var aP=function(){var a6=aW(),a4=aM.length,a5=aJ.length,ba=0,a9,a8,a7;if(!a6){au(aR+"runQueue() failed :: undefined player");return}if(a4>0){ba=a4;a9=aM}else{if(a5>0){if(a6.isContentLoading()){au(aR+"runQueue() prevented :: content is still loading");return}else{ba=a5;a9=aJ}}}au(aR+"BEG runQueue() >\n- preContentReadyQueueLength: "+a4+"\n- contentReadyQueueLength: "+a5+"\n- queueLength: "+ba+"\n- queueToRun: ",a9);if(ba>0){while(ba>0){a8=a9.shift();a7=a0[a8];ba=a9.length;aS(a8,a7)}}au(aR+"END runQueue()")};var aT={setPlayer:function(a4){aQ(a4)},run:function(){var a6=aW(),a5=Array.prototype.slice.call(arguments),a7=(0<a5.length),a4=false,a9,a8,ba;if(!a6){return}au(aR+"BEG run() >\n- arguments: ",arguments);if(!a6.isInitialized()){au(aR+"player.init()");a6.init()}ba=a6.isReady();au(aR+"run() >\nisReady: "+ba+"\nhasQueuedMethods: "+a1()+"\nhasArguments: "+a7);if((true===ba)&&(false===a1())&&(true===a7)){a9=a5.shift();a8=a5;au(aR+"Player API is ready without any queued methods");if(aV(a9)||!a6.isContentLoading()){au(aR+"Running ["+a9+"] player method.");aS(a9,a8);a4=true}else{au(aR+"Restore args with ["+a9+"] for queuing.");a5.unshift(a9)}}if(!a4){if(true===a7){au(aR+"Queuing player method: ",a5);aY(a5)}au(aR+"player API is"+(ba?"":" not")+" ready, "+(ba?"":" don't ")+"run the queue");au(aR+"isReady: "+ba);if(true===ba){aP()}}au(aR+"END run()")},clear:function(){aM=[];aJ=[];a0={}},hasQueuedMethods:function(){return a1()}};return aT})();var aF={player:null,video:null,states:{},loadPlayerTypes:function(aI,aL){if(true===aD||!aI||aI.length<1){return}var aJ,aM,aK;au(aE+"Load Player Types: ",aI);for(aJ=0;aJ<aI.length;aJ++){aM=aI[aJ];aK=aG[aM];if(!!aK&&!!aK.load){aK.load(aL)}}aD=true},isPlaying:function(){var aJ=this.video,aI=false;if(!!aJ){aI=aJ.states.playing}return aI},getPlayer:function(aO){var aI=this,aM=aO.states,aP=aM.playerType,aL=aG[aP],aK,aJ=false,aN=false;au(aE+"getPlayer() playerType: "+aP);if(undefined===aL){au("error",aE+"Undefined player type ["+aP+"]")}aK=aI.player||{};aN=!!aK.name;if(aK.name!==aL.name){aJ=true}if(true===aJ){au(aE+"newPlayer: ",aL.name);au(aE+"currentPlayer: ",aK.name);if(true===aN){au(aE+"Switch to ["+aP+"] player");aI.setPlayer(aK,aL)}else{aI.player=aL;au(aE+"new player: ",aL)}}else{au(aE+"player is ["+aP+"]")}},setPlayer:function(aL,aJ){var aI=this;if(aI.video){var aM=aI.video.states,aN=aM.playerType,aK=aG[aN];au(aE+"setPlayer()");au(aE+"currentPlayer: ",aL);au(aE+"newPlayer: ",aJ);if(!aL){aL=aI.player;au(aE+"Using self.player as currentPlayer: ",aL)}if(!aJ){aJ=aK;au(aE+"Using playerTypes[playerType] as newPlayer: ",aJ)}if(aJ){if(aL){au(aE+"UNSET CURRENT PLAYER");aL.detach()}au(aE+"SET NEW PLAYER");aI.player=aJ;au(aE+"Updated player to ["+aJ.name+"]")}return true}return false},changePlayerState:function(aO,aS){var aT=this,aK=aT.video,aL=aT.states,aQ=aO.states,aM=true,aP,aN,aR=0,aJ={},aI=false;if(false===aH(aK,aO)){aI=true;if(false===aQ.playing){aM=false}}if(false===aM){return}au(aE+"!!!!! CHANGE PLAYER STATE !!!!!\n",aO.states);if(!aS){aS=[]}else{au(aE+"forcing state updates for: "+aS.join(", "))}for(aP in aQ){if(aQ.hasOwnProperty(aP)){aN=aQ[aP];if((aN!==aL[aP])||(0<=$.inArray(aP,aS))){aR+=1;aJ[aP]=aN}}}if(aJ.playerType){au(aE+"changedStates.playerType > getPlayer");aT.getPlayer(aO)}if(aJ.volume){au(aE+"changedStates.volume > setVolume");aT.setVolume(aJ.volume)}if(aJ.mute===true){au(aE+"changedStates.mute > mute");aT.mute()}else{if(aJ.mute===false){au(aE+"changedStates.mute > unmute");aT.unmute()}}if(0<aR){au("changedStates: ",aJ);$.extend(aT.states,aQ)}},play:function(aN){var aJ=this,aL=aJ.video||{},aM,aI=false,aK;au("playerManager.play()");if(!aN){au("error","playerManager.play() > undefined video")}if(null===aJ.player){au("playerManager.play() > BEFORE get player");aJ.getPlayer(aN);au("playerManager.play() > AFTER get player")}aK=aJ.player;aJ.video=aN;aN.setVideoProgress("","0%");if(aL.playerId!==aN.playerId){aI=true}aC.run("play");au("playerManager.play() > update states: ",aM);aJ.changePlayerState(aN,["volume","mute"])},pause:function(){aC.run("pause")},resume:function(){aC.run("resume")},replay:function(){aC.run("replay")},mute:function(){aC.run("mute")},unmute:function(){aC.run("unmute")},setVolume:function(aI){aC.run("setVolume",aI)},seekTo:function(aI){aC.run("seekTo",aI)},seekToLive:function(){aC.run("seekToLive")},onPlayerReady:function(){if(aC.hasQueuedMethods()){aC.run()}},getDuration:function(){var aI=this.player,aJ;if(!!aI){aJ=aI.getDuration()}return aJ},savePosition:function(aJ){var aI=this.video;if(!!aI&&!!aI.savePosition){aI.savePosition(aJ)}},getVideoUi:function(){return this.video},getVideoContainer:function(aK,aJ){var aI=this,aL;if(!aJ){aJ=aI.video}if(aJ){aL=aJ.getVideoContainer(aK);return aL}else{au("error","unable to run getVideoContainer on undefined video")}},isAdPlaying:function(){var aJ=this,aI=false;if(aJ.video&&aJ.video.states){aI=!!aJ.video.states.adPlaying}return aI},isContentStarted:function(){var aJ=this,aI=false;if(aJ.video&&aJ.video.states){aI=!!aJ.video.states.contentStarted}return aI},isActivePlayerType:function(aM){var aJ=this,aL=aJ.video,aI=false,aK;if(aL){aK=aL.states;aI=(aM===aK.playerType)}return aI},adEnd:function(){var aI=this;if(aI.video){aI.video.adEnd()}},adStart:function(){var aI=this;if(aI.video){aI.video.adStart()}},contentEnd:function(aJ){var aI=this;if(aI.isActivePlayerType(aJ)){aI.video.contentEnd()}else{au(aE+"contentEnd ignored :: playerType is not active")}},contentLoading:function(aJ){var aI=this;if(aI.video){aI.video.contentLoading(aJ)}},contentStart:function(){var aI=this;if(aI.video){aI.video.contentStart()}},playlistEnd:function(aJ){var aI=this;if(aI.isActivePlayerType(aJ)){aI.video.playlistEnd()}else{au(aE+"playlistEnd ignored :: playerType is not active")}},toggleUiPlayPause:function(){var aJ=this,aI;if(aJ.video){au(aE+"play/pause from player api");aI=aJ.video.els.$playPauseButtons;aI.first().trigger("click")}},videoProgress:function(aJ){var aI=this;if(aI.video){aI.video.videoProgress(aJ)}}};return aF})();var y="cmd-value",N="dn",U="on";var b=function(aC){return(!!aC&&(aC.length>0)&&(aC.closest("html").length>0)&&!aC.hasClass(N))};var k=function(aC){return !!aC&&aC.hasClass(U)};var R=function(aD,aC){return(aD.data(y)===aC)};var v=function(aD){var aC=aD.filter(".js-vid-default"),aE;aC=aC.not("."+N);aE=aC.first();if(aE.length<1){aE=aD.first()}return aE};var aw=function(aD,aE){var aC=aD.filter(function(){var aF=$(this);return((true===b(aF))&&(true===R(aF,aE)))});return aC};var t=function(aE,aD,aC){if(!aE||0===aE.length){return}if(true===aD){aE.addClass(aC)}else{if(false===aD){aE.removeClass(aC)}}};var J=function(aC){g(aC);t(aC,true,N)};var ay=function(aC){t(aC,false,N)};var ai=function(aC){t(aC,true,U)};var g=function(aC){t(aC,false,U)};var ae=(function(){var aD="[UI CORE] ";var aC={$videoPlayerDiv:null,$videoContainer:{selector:".js-vid-player-holder"},$imaAdDiv:{selector:".js-vid-ima-ad"},$imaAdClickthru:{selector:".js-vid-ima-clickthru"},$ageGate:{selector:".js-vid-age-gate"},$ageMonth:{selector:".js-vid-age-gate-month"},$ageDay:{selector:".js-vid-age-gate-day"},$ageYear:{selector:".js-vid-age-gate-year"},$ageDate:{selector:".js-vid-age-gate-date"},$playPauseButtons:{selector:".js-vid-play",events:{click:"togglePlay"}},$qualityButtons:{selector:".js-vid-quality",events:{click:"setQuality"}},$timeDisplay:{selector:".js-vid-time"},$kubrickLead:{selector:"#kubrick-lead",unique:true},$countdown:{selector:".js-vid-countdown"}};var aK={type:"wtfbbq",playerId:null,videoJSON:null,adMessagePrefix:"Your video begins in: ",els:{},states:{playback:null,playerType:null,quality:null,adPlayed:false,contentLoading:false,contentStarted:false,played:false,paused:false,started:false,counting:false,adPlaying:false,gated:false,hasGate:false,showAgeGate:false,loading:true,playing:false,volume:1,embiggened:false,mute:false,share:false,stickied:false,fullscreen:false,windowed:false,currentTime:0,duration:0,isLive:false,isOffAir:false,isRewound:false,isSeekDisabled:true,liveStartTime:0,liveSeekDelay:10,liveSeekDelayLeft:null,stowControls:false},classNames:{contentLoading:"is-vid-content-loading",contentStarted:"is-vid-content-started",played:"is-vid-played",started:"is-vid-started",counting:"has-vid-countdown",adPlaying:"is-vid-ad-playing",gated:"has-vid-invalid-age",hasGate:"has-vid-age-gated",showAgeGate:"is-vid-age-gate",disabled:"is-vid-disabled",loading:"is-vid-loading",playing:"is-vid-playing",embiggened:"is-vid-embiggened",mute:"is-vid-muted",share:"has-vid-share",stickied:"is-vid-stickied",fullscreen:"is-vid-fullscreen",windowed:"is-vid-fullscreen",isLive:"is-vid-live",isOffAir:"is-vid-offair",isRewound:"is-vid-rewound",isSeekDisabled:"is-vid-noseek",stowControls:"is-vid-stow-controls"},kubrickClassNames:{played:"video-active",playing:"video-playing"}};aK.initialize=function(aO){var aM=this,aN=aM.els;au("Player type: "+aM.type);aM.playerId=aO.playerId;aM.videoJSON=aO.videoJSON;if(!!aO.els){$.extend(aN,aO.els)}aM.initElements();aM.initStates();aM.initComplete()};aK.initElements=function(){var aO=this,aR=aO.getUiMap(),aQ=aO.els,aN,aM,aP;for(aM in aR){if(aR.hasOwnProperty(aM)){aN=undefined;aP=aR[aM];if(!!aP){aN=aO.getUiElement(aM,aP)}au("UI Elements ["+aM+"]: ",(!!aN?aN.length:0));if(undefined!==aN){aQ[aM]=aN;if(!!aP.events){aO.addElementEvents(aN,aP)}}}}aO.initCountdown()};aK.initStates=function(){};aK.initComplete=function(){au(aD+"initComplete");this.setStates({loading:false})};aK.getUiMap=function(){return $.extend({},aC)};aK.getUiElement=function(aO,aT){var aQ=this,aS=aQ.els,aR=aQ.playerId,aN=aT.selector,aM="",aP;aP=aS[aO];if(undefined===aP){if(!!aN&&(aN.indexOf("#")===0)&&!aT.unique){aM=aR}if(!!aN){if(""!==aM){aN+=aM}if(aN.indexOf("#")===0){aP=$(aN)}else{aP=aS.$videoPlayerDiv.find(aN)}}}if(!aP||aP.length<1){aP=undefined}return aP};aK.handleUserAction=function(){};aK.getEventFunction=function(aN,aP,aS,aQ){if(!aN||aN.length<=0||!aP){return}var aO=this,aM,aR;if(aS){aR=aO[aS]}if(!aR){au("Unable to find callback for ["+aS+"]");return}if("click"===aP){aM=function(aW){var aV=$(this),aU=false,aT=aV.data(y);o(aW);aU=aR.call(aO,aT);if(true===aU){au("CHANGED!!!\n",aO.states);aO.handleUserAction(aV,aQ);if(true===aO.states.started){au("!!! Change occured during playback !!!");l.changePlayerState(aO)}}}}else{aM=function(aT){aR.call(aO,aT,$(this).data(y))}}return aM};aK.addElementEvents=function(aT,aN){var aU=this,aS=aN.events,aP,aR,aO,aM={},aQ=false;if(!aT||aT.length<=0||!aS){return}for(aP in aS){if(aS.hasOwnProperty(aP)){aR=aS[aP];if(!!aR){aO=aU.getEventFunction(aT,aP,aR,aN);if(undefined!==aO){aM[aP]=aO;aQ=true}}}}if(true===aQ){au("- adding eventsMap: ",aM);aT.on(aM)}};aK.initCountdown=function(){var aN=this,aM=aN.videoJSON,aR=aM.currentTime,aQ=aM.liveAirTime,aP=aN.els.$countdown,aO=false;if(!aP){au("No countdown");return}au("Initializing countdown");aO=!aP.data("complete")&&(aQ>0&&aR<aQ);if(aO){aP.on("complete",function(){aN.setStates({counting:false});if(aM.autoplay){aN.autoplay()}});aN.setStates({counting:true})}};aK.getVideoContainer=function(aO){var aN=this,aP=aN.els.$videoContainer,aM=aP.attr("id");if(!aM){aP.attr("id","js-vid-"+aO+"-player"+aN.playerId)}return aP};aK.togglePlay=function(){var aN=this,aP=aN.states,aO=aP.playing,aM=false;au(aD+"togglePlay > states: ",aP);if(true===aO){aM=aN.pause()}else{if(true===aP.started){aM=aN.resume()}else{aM=aN.play()}}if(true===aM){aP.playing=!aO}return aM};var aL=function(aM){var aO=aM.watchedCookieName,aN;if(!aO){return}aN=$.parseJSON($.cookie(aO));if(!aN){aN=[]}return aN};var aJ=function(aN){var aQ=aN.id,aP=aN.watchedCookieName,aM=aN.watchedCookieDays,aO=aL(aN);if(undefined===aO){return}if(0>$.inArray(aQ,aO)){aO.push(aQ)}$.cookie(aP,M(aO),{path:"/",expires:aM})};var aE=function(aM){var aO=!!($("#VideoDisableTracking").attr("content")),aN=aM.id;au(aD+"Disable Tracking? ",aO);if(aO||!aN){return}$.ajax({url:"/api/video/played/"+aN+"/",type:"GET",success:function(aP){if(aP.success===0){au(aD+"Error logging view")}else{if(aP.success===1){au(aD+"View logged successfully")}}}});aJ(aM)};aK.play=function(){var aP=this,aQ=aP.states,aO=aP.isAgeGated(),aN=false,aM=aP.videoJSON,aR=aM.id;au("[UI] ui.play");if(true===aO){aP.gate()}else{if(false!==aO&&("string"===typeof aO)){if("prompt"===aO){aP.promptAgeGate()}else{alert(aO)}}else{aN=true;if(false===aQ.playing){au(aD+"video is not playing > play")}if(false===aQ.played&&!!aR){au(aD+"video has not played > log view");aE(aM)}aP.setStates({played:true,playing:true,paused:false,started:true});l.play(aP);m().trigger("video_play")}}};aK.pause=function(){var aM=this;aM.setStates({paused:true,playing:false});au(aD+"Tell playerManager to pause");l.pause(aM);return true};aK.resume=function(){var aM=this;aM.setStates({paused:false,playing:true});l.resume(aM);return true};aK.replay=function(){var aM=this;aM.setStates({playing:true,started:true});l.replay(aM)};aK.adStart=function(){au(aD+"start video ad");this.setStates({adPlayed:true,adPlaying:true})};aK.adEnd=function(){var aM=this;au(aD+"end video ad");aM.setStates({adPlaying:false})};aK.contentStart=function(){var aM=this,aO=aM.states,aN=aO.paused;this.setStates({adPlaying:false,paused:aN,playing:!aN,started:true,contentStarted:true})};aK.contentEnd=function(){var aN=this,aQ=aN.states,aP={contentStarted:false},aM=aQ.isLive,aO=false,aR=aQ.currentTime,aT=aQ.duration,aS=Math.abs(aT-aR);if(1>=aS){aO=true}au(aD+"content end");au("- isLive: "+(aM?"yes":"no"));au("- currentTime: "+aQ.currentTime);au("- duration: "+aQ.duration);if(!aM&&aO){aP.playing=false;aP.started=false}this.setStates(aP)};aK.playlistEnd=function(){this.setStates({contentStarted:false,playing:false,started:false})};var aH=[],aF=4,aI=true,aG=function(aM){aH.push(aM);if(aH.length===aF){if(aH[0]===aH[aF-1]){aI=false}else{aI=true}aH=aH.slice(aF-1)}return aI};aK.liveStreamCheck=function(aM){var aX=this,aT=aX.states,aV=false,aW=false,aU=false,aN=aM.currentTime,aP=aM.duration,aQ=aT.liveSeekDelay,aO=aT.liveSeekDelayLeft,aS,aR;if(!aX.videoJSON.isLiveStream){return}if(aT.duration===0){return}if(aT.currentTime===aN){return}aS=aG(aP);if(aO===null){aT.liveStartTime=aN}if(aO!==false){aR=aT.liveStartTime;aO=aQ-aN+aR}if(aO>0){aT.liveSeekDelayLeft=aO;aM.isSeekDisabled=true;return}else{if(false!==aT.liveSeekDelayLeft){aT.liveSeekDelayLeft=false;aM.isSeekDisabled=false}}if(true===aS){if(aN<aP-2){aU=true}else{aW=true}}else{aV=true}if(aT.isOffAir!==aV){aM.isOffAir=aV}if(aT.isLive!==aW){aM.isLive=aW}if(aT.isRewound!==aU){aM.isRewound=aU}};aK.videoProgress=function(aO){var aM=this,aN=aM.states;if(false===aN.adPlaying){if(true===aM.videoJSON.isLiveStream){aM.liveStreamCheck(aO)}else{if(false!==aN.isSeekDisabled){aO.isSeekDisabled=false}}aM.els.$videoPlayerDiv.trigger("contentProgress",aO);aM.setStates(aO)}};aK.hasAgeGate=function(){var aN=this,aM=aN.els.$ageGate,aO=aN.videoJSON.contentRating,aP=true;if(!aM||!aO){au("[AGE GATE] not gated");aP=false}else{au("[AGE GATE] gated")}return aP};aK.promptAgeGate=function(){this.setStates({showAgeGate:true})};aK.isAgeGated=function(){var aZ=this,aP=aZ.els,aN=aP.$ageGate,a0=aP.$ageYear,aR=aZ.videoJSON,aM=aR.contentRating,aV=aR.ageGateCookieName,aY,aU,aQ,aT,aS,aX,aW,aO=false;au("[AGE GATE] Checking...");if(true===aZ.hasAgeGate()){if(false===aZ.states.showAgeGate){aO="prompt"}else{aT=a0.val();au("[AGE GATE] Year selected: "+aT);if("year"===aT){au("warning","[AGE GATE] missing year value");aO="Please select a year value to validate your age!"}else{aQ=aP.$ageMonth.val();aU=aP.$ageDay.val();aS=new Date();aY=[aT,aQ,aU];aX=new Date(aT,aQ,aU);aW=Math.floor((aS-aX)/31536000000);if(!!aV){$.cookie(aV,aY.join("-"),{path:"/",expires:2000})}if(aW<aM){au("[AGE GATE] User is not old enough");aO=true}}}}if(false===aO){au("[AGE GATE] User is old enough");aZ.setStates({hasGate:false,showAgeGate:false});if(!!aN&&aN.length>0){aN.remove();delete aP.$ageGate}}return aO};aK.gate=function(){var aM=this,aN=aM.els,aO=aN.$videoPlayerDiv;aM.setStates({disabled:true,gated:true});aO.find(".js-vid-player-chrome").remove();aO.off(V)};aK.getAdCall=function(){var aN=this,aQ=aN.states.adPlayed,aO=aN.videoJSON.adCall,aR,aP,aM;if(!!aO&&(false===aQ)){aR=decodeURIComponent(aO);aP=$.cookie("AD_SESSION")}if(!!aP){aM="cust_params=session%3D"+aP+"%26";aR=aR.replace("cust_params=",aM)}return aR};aK.getCuePoints=function(){var aO=this,aN=aO.videoJSON,aM;aM=aN.cuePoints;return aM};aK.getVideoUrl=function(){var aN=this,aP=aN.states.quality,aM=aN.videoJSON,aO;aO=aM.videoStreams[aP];au(aD+"getVideoUrl() =====>"+aO);if(!aO){au("error",aD+"Playback quality unavailable: ",aP)}return aO};aK.setStates=function(aU){var aX=this,aS=aX.els.$videoPlayerDiv,aT=aX.classNames,aQ=[],aR=[],aV=aX.els.$kubrickLead,aO=aX.kubrickClassNames,aW=[],aP=[],aM,aN;$.each(aU,function(aY,aZ){aM=aT[aY];if(aY==="playerType"&&(aZ!==aX.states[aY])){aM="is-vid-"+aZ+"-player";if(aX.states[aY]){aN="is-vid-"+aX.states[aY]+"-player";if(aN){aR.push(aN)}}aZ=true}if(undefined!==aM){if(true===aZ){aQ.push(aM)}else{aR.push(aM)}}if(aV){aM=aO[aY];if(undefined!==aM){if(true===aZ){aW.push(aM)}else{aP.push(aM)}}}});$.extend(aX.states,aU);if(aQ.length>0){aQ=aQ.join(" ");au(aD+"setStates addClass: ",aQ);aS.addClass(aQ)}if(aR.length>0){aR=aR.join(" ");au(aD+"setStates removeClass: ",aR);aS.removeClass(aR)}if(aW.length>0){aW=aW.join(" ");au(aD+"setStates $kubrickLead.addClass: ",aW);aV.addClass(aW)}if(aP.length>0){aP=aP.join(" ");au(aD+"setStates $kubrickLead.removeClass: ",aP);aV.removeClass(aP)}};aK.setControl=function(aO,aP){var aM=false,aN;aN=aw(aO,aP);if((aN.length>0)&&(false===k(aN))){au(aD+"New Value Control for ["+aP+"]: ",aN);aM=true;ai(aN);g(aO.not(aN))}return aM};aK.setQuality=function(aQ,aR){var aN=this,aO=aN.states,aP=aN.els.$qualityButtons,aM=aN.setControl(aP,aQ);if(true===aM){au(aD+"setQuality newValue: "+aQ);aO.quality=aQ;if(aO.started&&!aR){aN.play()}}return aM};aK.setVideoProgress=function(){};aK.contentLoading=function(aM){this.setStates({contentLoading:aM})};return aK})();var O=(function(){var aC="[UI MOBILE] ";var aE={$deviceAdMessage:{selector:".js-vid-ad-message"}};var aD={type:"mobile",states:{playback:"html5Progressive",playerType:"html5",quality:null}};aD=$.extend(true,{},ae,aD);aD.initialize=function(aG){var aF=aG.videoJSON;$.extend(aF,{nativeControls:true,autoHide:true});ae.initialize.call(this,aG)};aD.initStates=function(){var aF=this,aH=v(aF.els.$qualityButtons),aG=aH.data(y);au(aC+"initStates");aF.setQuality(aG)};aD.initComplete=function(){var aF=this;l.loadPlayerTypes([aF.states.playerType],aF);ae.initComplete.call(aF)};aD.getUiMap=function(){var aF=$.extend(true,ae.getUiMap(),aE);return aF};aD.videoProgress=function(aK){var aG=this,aH=aG.states,aJ=aH.adPlaying,aF="",aI,aL;ae.videoProgress.call(aG,aK);aI=aK.currentTime;aL=aK.duration;if(true===aJ){aF=aG.adMessagePrefix+j(aL-aI)}aG.setVideoProgress(aF)};aD.setVideoProgress=function(aF){var aG=this.els,aH=aG.$timeDisplay;if(!!aH){aH.html(aF)}};return aD})();var ad=(function(){var aP="[UI DESKTOP] ";var aE={$videoPlayerDiv:{events:{keydown:"spacebarToggle",selectstart:"stopSelect"}},$videoMaxWidth:{selector:".js-vid-max-width"},$avBox:{selector:".js-vid-box"},$kubrickLead:{external:true,parentOf:"$videoPlayerDiv"},$kubrickInfo:{selector:".kubrick-info",external:true,childOf:"$kubrickLead"},$kubrickInfoParent:{selector:".row",external:true,childOf:"$kubrickLead"},$embiggenContainer:{selector:".js-video-embiggen",external:true,parentOf:"$videoPlayerDiv"},$embiggenVidSize:{selector:".js-video-size",external:true,parentOf:"$videoPlayerDiv"},$stickyContainer:{selector:".js-video-sticky",external:true,parentOf:"$videoPlayerDiv"},$videoSpacer:{selector:"#video-spacer",external:true,dependsOn:"$kubrickLead"},$playPauseButtons:{selector:".js-vid-play, .js-vid-play-pause"},$volume:{selector:".js-vid-volume"},$volumeBar:{selector:".js-vid-volume-bar",events:{mousedown:"volumeChange","mousedown.volumeSlide":"volumeSlideStart","mouseup.volumeSlide":"volumeSlideStop"}},$volumeHandle:{selector:".js-vid-volume-handle"},$muteButton:{selector:".js-vid-mute",events:{click:"toggleMute"},cookieType:"state",state:"mute"},$fullscreenButton:{selector:".js-vid-fullscreen",events:{click:"toggleFullscreen"}},$fullWinButton:{selector:".js-vid-windowed",events:{click:"toggleWindowed"}},$playbackButtons:{selector:".js-vid-playback",events:{click:"setPlayback"},cookieType:"state",state:"playback"},$qualityButtons:{cookieType:"state",state:"quality"},$embiggenButtonContainer:{selector:".js-vid-embiggen-wrap",dependsOn:"$embiggenVidSize"},$embiggenButton:{selector:".js-vid-embiggen",events:{click:"toggleEmbiggen"},cookieType:"state",state:"embiggen",dependsOn:"$embiggenVidSize"},$stickyPinButtonContainer:{selector:".js-vid-pin-wrap",dependsOn:"$stickyContainer"},$stickyPinButton:{selector:".js-vid-pin",events:{click:"toggleSticky",},state:"sticky",dependsOn:"$stickyContainer"},$shareButton:{selector:".js-vid-share",events:{click:"toggleShare"}},$shareModal:{selector:".js-vid-modal-share",ui:{sizes:".js-vid-share-sizes",markup:".js-vid-share-size-markup"}},$seeker:{selector:".js-vid-buffer",cookieType:"position",events:{click:"seekTo",mouseenter:"seekDisplayStart",mouseleave:"seekDisplayStop"}},$seekDisplay:{selector:".js-vid-seek-display"},$seekText:{selector:".js-vid-seek-text"},$seekPointer:{selector:".js-vid-seek-pointer"},$seekToLive:{selector:".js-vid-seektolive",events:{click:"seekToLive"}},$progress:{selector:".js-vid-position"},$loader:{selector:".js-vid-loaded"}};var a3={state:"saveState",position:"savePosition"};var aO=function(){return(location.pathname==="/")};var a2="__gamesVideoPlayer";var aU={type:"desktop",stateJSON:{},seekTime:0,playbacks:null};aU=$.extend(true,{},ae,aU);aU.initElements=function(){var a4=this;ae.initElements.call(a4)};aU.initStates=function(){var a5=this,a4;a4=a5.initPlaybackQualities();au(aP+"hasPlaybacks? ",a4);if(!a4){au(aP+"no playbacks");return}a5.loadSavedState()};aU.initPlaybackQualities=function(){var a8=this,bb=a8.els.$playbackButtons,a9=a8.els.$qualityButtons,a7={},a5={},ba,a6=false,a4=[];if(a9){au(aP+"$qualities: ",a9);a9.each(function(){var bc=$(this),bd=bc.data(y);a5[bd]=this})}else{au("error",aP+"No qualities defined!");bb=undefined}if(!!bb){bb.each(function(){var bc=$(this),bf=bc.data(y),bi=b(bc),bh=bc.data("qualities").split(","),be=[],bg,bj=[],bd;for(ba=0;ba<bh.length;ba++){bg=a5[bh[ba]];if(undefined!==bg){bj.push(bg);be.push(bh[ba])}}bd=bc.data("player");if(0>$.inArray(bd,a4)){a4.push(bd)}a7[bf]={isAvailable:bi,playerType:bd,qualities:be,$button:bc,$qualities:$(bj)};au(aP+"Playback Quality Elements for ["+bf+"]: ",a7[bf])});if(a4.length>0){a8.playbacks=a7;a6=true;l.loadPlayerTypes(a4,a8)}}return a6};aU.initShareModal=function(){var a5=this,a6=a5.els.$shareModal,a9=aE.$shareModal.ui,a8,a4,a7={},ba;if(!a6){return}a8=a6.find(a9.sizes);a4=a6.find(a9.markup);ba=a4.data("size");au(aP+"===== BEG ui.initShareModal =====>");au(aP+"Default share size is: ",ba);a4.each(function(){var bb=$(this);a7[bb.data("size")]=bb});ay(a7[ba]);a8.on("change",function(){var be=this,bd=$(be),bc=bd.data("size")||ba,bb=be[be.selectedIndex].value||ba;if(bc!==bb){bd.data("size",bb);J(a7[bc]);ay(a7[bb])}});au(aP+"===== END ui.initShareModal =====>")};aU.initComplete=function(){var bf=this,a8=bf.stateJSON,bd=a8.playback,be=a8[bf.getStateKey("sticky")],ba=a8[bf.getStateKey("embiggen")],a5=a8.volume,a6=a8.mute,bb=bf.videoJSON,a4=Y(),a7=bf.els,a9=a7.$playbackButtons,bc;bf.initShareModal();bc=aw(a9,bd);if(0===bc.length){au(aP+"invalid playback ["+bd+"]");bd=undefined}if(undefined===bd){bc=v(a9);bd=bc.data(y);au(aP+"using default playback ["+bd+"]")}bf.setPlayback(bd);if(!!a7.$stickyPinButton&&true===be){bf.setSticky(true)}if(!!a7.$embiggenButton&&true===ba){bf.setEmbiggen(true)}if(undefined!==a5){bf.setVolume(a5,true)}if(true===a6){bf.setMute(true)}aU.adjustWidth();a4.on("resize",function(){aU.adjustWidth()});ae.initComplete.call(bf);if(true===bb.autoplay&&false===bf.states.counting&&!bf.els.$countdown){au(aP+"!AUTOPLAY!");bf.autoplay()}};aU.getUiMap=function(){var a4=$.extend(true,ae.getUiMap(),aE);au(aP+"uiMap: ",a4);return a4};aU.getUiElement=function(bd,a5){var bc=this,a7=bc.els,a9=bc.videoJSON,a4=a5.selector,a8,a6,bb,ba;if(!!a5.external){if(!!a5.parentOf){a8=a5.parentOf;a6="parents"}else{if(!!a5.childOf){a8=a5.childOf;a6="find"}}if(!!a8){bb=a7[a8]}if(!!bb&&!!a6){ba=bb[a6](a4)}else{if(a4.indexOf("#")===0){ba=$(a4)}}if(!ba||ba.length<1){ba=undefined}au(aP+"external element ["+bd+"]: ",ba)}else{ba=ae.getUiElement.call(bc,bd,a5)}if(!!a5.dependsOn&&!!ba){bb=a7[a5.dependsOn];if(undefined===bb){au("warn",aP+"- ["+bd+"] depends on an element that does not exist. Removing from player.");ba.remove();ba=undefined}}if(undefined!==ba){if(ba.is(d)){q(ba.filter(d),a9)}}return ba};aU.handleUserAction=function(a4,a7){au(aP+"handleUserAction > elementData: ",a7);var a6=this,a8=a7.cookieType,a9=a6[a3[a8]],a5;if(!a9){au("warn",aP+"Not a cookie action");return}switch(a8){case"state":a5=a7.state;if(!!a5){a9.call(a6,a5,a4.data(y))}else{au(aP+"Invalid data detected, not saving.")}break;default:break}};aU.getVideoContainer=function(a7){var a5=this,a6=a5.els.containers,a8=a5.els.$videoContainer,a4;if(!a6){a5.els.containers=a6={}}a4=a6[a7];if(!a4){a4=$('<div id="js-vid-'+a7+"-player"+a5.playerId+'" class="av-player-type-holder av-'+a7+'-player-holder"/>');a8.append(a4);a6[a7]=a4}return a4};aU.spacebarToggle=function(a4){if(a4.which===32){a4.preventDefault();this.togglePlay()}};aU.stopSelect=function(a4){if(!$(a4.target).data("enable-select")){o(a4)}return false};aU.adjustWidth=function(){au(aP+"========== BEG ui.adjustWidth ==========");var bd=this,a5=bd.els,a8=a5.$videoPlayerDiv,ba=a5.$videoMaxWidth,a4=a5.$videoContainer,bb=16/9,a9="100%",a7="width",a6,bc;ba.css(a7,a9);a6=a8.height();bc=a4.height();au(aP+"viewport height: ",a6);au(aP+"player height: ",bc);if(a6<bc){a9=bb*a6}au(aP+"adjust max width to: ",a9);au(aP+"maxWidth.css(width): ",ba.css(a7));ba.css(a7,a9);au(aP+"========== END ui.adjustWidth ==========")};aU.autoplay=function(){this.els.$playPauseButtons.first().trigger("click")};aU.setPlayback=function(a5){var bf=this,a8=bf.els,bc=a8.$qualityButtons,be=bf.setControl(a8.$playbackButtons,a5),a7=bf.playbacks[a5],a6,ba,bd,bg,a4=bf.stateJSON.quality,bb=bf.states,a9=false;if(true===be){au(aP+"setPlayback to: ",a5);bf.setStates({playback:a5,playerType:a7.playerType});ba=a7["$qualities"];bd=bc.not(ba);J(bd);ay(ba);a6=a7.qualities;au(aP+"> available qualities for playback: ",a6);au(aP+"> current activeQuality: ",a4);if(!a4||0>$.inArray(a4,a6)){au(aP+"> activeQuality not found for playback");bg=v(ba);a4=bg.data(y);au(aP+"> setting new activeQuality to: ",a4)}if(bb.started){bf.pause();a9=l.setPlayer()}bf.setQuality(a4,true);if(a9&&bb.started){au(aP+"> player has started, play video with new player");bf.play()}}return be};aU.adStart=function(){var a4=this;ae.adStart.call(a4);a4.setVideoProgress("A word from our sponsors...")};aU.contentEnd=function(){var a5=this,a6=a5.states,a4=a6.isLive,a7=Math.floor(a6.currentTime),a8=Math.floor(a6.duration);ae.contentEnd.call(a5);if(!a4&&a7===a8){au(aP+"reset progress width to 0");a5.els.$progress.css("width",0)}};aU.videoProgress=function(bd){var bf=this,a9=bf.states,bj=a9.adPlaying,a8=a9.contentStarted,bi=bf.videoJSON.isLiveStream,bl=aB(0),bk=bl,bc=bl,a4="",bh,be,a7,a6,ba,a5,bb,bg;ae.videoProgress.call(bf,bd);bh=bd.currentTime;be=bd.duration;a7=bd.bytesLoaded||0;a6=bd.bytesTotal||0;ba=a9.isLive;a5=a9.isOffAir;bb=a9.isRewound;if(true===bj){au(aP+"Ad progress");a4=bf.adMessagePrefix+j(be-bh)}else{if(true===a8){a4=j(bh);bk=aB(bh/be);if(0<=a7&&0<a6){bc=aB(a7/a6)}if(!ba){a4+=" / "+j(be)}if(true===bi){if(!ba&&!a5&&!bb){a4="Loading stream data";for(bg=0;bg<=((bh+1)%3);bg++){a4+="."}bk=bl}}}}bf.setVideoProgress(a4,bk,bc)};aU.setVideoProgress=function(a4,a8,a5){var a7=this.els,ba=a7.$timeDisplay,a9=a7.$progress,a6=a7.$loader;if(!!ba){ba.html(a4)}if(!!a8&&!!a9){a9.css("width",a8)}if(!!a5&&!!a6){a6.css("width",a5)}};aU.toggleState=function(a8){var a6=this,a5=false,a4=a6.stateJSON,ba=a6.getStateKey(a8),a7,a9;switch(a8){case"embiggen":a9=a6.setEmbiggen;break;case"mute":a9=a6.setMute;break;case"sticky":a9=a6.setSticky;break}if(!!a9){a7=a4[ba];au(aP+"toggleState stateJSON stateValue: ",a7);if(undefined===a7){a7=true}else{a7=!a7}a5=a9.call(a6,a7);au(aP+"Toggle "+a8+": ",a7)}return a5};var aH="mousemove.seekDisplay",aD="left",aQ="position";var aL=function(a4,a5){var a7,a6=0;a7=a4.offset();a7.right=a7.left+a4.outerWidth();if(a7.left<a5.left){a6=a5.left-a7.left}else{if(a7.right>a5.right){a6=a5.right-a7.right}}return a6};var aT=function(a4,a5){var a7,a6;a4.css("left","-50%");a7=a4.position();a6=aL(a4,a5);if(a6!==0){a4.css(aD,a7.left+a6)}};var aS=function(a6,a7){var bb=a6.data(aQ),a5=a6.data("limitClass"),ba,a9,a8={},a4={};if(undefined===bb){bb=a6.position();bb.width=a6.outerWidth();a6.data(aQ,bb)}a8={left:bb.left,width:bb.width};a6.css(a8);if(!!a5){a6.removeClass(a5)}ba=aL(a6,a7);if(ba>0){a9="left"}else{if(ba<0){a9="right"}}if(ba!==0){a4.width=bb.width-Math.abs(ba);if(ba>0){a4.left=bb.left+ba}a5="limit-"+a9;a6.addClass(a5);a6.data("limitClass",a5);a6.css(a4)}};aU.seekTo=function(){var a5=this,a6=a5.states,a7=a5.seekTime,a4=false;if(true===a6.started&&false===a6.adPlaying){au(aP+"seekTo: ",a7);a4=true;l.seekTo(a7);if(false===a6.playing){au(aP+"not playing, so don't let seekto play");l.pause();a5.videoProgress({currentTime:a7,duration:l.getDuration()})}}return a4};aU.seekToLive=function(){var a5=this,a6=a5.states,a4=false;if(true===a6.started&&false===a6.adPlaying){au(aP+"seekToLive()");a4=true;l.seekToLive();if(false===a6.playing){au(aP+"not playing, so don't let seekToLive play");l.pause();a5.videoProgress({currentTime:l.getDuration(),duration:l.getDuration()})}}return a4};aU.updateSeekDisplay=function(bb,a5){var a6=this,a7=a6.els,a8=a7.$videoPlayerDiv,a9=a7.$seekText,a4=a7.$seekPointer,ba;if(!bb){bb="loading..."}a9.text(bb);a7.$seekDisplay.css(aD,a5);ba=a8.offset();ba.right=ba.left+a8.width();aT(a9,ba);aS(a4,ba)};aU.setSeekDisplay=function(a9){var bc=this,a7=bc.els,bb=a7.$seekText,ba=x(a9,a7.$seeker),a5=l.getDuration(),a8=0,a6=0,a4="";if(undefined===a5){a5=0}if(0<=ba&&0<a5){a8=Math.round(ba*a5);a4=j(a8);a6=aB(a8/a5)}if((a8!==bc.seekTime)||(a4!==bb.text())){bc.seekTime=a8;bc.updateSeekDisplay(a4,a6)}};aU.seekDisplayStart=function(){var a4=this,a5=a4.states;if(true===a5.started&&false===a5.adPlaying){a4.els.$seeker.on(aH,function(a6){a4.setSeekDisplay(a6)})}};aU.seekDisplayStop=function(){this.els.$seeker.off(aH)};aU.toggleShare=function(){var a4=this,a5=!a4.states.share;a4.setStates({share:a5})};var aV="sticky",aJ={zIndex:5000050,noStop:true,unstickyOnAjax:false},a0=function(a5,a7){var a4=a5.$stickyContainer,a6=a5.$videoSpacer;if(true===a7){au(aP+"add sticky");a4.addClass(aV);a6.height(a4.outerHeight(true))}else{au(aP+"remove sticky");a4.removeClass(aV);a6.height("auto")}};aU.setSticky=function(ba){var a6=false,a5=this,a8=a5.els,a7=a8.$stickyContainer,a4=a8.$stickyPinButton,a9=a4.data(y)||false;if(!!a7&&(a9!==ba)){a6=true;if(true===ba){$.sticky(a7,aJ,function(){a0(a8,true)},function(){a0(a8,false)})}else{$.destroySticky(a7);a0(a8,false)}a4.data(y,ba);a5.setStates({stickied:ba})}return a6};aU.toggleSticky=function(){au(aP+"toggle sticky!");var a5=this,a6=aE.$stickyPinButton.cookieType,a7,a4;if(undefined===a6){a7=!a5.els.$stickyPinButton.data(y);a4=a5.setSticky(a7)}else{a4=a5.toggleState("sticky")}return a4};aU.setEmbiggen=function(a7){var bg=false,bf=this,a8=bf.els,bk=a8.$embiggenContainer,bj=a8.$embiggenButton,a6=a8.$embiggenVidSize,be=a8.$kubrickInfo,a9=a8.$kubrickInfoParent,ba=a8.$videoSpacer,bl=bj.data(y)||false,bd=".container",bc='<div class="container"></div>',bi="no-sticky",bh,a5,a4=a6.data("embiggen-class"),bb=a6.data("debiggen-class");if(bl!==a7){bg=true;if(true===a7){a6.removeClass(bb).addClass(a4);bk.addClass("large").removeClass("small medium");if(!!be){be.children().wrap(bc);be.addClass(bi);ba.after(be)}}else{a6.removeClass(a4).addClass(bb);bk.addClass("small").removeClass("medium large");if(!!be){a5=be.find(bd);bh=a5.children();if(a5.length>0){bh.unwrap()}be.removeClass(bi);a9.prepend(be)}}Y().trigger("resize");bj.data(y,a7);bf.setStates({embiggened:a7})}return bg};aU.toggleEmbiggen=function(){au(aP+"toggle embiggen!");return this.toggleState("embiggen")};(function(){var a8="mousemove"+V,ba="mouseleave"+V,a6=null,a5=1500,a4=null,a7=null;var a9=function(bb){if(bb.clientX===a4&&bb.clientY===a7){return false}a4=bb.clientX;a7=bb.clientY;return true};aU.toggleStowControls=function(bc){var bb=this;if(null!==a6){clearTimeout(a6);a6=null}if(bb.states.stowControls!==bc){bb.setStates({stowControls:bc})}};aU.cancelStowControls=function(){this.toggleStowControls(false)};aU.delayStowControls=function(){var bb=this;bb.cancelStowControls();a6=setTimeout(function(){bb.toggleStowControls(true)},a5)};aU.setStowControls=function(bd){var bb=this,bc=bb.els.$videoPlayerDiv;au(aP+"===== setStowControls: ",bd);bb.cancelStowControls();if(true===bd){bc.on(a8,function(be){if(a9(be)){bb.delayStowControls()}});bc.on(ba,function(){bb.toggleStowControls(true)})}else{bb.toggleStowControls(false);a4=null;a7=null;bc.off(a8);bc.off(ba)}}})();var aG="body-fullscreen",aN="body-fauxscreen",aI="keyup"+V,aZ=27;aU.isFullscreen=function(){var a4=this,a5=a4.states;return(true===a5.windowed||true===a5.fullscreen)};aU.exitFullscreen=function(){var a4=this,a5=m();if(a4.isFullscreen()){au(aP+"exit full screen");a5.off(aI);a4.setStowControls(false);a4.setFullscreen(false);a4.setWindowed(false)}};aU.enterFullscreen=function(a7){var a5=this,a6=m(),a4=function(a8){au(aP+"exit fullscreen callback");if(a8.keyCode===aZ){a5.exitFullscreen()}};if(false===a5.isFullscreen()){a5.setStowControls(true);switch(a7){case"fullscreen":a5.setFullscreen(true);break;case"windowed":au(aP+"attach esc from fullscreen event listener");a6.on(aI,a4);a5.setWindowed(true);break}}};aU.setFullscreen=function(ba){var a5=false,a4=this,a7=a4.els.$videoPlayerDiv[0],a6=a4.states.fullscreen||false,a9=G(),a8=function(){au(aP+"[FULLSCREEN CHANGE HANDLER]");if(false===screenfull.isFullscreen){au(aP+"screenfull.isFullscreen is false, exit");a4.exitFullscreen(false);screenfull.onchange=function(){};au(aP+"[FULLSCREEN EXIT] adjustWidth");a4.adjustWidth()}};au(aP+"ui.setFullscreen newState: ",ba);au(aP+"- documentContentRoots: ",a9);if(!screenfull){return a4.setWindowed(ba,true)}if(a6!==ba){a5=true;a4.setWindowed(false);if(true===ba){screenfull.onchange=a8;screenfull.request(a7);a9.addClass(aG)}else{a9.removeClass(aG);screenfull.exit()}a4.setStates({fullscreen:ba})}return a5};aU.setWindowed=function(a8,a9){var a5=false,a4=this,a6=a4.states.windowed||false,a7=G();if(a6!==a8){a5=true;if(!!screenfull){a4.setFullscreen(false)}if(true===a8){a7.addClass(aN)}else{a7.removeClass(aN)}if(!a9){au(aP+"ui.setWindowed adjustWidth");a4.adjustWidth()}a4.setStates({windowed:a8})}return a5};aU.toggleFullscreen=function(){var a4=this;if(true===a4.isFullscreen()){a4.exitFullscreen()}else{a4.enterFullscreen("fullscreen")}};aU.toggleWindowed=function(){var a4=this,a5=!a4.states.windowed;if(true===a5){a4.enterFullscreen("windowed")}else{a4.exitFullscreen()}};var aF="mouseleave.volumeSlide",aC="mousemove.volumeSlide";aU.setVolume=function(a4){var a5=this,a7=a5.els,a6=a7.$volumeHandle;au(aP+"setVolume: ",a4);au(aP+"states: ",a5.states);a5.moveVolumeHandle(a4);a6.data(y,a4);if(0>=a4){a5.setMute(true)}else{if(true===a5.states.mute){au(aP+"setVolume states muted > unmute");a5.setMute(false)}}a5.saveState("volume",a4);a5.setStates({volume:a4});l.changePlayerState(a5);if(true===a5.states.playing){l.setVolume(a4)}};aU.setMute=function(ba){var a5=false,a4=this,a8=a4.els,bb=a8.$muteButton,a7=a8.$volumeHandle,a9=bb.data(y)||false,a6=a7.data(y);if(a9!==ba){a5=true;au(aP+"setMute > hasChange!");if(true===ba){a6=0}else{if(a6===0||a6==="0.00"){au(aP+"setMute > volume is 0, do not unmute");return}}a4.moveVolumeHandle(a6);bb.data(y,ba);a4.setStates({mute:ba});a4.saveState("mute",ba);if(true===a4.states.playing){if(true===ba){l.mute()}else{l.unmute()}}}return a5};aU.toggleMute=function(){au(aP+"toggle mute!");return this.toggleState("mute")};aU.moveVolumeHandle=function(a4){a4=(Math.round(a4*100)).toString()+"%";this.els.$volumeHandle.css("left",a4)};aU.volumeChange=function(a7){var a5=this,a6=a5.els.$volumeBar,a4=x(a7,a6);a5.setVolume(a4.toFixed(2))};aU.volumeSlideStart=function(){var a4=this,a5=a4.els;a5.$volume.on(aF,function(){a4.volumeSlideStop()});a5.$volumeBar.on(aC,function(a6){a4.volumeChange(a6)})};aU.volumeSlideStop=function(){var a4=this.els;a4.$volume.off(aF);a4.$volumeBar.off(aC)};var aR=["sticky","embiggen"];var a1="frontdoor",aX="frontDoor";var aW=function(a4,a5){return a4+a5.slice(0,1).toUpperCase()+a5.slice(1)};aU.getStateKey=function(a4){if((0<=$.inArray(a4,aR))&&(true===aO())){a4=aW(a1,a4)}return a4};var aM=function(a8,a6){var a7=a6[a8],a5=false,a4=false;au(aP+"[CHECK SAVED STATE] "+a8+" is "+a7);if(undefined!==a7&&("sticky"===a8||0<a8.indexOf("Sticky"))){a4=(aE.$stickyPinButton.cookieType!==undefined);if(!a4){a7=""}}if(0===a8.indexOf(aX)){delete a6[a8];a8=a8.replace(aX,a1)}if(""===a7){delete a6[a8];a7=undefined;a5=true}else{if(!(undefined===a7||true===a7)){a7=true;a5=true}}if(true===a5&&undefined!==a7){a6[a8]=a7}if(a5){au(aP+"[CORRECTED STATE] "+a8+" as "+a7)}return a5};var aY=function(a5){var a4=false;au(aP+"[CHECK SAVE STATES] original states: \n"+M(a5));au(aP+"states to check: ",aR);$.each(aR,function(a6,a7){a4=aM(a7,a5)||a4;a4=aM(aW(aX,a7),a5)||a4;a4=aM(aW(a1,a7),a5)||a4});au(aP+"[CHECK SAVE STATES] corrected states: \n"+M(a5));au(aP+" hasInvalidSavedStates: ",a4);return a4};var aK=function(a5){var a4=M(a5);au(aP+"Save state cookie value: "+a4);$.cookie(a2,a4,{path:"/",expires:30})};aU.loadSavedState=function(){var bd=this,a8=$.cookie(a2),a6,a4,a5,a7=null,ba,bc,bb,a9;if(a8){a6=$.parseJSON(a8)}if(undefined===a6){return}a9=aY(a6);if(a9){aK(a6);a9=false}a4=a6.playback;if(!!a4){a5=bd.playbacks[a4]||{};a7=!!a5.isAvailable;if(a7){bb=a5.qualities}}bc=a6.quality;if(undefined===bb){ba=v(bd.els.$playbackButtons);a4=ba.data(y);a5=bd.playbacks[a4];bb=a5.qualities;if(!!a6.playback){if(null===a7){a9=true;delete a6.playback}}}if(!!bc&&(0>$.inArray(bc,bb))){a9=true;delete a6.quality}if(a9){aK(a6)}bd.stateJSON=$.extend({},a6);au(aP+"[LOADED SAVED STATES]:",a6)};aU.saveState=function(a6,a7){var a5=this,a8=a5.getStateKey(a6),a4=a5.stateJSON;if(!a7){au(aP+"Delete state for: "+a8);delete a4[a8]}else{a4[a8]=a7}aK(a4)};aU.loadPosition=function(){};aU.savePosition=function(){};return aU})();var s=function(){var aE=$(this),aF=aE.data("id"),aD,aH,aC,aG;if(!aF){return}aD=av(aE);au(aD);if(undefined===aD){au("error","Video JSON missing for: ",aE);return}if(true===aD.isDevice){aH=O}else{aH=ad}aC={playerId:aF,videoJSON:aD,els:{$videoPlayerDiv:aE}};aG=$.extend({},aH);aG.initialize(aC);p[aF]=aG};var n=function(){var aD=$(".js-video-player"),aC;if(!!aD.data("debug")){ah()}au("Initializing metis version: ",ak.version);w(aD);ax(aD);u(aD);aC=aD.find(".js-vid-invalid-reqs");if(!((true===E())||(true===ar()))){aD.addClass(K+" has-vid-invalid-reqs");aD.find(".js-vid-player-chrome").remove()}else{aD.each(s);aC.remove()}};var a=false;var af=false;var i=false;$(document).on("ads_initialized",function(){a=true;if(a&&af&&!i){n();i=true}});$(document).on("tracking_initialized",function(){af=true;if(a&&af&&!i){n();i=true}});$(window).on("load",function(){if(!i){n();i=true}})})(this);
(function(){window.PhoenixDatePicker={initializeDatePickers:function(){$(".datepicker-input").each(function(){var c=$(this);if(c.data("initialized")){return}var e=false;var d=c.val();if(d){e=true}c.datepicker().on("changeDate",function(){$(this).datepicker("hide")}).on("show",function(){if(e){return}e=true;c.datepicker("setValue",new Date())});c.data("initialized",true)});$(".timepicker").each(function(){var c=$(this);if(c.data("initialized")){return}c.timepicker({step:15,timeFormat:"H:i"});c.data("initialized",true)});$(".datetime-now-button").click(function(g){g.preventDefault();var h=$(this);var f=h.parent().find(".datepicker-input");var e=h.parent().find(".timepicker");var d=new Date();var c=a(d);var i=b(d);f.attr("value",c);e.attr("value",i)})}};$(document).ready(function(){PhoenixDatePicker.initializeDatePickers();$(document).ajaxStop(PhoenixDatePicker.initializeDatePickers())});function a(f){var e=f.getMonth()+1;var c=f.getDate();var d=f.getFullYear();return e+"/"+c+"/"+d}function b(e){var c=e.getHours();var d=e.getMinutes();if(d<10){d="0"+d}return c+":"+d}}());
$(document).ready(function(){var a=function(d){var c=d.children("i.icon");var e=d.attr("data-toggle-value");d.attr("data-toggle-value",d.text());d.text(e);d.prepend(c)};var b=function(){$(".btn-toggle").each(function(){var c=$(this);if(c.data("btn-toggle-initialized")){return}c.on("click",function(f){if($(this).is("a")===true&&$(this).attr("href")!==""){var e=$(this);if(e.hasClass("super-action")){e.siblings(".super-action").toggleClass("active",false);e.siblings(".sub-action:not('."+e.attr("rel")+"')").toggleClass("hide",true);e.toggleClass("active");e.siblings("."+e.attr("rel")).toggleClass("hide");return false}else{if(e.hasClass("has-input")&&e.attr("rel").length&&e.siblings(":input[name='"+e.attr("rel")+"']").val().length){e.attr("href",jQuery.param.querystring(e.attr("href"),"reason="+encodeURIComponent(e.siblings(":input[name='"+e.attr("rel")+"']").val())))}else{if(e.parents(".sub-action").find("a:contains('Flagged')").length>0){return false}}}var d=e.attr("data-verify-statement");if(typeof(d)!="undefined"&&d){if(!confirm(d)){return(false)}}AjaxApiRequest.makeApiRequest($(this).attr("href"),null,false,function(h){if(h.hasOwnProperty("redirect")){Phoenix.Ui.showErrorMessage(h.error);window.location.href=h.redirect+"?redirect_url="+document.URL}else{var g=h.message||"Setting saved.";Phoenix.Ui.showSuccessMessage(g);a(e)}},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});f.preventDefault()}});c.data("btn-toggle-initialized",true)})};b();$(document).ajaxStop(function(){b()})});
$(document).ready(function(){$(".board-selector a").on("click",function(){var b=$(this);var d=b.parent().parent();var a=d.parent();var c=a.find(".board-autocomplete-li");d.addClass("hide");d.find(":input").attr("disabled","disabled");if(d.hasClass("board-main-li")){c.removeClass("hide");c.find(":input").removeAttr("disabled")}else{c=a.find(".board-main-li");c.removeClass("hide");c.find(":input").removeAttr("disabled")}return false})});
$(document).ready(function(){$(".btn-ban").on("click",function(){if($(this).is("a")===true&&$(this).attr("href")!==""){var a=$(this);AjaxApiRequest.makeGetApiRequest(a.attr("href"),function(){a.addClass("active");var b=a.closest(".btn-group");b.children(".btn-unban").first().removeClass("hide");b.children(".btn-ban-parent").first().addClass("hide");Phoenix.Ui.showSuccessMessage("User banned");a.parents(".js-avatar-user").first().addClass("banned")},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}});$(".btn-unban").on("click",function(){if($(this).is("a")===true&&$(this).attr("href")!==""){var a=$(this);AjaxApiRequest.makeGetApiRequest(a.attr("href"),function(){a.addClass("hide");a.next(".btn-ban-parent").removeClass("hide");Phoenix.Ui.showSuccessMessage("User unbanned");a.parents(".js-avatar-user").first().removeClass("banned")},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}});$(".js-ban-widget .btn-ban, .js-ban-widget .btn-unban").on("click",function(){var a=$(this);AjaxApiRequest.makeGetApiRequest(a.attr("href"),function(){if(a.hasClass("btn-unban")){Phoenix.Ui.showSuccessMessage("User unbanned")}else{Phoenix.Ui.showSuccessMessage("User banned")}},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false});$(".js-ban-time-widget button").on("click",function(e){var g=$.trim($(".js-ban-widget input").val());if(!g){Phoenix.Ui.showErrorMessage("Must enter ban value.")}else{var f=g.split(" ");var c=0;var d=false;$.each(f,function(){var i=this;if(i.length>1){var h=i[i.length-1];var j=parseInt(i.slice(0,i.length-1),10);if(isNaN(j)){Phoenix.Ui.showErrorMessage("Format string weird, should be like 1w 2d 3h");d=true;return false}switch(h){case"mo":c=c+(j*44640);break;case"w":c=c+(j*10080);break;case"d":c=c+(j*1440);break;case"h":c=c+(j*60);break;case"m":c=c+(j*1);break;default:Phoenix.Ui.showErrorMessage("Format string weird, should be like 1w 2d 3h");d=true;return false}}});var b=$(this);if(!d&&c!==0){var a=b.attr("href");a=a.replace("REPLACEME",c);AjaxApiRequest.makeGetApiRequest(a,function(){Phoenix.Ui.showSuccessMessage("User banned for "+g)},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")})}}e.preventDefault();e.preventPropagation()});$(".btn-nuke").on("click",function(){var a=window.confirm("With great power comes great responsibility.  This will ban the user and delete all their messages and topics.  Are you sure you want to nuke this user?");if(a){var c=window.confirm("Are you really sure?  Also, this process will take a while (Up to 2 minutes).  Just sit and wait after clicking for the status message bar to appear.");if(!c){return false}}else{return false}if($(this).is("a,button")===true&&$(this).attr("href")!==""){var b=$(this);$.get(b.attr("href"),function(){b.addClass("active");var d=b.closest(".btn-group");d.children(".btn-unban").first().removeClass("hide");d.children(".btn-ban-parent").first().addClass("hide");Phoenix.Ui.showSuccessMessage("User nuked!");b.parents(".js-avatar-user").first().addClass("banned")}).error(function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}})});
$(document).ready(function(){var a=$(".editor > textarea");$(document).on("submit","form",function(){window.onbeforeunload=null});window.onbeforeunload=function(){if($.fn.richTextEditor!==undefined&&a.richTextEditor("isDirty")){return"You have unsaved content in the text editor. Are you sure you wish to leave?"}}});
$(document).ready(function(){var b=false;var c=false;var a=0;$(document).on("click",".js-simple-paginator a",function(i){i.preventDefault();var g=$(this).parents(".js-simple-paginator").data("warning");if(g){$(this).data("warning","");if(!confirm(g)){return}}var j=$(this);var h=j.parents(".js-simple-paginator-container").first();if(h.attr("data-paginator-number")===null){h.attr("data-paginator-number",a);a=a+1}var f=h.attr("data-paginator-number");if(!b&&window.history.pushState){window.history.replaceState({name:"SimplePaginate",url:location.href},"",location.href);b=true}var e=j.attr("href");d(j,e);if(window.history.pushState){window.history.pushState({name:"SimplePaginate",href:e},"",e);c=true}});var d=function(g,e){var f=$('<div class="loading"></div>');g.parents(".js-simple-paginator-container").children().addClass("hide");g.parents(".js-simple-paginator-container").append(f);AjaxApiRequest.makeGetApiRequest(e,function(h){var i=g.parents(".js-simple-paginator-container").first();f.remove();i.html(h.html)})};if(window.history.pushState){$(window).on("popstate","",function(e){if(!c){return}var f=e.originalEvent.state;if(f&&f.name==="SimplePaginate"){console.log("popping");console.log('.js-simple-paginator a[href="'+f.url+'"]');console.log(f.url);d($('.js-simple-paginator a[href="'+f.url+'"]'),f.url)}})}});
$(document).ready(function(){$(document).on("click",".js-slider a.js-slide-button",function(b){b.preventDefault();var c=$(this);var a=c.attr("href");var d=$('<div class="loading"></div>');c.parents(".js-slider").children().addClass("hide");c.parents(".js-slider").append(d);AjaxApiRequest.makeGetApiRequest(a,function(e){var f=c.parents(".js-slider").first();d.remove();f.html(e.html)})})});
$(document).ready(function(){$(document).on("click",".js-expand",function(a){a.preventDefault();$(this).siblings(".show-less").removeClass("show-less").addClass("show-more");$(this).addClass("hide")})});
$(document).ready(function(){$(document).on("click",".js-unhide-lis",function(b){b.preventDefault();var c=$(this).parents("ul").first();var a=c.find("li.hide");a.removeClass("hide");$(this).addClass("hide")});$(document).on("click",".js-replace-list",function(c){c.preventDefault();var d=$(this).parents("ul").first();var a=d.find("li:not(.hide)");var b=d.find("li.hide");b.removeClass("hide");a.addClass("hide");$(this).addClass("hide")})});
$(document).ready(function(){var a=$("body");$("#js-btn-mobile-nav").click(function(c){if(a.hasClass("mobile-slide-search")){a.removeClass("mobile-slide-search");a.addClass("mobile-slide-nav")}else{if(a.hasClass("mobile-slide")){a.removeClass("mobile-slide");a.removeClass("mobile-slide-nav");a.removeClass("mobile-slide-search")}else{if(a.hasClass("mobile-nav-user")){a.removeClass("mobile-nav-user");a.addClass("mobile-slide");a.addClass("mobile-slide-nav")}else{a.addClass("mobile-slide");a.addClass("mobile-slide-nav")}}}c.preventDefault()});$("#js-btn-mobile-search").click(function(c){if(a.hasClass("mobile-slide-nav")){a.removeClass("mobile-slide-nav");a.addClass("mobile-slide-search")}else{if(a.hasClass("mobile-slide")){a.removeClass("mobile-slide");a.removeClass("mobile-slide-nav");a.removeClass("mobile-slide-search")}else{a.addClass("mobile-slide");a.addClass("mobile-slide-search")}}c.preventDefault()});$("#js-btn-mobile-user").click(function(d){if(a.hasClass("mobile-slide-nav")){a.removeClass("mobile-slide");a.removeClass("mobile-slide-nav")}a.toggleClass("mobile-nav-user");var c=$(".masthead-userBox");c.toggleClass("show")});$(".js-dropnav-toggle").click(function(d){$(this).toggleClass("is-active");var c=$(this).siblings("ul");c.toggleClass("show")});$(".js-sidenav-toggle").click(function(){$(this).toggleClass("is-active");var c=$(this).siblings("ul");c.toggleClass("show")});$("#nav-main .dropdown-toggle").click(function(){$("html, body").animate({scrollTop:$(this).offset().top},300)});var b=$('meta[itemprop="deviceType"]').attr("content");if(b!="phone"){$("ul.masthead-userBox li.dropnav",".masthead-container").click(function(c){if($(".dropnav-menu",this).is(":visible")){return $(this)}c.preventDefault();$("li","nav.masthead-nav").removeClass("hover");$("ul.masthead-userBox li .dropnav-menu",".masthead-container").hide();$(".dropnav-menu",this).toggle();return false});$("li:has(ul)","nav.masthead-nav").doubleTapToGo();$("li.dropnav-submenu__item","nav.masthead-nav").click(function(){window.location.href=$(this).children("a").attr("href")})}});(function(c,b,a,d){c.fn.doubleTapToGo=function(e){if(!("ontouchstart" in b)&&!navigator.msMaxTouchPoints&&!navigator.userAgent.toLowerCase().match(/windows phone os 7/i)){return false}this.each(function(){var f=false;c(this).unbind("mouseover mouseout");c(this).on("click",function(h){h.stopPropagation();h.preventDefault();var g=c(this);var i=c(h.target);c("ul.masthead-userBox li .dropnav-menu",".masthead-container").hide();if(g[0]!=f[0]){g.siblings("li").removeClass("dropnav-menu__active");if(g.hasClass("dropnav-menu__item")){g.addClass("dropnav-menu__active")}else{g.siblings("li").removeClass("hover");g.addClass("hover")}f=g;return false}else{f=false;if(i&&i.attr("href")&&i.attr("href").length){b.location.href=i.attr("href")}else{return i}return false}});c(a).on("click touchstart MSPointerDown",function(k){var j=true,h=c(k.target).parents();for(var g=0;g<h.length;g++){if(h[g]==f[0]){j=false}}if(j){f=false}})});return this}})(jQuery,window,document);
$(document).ready(function(){$(".js-ajax-button-loader").on("click",function(b){b.preventDefault();var c=$(this);var a=c.data("ajax-href");var e=$('<div class="loading"></div>');var d=c.data("show-hide-button");if(d==="yes"){c.text("Hide")}else{c.hide()}c.parent().append(e);AjaxApiRequest.makeApiRequest(a,null,false,function(h){var g=c.parent();if(d==="yes"){c.show();var i=$("<div></div>").html(h.html);i.addClass(c.data("show-hide-container-class"));g.append(i);c.text("Hide");var f=false;e.remove();c.unbind();c.click(function(j){if(f){i.show();c.text("Hide");f=false}else{i.hide();c.text("Show");f=true}j.stopPropagation();j.preventDefault()})}else{g.html(h.html)}})})});
$(function(){var a=$("#notification-checkboxes");a.on("change","select",function(){var b=$(this);b.parent().find('[type="hidden"]').val(b.val())}).on("change","input.checkbox",function(){var b=$(this);if(b.prop("checked")){b.parent().find('[type="hidden"]').val(b.prop("checked")?"1":"0")}else{b.parent().find('[type="hidden"]').val("").removeAttr("value")}}).on("mouseenter",".js-help-hover-over",function(){$(this).parent().parent().find(".js-explanation").removeClass("hide")}).on("mouseleave",".js-help-hover-over",function(){$(this).parent().parent().find(".js-explanation").addClass("hide")});a.find("select").each(function(){var c=$(this);var b='option[value="'+c.parent().find('[type="hidden"]:first').val()+'"]';c.find("option").prop("selected",false);c.find(b).prop("selected",true)});a.find("input.checkbox").each(function(){var c=$(this);var b=parseInt(c.parent().find('[type="hidden"]:first').val(),10)===1;c.prop("checked",b)})});
$(document).ready(function(){var c=$(window),g=$("body"),e=$("#masthead"),f=5,h=0,j=false,d,b;c.on("scroll",function(){if(!j){j=true;setTimeout(a,50)}});function a(){clearTimeout(b);d=i();if(d>=f){g[0].classList.add("has-scrolled")}else{g[0].classList.remove("has-scrolled")}j=false;if(!g[0].classList.contains("disable-hover")){g[0].classList.add("disable-hover")}b=setTimeout(function(){g[0].classList.remove("disable-hover")},500)}function i(){return window.pageYOffset||c.scrollTop()}});
$(document).ready(function(){var f=false;var e=$("li.js-notification");var c=null;var d=function(j,i,k,l){return function(){if(f){return}var m=this;f=true;var o=$(i);var n=o.parent().find(".loading");if(n.length===0){n=$('<div class="loading"></div>')}$(m).find(k).remove();o.after(n);c=$.get(j,function(r,s,q){if(!r.success){return}var p=r.messages;o.after(p);c=q;if(typeof l==="function"){l($(m).find(k))}}).fail(function(p,r,q){c=p;f=false;if(r==="abort"||p.readyState===0){return}Phoenix.Ui.showErrorMessage("There was a problem displaying recent messages, try again later.")}).done(function(p,r,q){c=q;f=false;o.parent().find(".loading").remove()})}};$("li.pm").mouseenter(function(i){d("/pm/unread/",".js-unread-messages",".js-inbox-message").call(this)}).mouseleave(function(){if(c&&typeof c.abort==="function"){c.abort()}});e.mouseenter(function(i){$(this).find(".js-notification-show-more").remove();d("/notifications/unread/",".js-unread-notifications",".js-notification-message",function(j){e.children("a:first .bubble-count").text("0");setTimeout(function(){j.each(function(){$(this).removeClass("unread").addClass("read")})},5000)}).call(this,i)}).mouseleave(function(){if(c&&typeof c.abort==="function"){c.abort()}});var h=$(this);var a=60000;var g=600000;var b});
(function(g,h,m){var f="object",b=true;function l(o,n){var e=(o[0]||0)-(n[0]||0);return e>0||(!e&&o.length>0&&l(o.slice(1),n.slice(1)))}function c(o){if(typeof o!=f){return o}var e=[],p="";for(var n in o){if(typeof o[n]==f){p=c(o[n])}else{p=[n,(b)?encodeURI(o[n]):o[n]].join("=")}e.push(p)}return e.join("&")}function d(o){var e=[];for(var n in o){if(o[n]){e.push([n,'="',o[n],'"'].join(""))}}return e.join(" ")}function k(o){var e=[];for(var n in o){e.push(['<param name="',n,'" value="',c(o[n]),'" />'].join(""))}return e.join("")}var j;try{j=m.description||(function(){return(new m("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}())}catch(i){j="Unavailable"}var a=j.match(/\d+/g)||[0];g[h]={available:a[0]>0,activeX:m&&!m.name,version:{original:j,array:a,string:a.join("."),major:parseInt(a[0],10)||0,minor:parseInt(a[1],10)||0,release:parseInt(a[2],10)||0},hasVersion:function(n){var e=(/string|number/.test(typeof n))?n.toString().split("."):(/object/.test(typeof n))?[n.major,n.minor]:n||[0,0];return l(a,e)},encodeParams:true,expressInstall:"expressInstall.swf",expressInstallIsActive:false,create:function(o){var e=this;if(!o.swf||e.expressInstallIsActive||(!e.available&&!o.hasVersionFail)){return false}if(!e.hasVersion(o.hasVersion||1)){e.expressInstallIsActive=true;if(typeof o.hasVersionFail=="function"){if(!o.hasVersionFail.apply(o)){return false}}o={swf:o.expressInstall||e.expressInstall,height:137,width:214,flashvars:{MMredirectURL:location.href,MMplayerType:(e.activeX)?"ActiveX":"PlugIn",MMdoctitle:document.title.slice(0,47)+" - Flash Player Installation"}}}attrs={data:o.swf,type:"application/x-shockwave-flash",id:o.id||"flash_"+Math.floor(Math.random()*999999999),width:o.width||320,height:o.height||180,style:o.style||""};b=typeof o.useEncode!=="undefined"?o.useEncode:e.encodeParams;o.movie=o.swf;o.wmode=o.wmode||"opaque";delete o.fallback;delete o.hasVersion;delete o.hasVersionFail;delete o.height;delete o.id;delete o.swf;delete o.useEncode;delete o.width;var n=document.createElement("div");n.innerHTML=["<object ",d(attrs),">",k(o),"</object>"].join("");return n.firstChild}};g.fn[h]=function(e){var n=this.find(f).andSelf().filter(f);if(/string|object/.test(typeof e)){this.each(function(){var p=g(this),o;e=(typeof e==f)?e:{swf:e};e.fallback=this;o=g[h].create(e);if(o){p.children().remove();p.html(o)}})}if(typeof e=="function"){n.each(function(){var o=this,p="jsInteractionTimeoutMs";o[p]=o[p]||0;if(o[p]<660){if(o.clientWidth||o.clientHeight){e.call(o)}else{setTimeout(function(){g(o)[h](e)},o[p]+66)}}})}return n}}(jQuery,"flash",navigator.plugins["Shockwave Flash"]||window.ActiveXObject));
$(document).ready(function(){$(document).on("click",".js-table-paginator a",function(c){c.preventDefault();var d=$(this);var a=d.attr("href");var b=$('<div class="loading"></div>');var e=d.parents(".js-table-pagintor-table");e.hide();e.after(b);$.ajax({url:a,type:"GET",dataType:"html",success:function(f){e.html(f);b.remove();e.show();$("html, body").animate({scrollTop:e.offset().top},300)},complete:function(){b.remove();e.show()}})})});
Phoenix.jQuery.getDocument().ready(function(){if(!window.history.pushState){return}var i=["Refreshing results...","Working...","We'll be right back...","Contemplate your naval for a bit while we work this out...","Do your chair exercises while we grab your stuff...","Don't go away! It's coming...","A GameSpot slave is toiling away finding your stuff. Be cool...","You kids and your instant gratification culture! Chill...","Scouring our internets to find your stuff. Hang tight...","You have encountered a level 3 ogre. Play with him for a bit...","Of course the stuff you want is on the server in the basement. Hang on...","Look at you! All getting fancy with sorting! BRB...","Relax, the sorting elves are working...","Hang on while we remember the order of the alphabet...","Why u make us work so hard?","What is this? Burger King&reg;? Are we supposed to do it Your Way&reg;?","I like turtles...","Usermon uses Sort. It was very effective...","Hey! That tickles!","Settle down Beavis..."];var n=location.href;var a=false;var d;var c=$('meta[name="js-sort-filter-text"]').attr("content");var g=function(){var p=Phoenix.getDocument();p.trigger("pre_page_event",["pageLoad"]);p.trigger("update_page_event",["pageLoad"]);p.trigger("on_page_event",["pageLoad"])};var m=function(p){if(window.history.pushState&&pushState){window.history.pushState({name:"FilterSort",url:p},"",p);d=true}};var o=function(p){if(!a){if(window.history.replaceState&&replaceState){window.history.replaceState({name:"FilterSort",url:p},"",p);a=true;d=true}}};function l(q,p){p=typeof p==="undefined"?true:p;var s=$("#js-sort-filter-results");if(!s[0]||!window.history.pushState){window.location=q;return}var r=i[k(0,i.length-1)];if(c==="no"){r="Refreshing results..."}s.html("<div class='loading'>"+r+"</div>").load(q+" #js-sort-filter-results > *",function(){m(q);g()})}function f(q,p){p=typeof p==="undefined"?true:p;var s=$("#js-sort-filter-results");if(!s[0]||!window.history.pushState){window.location=q;return}var r=i[k(0,i.length-1)];if(c==="no"){r="Refreshing results..."}s.addClass("loading-overlay").load(q+" #js-sort-filter-results > *",function(){if(window.history.pushState&&p){window.history.pushState({name:"FilterSort",url:q},"",q);d=true;s.removeClass("loading-overlay")}Phoenix.getDocument().trigger("pre_page_event",["pageLoad"]);Phoenix.getDocument().trigger("update_page_event",["pageLoad"]);Phoenix.getDocument().trigger("on_page_event",["pageLoad"])})}$(window).on("popstate",function(p){if(!d){return}var q=p.originalEvent.state;if(q&&q.name==="FilterSort"){l(q.url,false)}});var j=$("select.js-filter");j.on("change",function(){if(!a){window.history.pushState({name:"FilterSort",url:n},"",n);a=true;d=true}var s=$(this);var q=s.children(":selected").val();var t=s.attr("data-filter-query");var r=new UrlMaster();if(q=="0"||q==""){r.removeParam(t)}else{r.addParam(t,q)}var p=r.generateUrl();l(p)});var e=$(".js-filter-special");e.on("click","thead a",function(q){q.preventDefault();q.stopPropagation();if(!a){window.history.pushState({name:"FilterSort",url:n},"",n);a=true;d=true}var p=$(this).attr("href");f(p)});function b(p,q){var r=$(this);var t=r.attr("data-filter-query");var s=Phoenix.Request.get(t);if(s){r.find('option[value="'+decodeURIComponent(s)+'"]').attr("selected","selected")}}j.each(b);$("select.js-filter-passive").each(b);$(".js-filter-text").each(function(p,r){var q=$(this);var t=q.attr("data-filter-query");var s=Phoenix.Request.get(t);if(s){q.val(decodeURIComponent(s))}});$(".js-filter-activate").click(function(){var s=$(this);var q=s.attr("data-filters").split(",");var r=new UrlMaster();$.each(q,function(u,w){var t=$("[data-filter-query="+w.trim()+"]");var x=t.attr("data-filter-query");var v=t.val();if(v=="0"||v==""){r.removeParam(x)}else{r.addParam(x,v)}});var p=r.generateUrl();l(p)});$(".js-filter-clear-filters").click(function(){var s=$(this);var q=s.attr("data-filters").split(",");var r=new UrlMaster();$.each(q,function(u,v){var t=$("[data-filter-query="+v.trim()+"]");var w=t.attr("data-filter-query");r.removeParam(w);if(t.hasClass("js-filter-text")){t.val("")}else{t.val(0)}});var p=r.generateUrl();l(p)});var h=$(".js-sort");h.on("change",function(){o(n);var s=$(this);var r=s.children(":selected");var q=r.attr("data-sort-param");var t=r.attr("data-sort-direction");if(!q||!t){return}var p=$.param.querystring(location.pathname+location.search,"sort="+q+"&direction="+t);l(p)});h.each(function(p,r){var s=$(this);var q=Phoenix.Request.get("sort");var t=Phoenix.Request.get("direction");if(q&&t){s.find('option[data-sort-param="'+q+'"][data-sort-direction="'+t+'"]').attr("selected","selected")}});$(document).on("click",".js-order-buttons a",function(q){o(n);q.preventDefault();q.stopPropagation();var r=$(this);var t=r.data("orderby");var s=r.data("direction");if(!t||!s){return}var p=$.param.querystring(location.pathname+location.search,"orderby="+t+"&direction="+s);l(p)});$(".js-filter").find(".filter-list__label").click(function(){$(this).closest(".filter-list__item").toggleClass("js-active")});function k(q,p){return Math.floor(Math.random()*(1+p-q))+q}(function(){var H={};var t=0;var w="filter-url";var p="filter-cache-key";var A="is-loading-filter";var B="on";var K=".js-filter-json";var r="option, .js-filter-option";var u=".on, :selected";var F=function(L,M){switch(M){case"abort":break;case"timeout":break;default:break}};var D=function(N,M){var L=N.$results,O=E(N);L.contents().detach();L.html(M.html);L.data(p,O);y(N)};var s=function(L){return L.slice(0,1)};var J=function(M){var L=M.$pod,N=M.requestSettings;if(N){return N}N={dataType:"json",beforeSend:function(){L.addClass(A)},error:[function(O,P){F(M,P)}],success:[function(O){D(M,O)}]};N.complete=[function(O,P){L.removeClass(A);N.complete=s(N.complete);N.error=s(N.error);N.success=s(N.success)}];M.requestSettings=N;return N};var C=function(U){var Q=U.$filter,S=U.$selected,T=U.noData,O=U.noHistory,R=U.filterKey,L=U.filterValue,P,M,N=J(U);P=S.data(w);if(!P){P=Q.data(w)}if(!P){P=location.href}if(!O){o(n);N.success.push(function(){m(P)})}N.url=P;if(!T&&R&&L){M={};M[R]=L;N.data=M}return N};var E=function(L){return L.filterKey+"_"+L.filterValue};var y=function(N){var M=N.$results,L=N.cache,O=M.data(p),P=M.contents();if(!O){O=E(N);M.data(p,O)}L[O]=P;return L};var q=function(L,M){return L[M]};var z=function(N){var M=N.$results,L=M.contents(),P=M.data(p),O=q(N.cache,P);if(O&&L.is(O)){return false}return true};var I=function(N){var P=E(N),Q,L=N.$request,O=q(N.cache,P),M;if(L){L.abort();N.$request=null}if(O){M=N.$results;M.contents().detach();M.append(O);M.data(p,P)}else{Q=C(N);N.$request=$.ajax(Q)}};var x=function(Q){var N,M,O,R,T,P,U,S,L;N=Q.closest(".js-filter-pod");if(N&&N.length>0){M=N.find(".js-filter-results")}else{N=false}O=Q.find(r);if(!N||!(M&&M.length>0)||!(O&&O.length>0)){return false}U=Q.data();R=O.filter(u);if(!R||R.length===0){R=O.first()}S=U.filterQuery;L=R.val()||R.data("filter-value");P=t+=1;T={$filter:Q,$options:O,$pod:N,$results:M,$request:null,$selected:R,cache:{},filterKey:S,filterValue:L,noData:!!U.filterNodata,noHistory:!!U.filterNohistory};y(T);H[P]=T;return T};var G=function(){var N=$(this),L,M=x(N);if(false===M){return}L=M.$options;if(N.is("select")){N.on("change",function(){var O=L.filter(u);if(z(M)){y(M)}M.$selected=O;M.filterValue=O.val();I(M)})}else{L.on("click",function(O){var P=$(this),Q=L.filter(u);O.preventDefault();if(P.is(Q)){return}if(z(M)){y(M)}Q.removeClass(B);P.addClass(B);M.$selected=P;M.filterValue=P.data("filter-value");I(M)})}};var v=function(){var L=$(K);if(L&&L.length>0){L.each(G)}};v()})()});
(function(d){var c={};var a={offset:0,zIndex:100,noStop:false,bottom:false,unstickyOnAjax:true,stickyCondition:null,noStopOnBody:false,append:true};var b=[];d.sticky=function(h,p,o,n){d.destroySticky=function(u){d(window).off("scroll",c[u].scroll);d(window).off("resize",c[u].resize);c[u]=null;d(u).each(function(){var x=d(this);var w=s(x);var y=parseInt(w.originalTop,10);var v=d.inArray(y,b);if(v>=0){b.splice(v,1)}e(x);l(x);x.removeAttr("data-original-pos");x.removeAttr("data-original-width");x.data("sticky-stopped",false);x.data("stickied",false)})};p=d.extend({},a,p);function r(){var u=[];if(h instanceof jQuery){u=h}else{u=d(h)}if(u.length<=0){return}u.each(function(){var y=d(this);if(y.attr("data-sticky-disabled")==="true"){return}var x=y.outerHeight();var v=y.outerWidth();var A=d(window).height();if(x>=A||x===0||v===0){return}var w=s(y);var C=parseInt(w.originalTop,10);var z=w.originalLeft;var B=w.originalWidth;if(d.inArray(C,b)<0){b.push(C);b.sort(function(E,D){return E-D})}if(!t(y)&&d(window).scrollTop()>C){if(p.stickyCondition!==null){if(!p.stickyCondition(y)){return}}k(y,z,B);if(!p.noStop){i(y,C)}}else{if(t(y)&&d(window).scrollTop()<=C){i(y,C);l(y)}}if(!p.noStop&&t(y)){i(y,C)}if(p.bottom!==false&&t(y)){f(y,p.bottom)}})}function j(){var u=[];if(h instanceof jQuery){u=h}else{u=d(h)}u.each(function(){var v=d(this);v.removeAttr("data-original-pos");v.removeAttr("data-original-width");if(v.data("sticky-stopped")){e(v)}if(v.data("stickied")){l(v)}v.data("sticky-stopped",false);v.data("stickied",false)});b=[]}d(window).on("scroll",r);d(window).resize(j);c[h]={scroll:r,resize:j};function k(u,v,w){u.css("position","fixed").css("top",p.offset+"px").css("left",v+"px").css("width",w+"px").css("margin-top","0px").css("z-index",p.zIndex);if(o){o(u)}u.data("stickied",true);d(document).ajaxStop(function(){if(p.unstickyOnAjax){if(u.data("sticky-stopped")){e(u)}if(u.data("stickied")){l(u)}}})}function l(u){u.css("position","").css("top","").css("left","").css("width","").css("margin-top","").css("z-index","");if(n){n(u)}u.data("stickied",false)}function i(w,A){var u=d.inArray(A,b);var z=b.slice(u+1);var x=z[0];if(x!==undefined){var v=w.outerHeight()+d(window).scrollTop();var y=w.data("sticky-stopped");if(!y&&v>=x){m(w,x)}else{if(y&&v<x){e(w)}}}}function f(v,w){var y=g(v,w);var z=y.offset().top+y.outerHeight();if(z>0){var u=v.outerHeight()+d(window).scrollTop();var x=v.data("sticky-stopped");if(!x&&u>=z){m(v,z)}else{if(x&&u<z){e(v)}}}}function g(v,w){var x=null;var u=v.data("sticky-stopped-parent");if(w==="parent"){if(u){x=u}else{x=v.parent()}}else{if(w.ancestor!==undefined){if(u){x=u.parents(w.ancestor).first()}else{x=v.parents(w.ancestor).first()}}else{x=d(w)}}return x}function m(u,v){var w=u.outerHeight();u.css("position","absolute");u.css("top",(v-w)+"px");u.data("sticky-stopped",true);if(!p.noStopOnBody){u.data("sticky-stopped-parent",u.parent());d("body").append(u)}}function e(v){v.css("position","fixed");v.css("top",p.offset+"px");v.data("sticky-stopped",false);var u=v.data("sticky-stopped-parent");if(u){if(p.append){u.append(v)}else{u.prepend(v)}}v.removeData("sticky-stopped-parent")}function t(u){return u.data("stickied")||false}function s(v){var u=v.attr("data-original-pos");var w=v.attr("data-original-width");if(!u){q(v);u=v.attr("data-original-pos");w=v.attr("data-original-width")}return{originalPos:u,originalTop:u.split(";")[0],originalLeft:u.split(";")[1],originalWidth:w}}function q(w){var x=Number(w.css("margin-left").replace("px",""));var v=w.offset().left-x;var u=w.offset().top+";"+v;var y=w.outerWidth();w.attr("data-original-pos",u);w.attr("data-original-width",y);d(document).ajaxStop(function(z){w.removeAttr("data-original-pos");w.removeAttr("data-original-width");d(document).unbind(z)})}}})(jQuery);$(window).load(function(){$.sticky(".js-sticky-element",{offset:20,noStop:true});$.sticky(".mceEditor .toolbars",{bottom:"parent",noStopOnBody:true},function(c){a(c)},function(c){b(c)});$.sticky(".sticky-nav",{noStopOnBody:true},function(c){a(c)},function(c){b(c)});$.sticky(".sticky-li-row",{unstickyOnAjax:false,bottom:{ancestor:"div"},stickyCondition:function(f){var d=5;var e=f.parents("ul").first();var g=e.find("li");var c=f.parents("div.js-no-sticky");if(c.length>0){return false}if(g.length<d){return false}else{return true}},append:false},function(c){a(c)},function(c){b(c)});var a=function(c,f){var d=null;if(typeof f!==undefined){d=c.parents(f).first()}else{d=c.parent()}var e=parseInt(d.css("padding-top"),10);c.parent().css("padding-top",(c.outerHeight()+e)+"px")};var b=function(c,e){var d=null;if(typeof e!==undefined){d=c.parents(e).first()}else{d=c.parent()}c.parent().css("padding-top","")}});
(function(e){var i=false;if(!!Modernizr&&!!Modernizr.video&&!!Modernizr.video.h264){i=true}var h=$(document);var n=[],f,k=false;var j=function(p){var o=$(p);if(!o.data("stopped")){p.pause();o.data("stopped",true)}};var l=function(){f.each(function(){j(this)})};var g=function(){k=true;l()};var b=function(p){if(true===k){return}var o=$(p);if(!!o.data("stopped")){p.play();o.data("stopped",false)}};var m=function(o){var r=o.data("parent"),q,p;if(!!r){q=o.parents(r)}else{q=o.parent()}if(!!q&&q.length>0){q=q.first()}if(!!q){p=q.data("no-video-clip-style");if(!!p){q.attr("style",p)}}};var a=function(r){var t,s,q=r.attr("content"),o=r.data(),p;try{o.src=q;s=$("<video/>",o);r.replaceWith(s)}catch(u){s=undefined;m(r)}if(!!s){t=s[0];n.push(t);p=scrollMonitor.create(t);p.enterViewport(function(){b(t)});p.exitViewport(function(){j(t)})}};var c=function(){var o=$(this);if(true===i){a(o)}else{m(o)}};var d=function(){var o=$("meta.js-video-clip");o.each(c);f=$(n);h.on("video_play",g)};h.ready(d)})(this);
/*!
* ZeroClipboard
* The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
* Copyright (c) 2013 Jon Rohan, James M. Greene
* Licensed MIT
* http://zeroclipboard.org/
* v1.2.1
*/
!function(){var R,Q=function(){var d=/\-([a-z])/g,c=function(f,e){return e.toUpperCase()};return function(a){return a.replace(d,c)}}(),P=function(b,p){var o,n,m,l,k,j;if(window.getComputedStyle?o=window.getComputedStyle(b,null).getPropertyValue(p):(n=Q(p),o=b.currentStyle?b.currentStyle[n]:b.style[n]),"cursor"===p&&(!o||"auto"===o)){for(m=b.tagName.toLowerCase(),l=["a"],k=0,j=l.length;j>k;k++){if(m===l[k]){return"pointer"}}}return o},O=function(d){if(C.prototype._singleton){d||(d=window.event);var c;this!==window?c=this:d.target?c=d.target:d.srcElement&&(c=d.srcElement),C.prototype._singleton.setCurrent(c)}},N=function(e,d,f){e.addEventListener?e.addEventListener(d,f,!1):e.attachEvent&&e.attachEvent("on"+d,f)},M=function(e,d,f){e.removeEventListener?e.removeEventListener(d,f,!1):e.detachEvent&&e.detachEvent("on"+d,f)},L=function(i,h){if(i.addClass){return i.addClass(h),i}if(h&&"string"==typeof h){var n=(h||"").split(/\s+/);if(1===i.nodeType){if(i.className){for(var m=" "+i.className+" ",l=i.className,k=0,j=n.length;j>k;k++){m.indexOf(" "+n[k]+" ")<0&&(l+=" "+n[k])}i.className=l.replace(/^\s+|\s+$/g,"")}else{i.className=h}}}return i},K=function(h,g){if(h.removeClass){return h.removeClass(g),h}if(g&&"string"==typeof g||void 0===g){var l=(g||"").split(/\s+/);if(1===h.nodeType&&h.className){if(g){for(var k=(" "+h.className+" ").replace(/[\n\t]/g," "),j=0,i=l.length;i>j;j++){k=k.replace(" "+l[j]+" "," ")}h.className=k.replace(/^\s+|\s+$/g,"")}else{h.className=""}}}return h},J=function(){var f,e,h,g=1;return"function"==typeof document.body.getBoundingClientRect&&(f=document.body.getBoundingClientRect(),e=f.right-f.left,h=document.body.offsetWidth,g=Math.round(100*(e/h))/100),g},I=function(r){var q={left:0,top:0,width:0,height:0,zIndex:999999999},p=P(r,"z-index");if(p&&"auto"!==p&&(q.zIndex=parseInt(p,10)),r.getBoundingClientRect){var o,n,m,l=r.getBoundingClientRect();"pageXOffset" in window&&"pageYOffset" in window?(o=window.pageXOffset,n=window.pageYOffset):(m=J(),o=Math.round(document.documentElement.scrollLeft/m),n=Math.round(document.documentElement.scrollTop/m));var i=document.documentElement.clientLeft||0,c=document.documentElement.clientTop||0;q.left=l.left+o-i,q.top=l.top+n-c,q.width="width" in l?l.width:l.right-l.left,q.height="height" in l?l.height:l.bottom-l.top}return q},H=function(e,d){var f=!(d&&d.useNoCache===!1);return f?(-1===e.indexOf("?")?"?":"&")+"nocache="+(new Date).getTime():""},G=function(e){var d=[],f=[];return e.trustedOrigins&&("string"==typeof e.trustedOrigins?f.push(e.trustedOrigins):"object"==typeof e.trustedOrigins&&"length" in e.trustedOrigins&&(f=f.concat(e.trustedOrigins))),e.trustedDomains&&("string"==typeof e.trustedDomains?f.push(e.trustedDomains):"object"==typeof e.trustedDomains&&"length" in e.trustedDomains&&(f=f.concat(e.trustedDomains))),f.length&&d.push("trustedOrigins="+encodeURIComponent(f.join(","))),"string"==typeof e.amdModuleId&&e.amdModuleId&&d.push("amdModuleId="+encodeURIComponent(e.amdModuleId)),"string"==typeof e.cjsModuleId&&e.cjsModuleId&&d.push("cjsModuleId="+encodeURIComponent(e.cjsModuleId)),d.join("&")},F=function(f,e){if(e.indexOf){return e.indexOf(f)}for(var h=0,g=e.length;g>h;h++){if(e[h]===f){return h}}return -1},E=function(b){if("string"==typeof b){throw new TypeError("ZeroClipboard doesn't accept query strings.")}return b.length?b:[b]},D=function(g,f,j,i,h){h?window.setTimeout(function(){g.call(f,j,i)},0):g.call(f,j,i)},C=function(f,e){if(f&&(C.prototype._singleton||this).glue(f),C.prototype._singleton){return C.prototype._singleton}C.prototype._singleton=this,this.options={};for(var h in z){this.options[h]=z[h]}for(var g in e){this.options[g]=e[g]}this.handlers={},C.detectFlashSupport()&&w()},B=[];C.prototype.setCurrent=function(a){R=a,this.reposition();var f=a.getAttribute("title");f&&this.setTitle(f);var c=this.options.forceHandCursor===!0||"pointer"===P(a,"cursor");return A.call(this,c),this},C.prototype.setText=function(b){return b&&""!==b&&(this.options.text=b,this.ready()&&this.flashBridge.setText(b)),this},C.prototype.setTitle=function(b){return b&&""!==b&&this.htmlBridge.setAttribute("title",b),this},C.prototype.setSize=function(d,c){return this.ready()&&this.flashBridge.setSize(d,c),this},C.prototype.setHandCursor=function(b){return b="boolean"==typeof b?b:!!b,A.call(this,b),this.options.forceHandCursor=b,this};var A=function(b){this.ready()&&this.flashBridge.setHandCursor(b)};C.version="1.2.1";var z={moviePath:"ZeroClipboard.swf",trustedOrigins:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain",useNoCache:!0,forceHandCursor:!1};C.setDefaults=function(d){for(var c in d){z[c]=d[c]}},C.destroy=function(){C.prototype._singleton.unglue(B);var b=C.prototype._singleton.htmlBridge;b.parentNode.removeChild(b),delete C.prototype._singleton},C.detectFlashSupport=function(){var d=!1;if("function"==typeof ActiveXObject){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(d=!0)}catch(c){}}return !d&&navigator.mimeTypes["application/x-shockwave-flash"]&&(d=!0),d};var y=null,x=null,w=function(){var h=C.prototype._singleton,g=document.getElementById("global-zeroclipboard-html-bridge");if(!g){var l={};for(var k in h.options){l[k]=h.options[k]}l.amdModuleId=y,l.cjsModuleId=x;var j=G(l),i='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+h.options.moviePath+H(h.options.moviePath,h.options)+'"/>         <param name="allowScriptAccess" value="'+h.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+j+'"/>         <embed src="'+h.options.moviePath+H(h.options.moviePath,h.options)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+j+'"           scale="exactfit">         </embed>       </object>';g=document.createElement("div"),g.id="global-zeroclipboard-html-bridge",g.setAttribute("class","global-zeroclipboard-container"),g.setAttribute("data-clipboard-ready",!1),g.style.position="absolute",g.style.left="-9999px",g.style.top="-9999px",g.style.width="15px",g.style.height="15px",g.style.zIndex="9999",g.innerHTML=i,document.body.appendChild(g)}h.htmlBridge=g,h.flashBridge=document["global-zeroclipboard-flash-bridge"]||g.children[0].lastElementChild};C.prototype.resetBridge=function(){return this.htmlBridge.style.left="-9999px",this.htmlBridge.style.top="-9999px",this.htmlBridge.removeAttribute("title"),this.htmlBridge.removeAttribute("data-clipboard-text"),K(R,this.options.activeClass),R=null,this.options.text=null,this},C.prototype.ready=function(){var b=this.htmlBridge.getAttribute("data-clipboard-ready");return"true"===b||b===!0},C.prototype.reposition=function(){if(!R){return !1}var a=I(R);return this.htmlBridge.style.top=a.top+"px",this.htmlBridge.style.left=a.left+"px",this.htmlBridge.style.width=a.width+"px",this.htmlBridge.style.height=a.height+"px",this.htmlBridge.style.zIndex=a.zIndex+1,this.setSize(a.width,a.height),this},C.dispatch=function(d,c){C.prototype._singleton.receiveEvent(d,c)},C.prototype.on=function(f,e){for(var h=f.toString().split(/\s/g),g=0;g<h.length;g++){f=h[g].toLowerCase().replace(/^on/,""),this.handlers[f]||(this.handlers[f]=e)}return this.handlers.noflash&&!C.detectFlashSupport()&&this.receiveEvent("onNoFlash",null),this},C.prototype.addEventListener=C.prototype.on,C.prototype.off=function(g,f){for(var j=g.toString().split(/\s/g),i=0;i<j.length;i++){g=j[i].toLowerCase().replace(/^on/,"");for(var h in this.handlers){h===g&&this.handlers[h]===f&&delete this.handlers[h]}}return this},C.prototype.removeEventListener=C.prototype.off,C.prototype.receiveEvent=function(r,q){r=r.toString().toLowerCase().replace(/^on/,"");var p=R,o=!0;switch(r){case"load":if(q&&parseFloat(q.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))<10){return this.receiveEvent("onWrongFlash",{flashVersion:q.flashVersion}),void 0}this.htmlBridge.setAttribute("data-clipboard-ready",!0);break;case"mouseover":L(p,this.options.hoverClass);break;case"mouseout":K(p,this.options.hoverClass),this.resetBridge();break;case"mousedown":L(p,this.options.activeClass);break;case"mouseup":K(p,this.options.activeClass);break;case"datarequested":var n=p.getAttribute("data-clipboard-target"),m=n?document.getElementById(n):null;if(m){var h=m.value||m.textContent||m.innerText;h&&this.setText(h)}else{var g=p.getAttribute("data-clipboard-text");g&&this.setText(g)}o=!1;break;case"complete":this.options.text=null}if(this.handlers[r]){var a=this.handlers[r];"string"==typeof a&&"function"==typeof window[a]&&(a=window[a]),"function"==typeof a&&D(a,p,this,q,o)}},C.prototype.glue=function(d){d=E(d);for(var c=0;c<d.length;c++){-1==F(d[c],B)&&(B.push(d[c]),N(d[c],"mouseover",O))}return this},C.prototype.unglue=function(e){e=E(e);for(var d=0;d<e.length;d++){M(e[d],"mouseover",O);var f=F(e[d],B);-1!=f&&B.splice(f,1)}return this},"function"==typeof define&&define.amd?define(["require","exports","module"],function(e,d,f){return y=f&&f.id||null,C}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(x=module.id||null,module.exports=C):window.ZeroClipboard=C}();
(function(c){var e=".js-clipboard-set";var a=".js-clipboard-btn";var h=".js-clipboard-target";var j="is-clipboard-copied";var l=0;var b=2000;var i="clipboard-copied-delay";var k="clipboard-copied-msg";var g=function(){var m=$(e);m.each(function(){var o=$(this),n=o.find(h).first(),q=o.find(a).first(),p;if(0===n.length||0===q.length){return}p=n.attr("id");if(!p){l+=1;p="js-clipboard-target-"+l;n.attr("id",p)}q.attr("data-clipboard-target",p)})};var f=function(){var m=$(this),o=m.data(i)||b,n=m.data(k),p=m.data("copiedTimeoutId");if(!!n){Phoenix.Ui.showSuccessMessage(n)}if(!!p){clearTimeout(p);m.data("copiedTimeoutId",false)}m.addClass(j);p=setTimeout(function(){m.removeClass(j);m.data("copiedTimeoutId",false)},o);m.data("copiedTimeoutId",p)};var d=function(){var q=$(a),o=c.ZeroClipboard,n=$("meta#ZeroClipBoardSwf").attr("content"),p=("function"===typeof o),m,r=window.location;if(!p||!n||0===q.length){if(0<q.length){q.remove()}return}g();o.setDefaults({allowScriptAccess:"always",moviePath:n,trustedOrigins:[r.protocol+"//"+r.host]});m=new o(q);m.on("complete",f)};$(window).on("load",d)})(this);
(function(c,f){var e=window.location.pathname;function b(){var h=f("#nav-main");var g=f(".js-hilightable-sub-nav");d(h,true,true);g.each(function(i,j){d(f(this),true)})}function d(k,g,i){var h=k.find("li");var j=null;if(!i){j=h.first()}h.each(function(l,m){var n=f(this).children("a").attr("href");if(typeof n!=="undefined"&&(g||n.length===e.length)&&e.indexOf(n)===0){j=f(this)}});if(j){j.addClass("active")}}var a=function(){var g=f(".js-dropnav-active");if(typeof f.fn.menuAim==="undefined"){return false}f.each(g,function(){var h=f(this);var i="right";if(h.attr("data-direction")){i=h.attr("data-direction")}h.menuAim({activate:function(j){f(j).addClass("dropnav-menu__active")},deactivate:function(j){f(j).removeClass("dropnav-menu__active")},submenuDirection:i})})};f(document).ready(function(){b();a()})}(this,jQuery));
$(document).ready(function(){var c=$(".js-share-button-facebook");var b=$(".js-share-button-twitter");var d="https://graph.facebook.com/fql?q=SELECT%20url,%20normalized_url,%20share_count,%20like_count,%20comment_count,%20total_count,commentsbox_count,%20comments_fbid,%20click_count%20FROM%20link_stat%20WHERE%20url=";var e="http://urls.api.twitter.com/1/urls/count.json?url=";var f=".js-share-count";if(b.length>0){var a=b.attr("data-share-url");$.ajax({url:e+a,dataType:"jsonp",success:function(h){if(!h){return}var g=h.count;b.find(f).text(g);b.find(f).parent().removeClass("hide")},})}if(c.length>0){var a=c.attr("data-share-url");$.get(d+"'"+a+"'",function(h){if(!h){return}var g=h.data[0].total_count;c.find(f).text(g);c.find(f).parent().removeClass("hide")})}});
$(document).ready(function(){var c=$(".js-show-loader");var a=".js-show-loader-shows";var b=c.find(".js-show-loader-video");var e=c.find(".js-show-loader-info");var d="/api/show/{slug}/latest";c.on("click",a+" li",function(i){i.preventDefault();var h=$(this);if(h.hasClass("is-today")){return false}h.siblings().removeClass("is-today");h.addClass("is-today");var g=h.attr("data-day");var f=h.attr("data-slug");b.fadeOut("slow");e.children().fadeOut("slow",function(){AjaxApiRequest.makeGetApiRequest(d.replace("{slug}",f),function(j){if(g!=="Today"){e.find(".js-show-loader-last").removeClass("hide")}else{e.find(".js-show-loader-last").addClass("hide")}e.find(".js-show-loader-day").text(g+"'s");e.find(".js-show-loader-title").text(j.title);e.find(".js-show-loader-title").attr("href",j.url);e.find(".js-show-loader-comments").text(j.commentCount).parent("a").attr("href",j.url);b.find(".av-wrapper").css("background-image","");b.find(".av-wrapper").html(j.html);b.fadeIn("slow");e.children().fadeIn("slow")})})});$(".js-show-loader-initial").on("click",function(){var f=$(this).attr("data-video-url");$(this).parent().css("background-image","");$(this).parent().html(f)})});
$(document).ready(function(){var a=null;var b=$(".js-carousel-pos li");var c=function(e){a=Swipe(e.get(0),{callback:function(g){var f=b.length;while(f--){console.log(b.eq(f));if(b.eq(f).hasClass("on")){b.eq(f).removeClass("on")}}b.eq(g).addClass("on")}});var d=$(".carousel .item-list").attr("data-page-length");e.removeClass("loading");e.children().removeClass("hide");b.first().addClass("on");e.parents("section").first().on("click",".js-carousel-left",function(){a.prev()});e.parents("section").first().on("click",".js-carousel-right",function(){a.next()});$(".carousel-control").hover(function(){$(".js-carousel").toggleClass("carousel-hover")});$(".carousel .item-list__item").hover(function(){$(".carousel-control").toggleClass("carousel-item-hover")});$(".carousel .item-list__item").css("width",((100/d)+"%"))};$(".js-carousel").each(function(){c($(this))})});
(function(){window.PhoenixUtils={getHtmlTemplate:function(a){var b=$('script[type="text/template/'+a+'"]');if(!b.length){return("")}return(b.html().trim())},cloneObject:function(a){try{return(JSON.parse(JSON.stringify(a)))}catch(b){return(null)}},fromJson:function(a){try{return(JSON.parse(a))}catch(b){return(null)}},toJson:function(a){try{return(JSON.stringify(a))}catch(b){return(null)}},capitalizeString:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},getBrowser:function(){if(typeof(navigator.userAgent)=="undefined"){return("unknown")}if(navigator.userAgent.search("Chrome")!=-1){return("chrome")}if(navigator.userAgent.search("Firefox")!=-1){return("firefox")}if(navigator.userAgent.search("Safari")!=-1){return("safari")}if(navigator.userAgent.search("MSIE")!=-1){return("ie")}return("unknown")},getIEVersion:function(){return(parseFloat(navigator.appVersion.split("MSIE")[1]))},getOS:function(){var c=navigator.appVersion;if(c.indexOf("Windows")!=-1){var b=c.indexOf("Windows NT");if(b==-1){return("Windows9x")}var a=c.substr(b+11,3);if(a=="6.2"){return("Windows8")}if(a=="6.1"){return("Windows7")}if(a=="6.0"){return("WindowsVista")}if(a=="5.1"){return("WindowsXP")}if(a=="5.0"){return("Windows2K")}return("WindowsNT")}if(c.indexOf("iPad")!=-1){return("iOS-iPad")}if(c.indexOf("iPhone")!=-1){return("iOS-iPhone")}if(c.indexOf("iPod")!=-1){return("iOS-iPod")}if(c.indexOf("Android")!=-1){return("Android")}if(c.indexOf("Mac")!=-1){return("MacOS")}if(c.indexOf("X11")!=-1){return("UNIX")}if(c.indexOf("Linux")!=-1){return("Linux")}return("Unknown")},eoo:null}}());
var UrlMaster=function(){var f={setOrigin:function(i){h=i},setPath:function(i){c=i},addParam:function(j,i){e[j]=i},removeParam:function(i){if(typeof(e[i]!="undefined")){delete (e[i])}},hasParam:function(i){return(e.hasOwnProperty(i))},getParam:function(j,i){if(typeof(i)=="undefined"){i=null}if(!e.hasOwnProperty(j)){return(i)}return(decodeURIComponent(e[j]))},clearParams:function(){e={}},paramExists:function(i){return(typeof(e[i]!="undefined"))},setHash:function(i){b=i},getHash:function(i){return(b)},setHashLive:function(j,i,k){if(typeof(i)=="undefined"){i=false}if(typeof(k)=="undefined"){k=false}d=i;window.location.hash=j;if(k){b=j}},getHashLive:function(){var i=window.location.hash;if(i===""){return("")}return(decodeURI(i.toLowerCase()).substr(1))},getHashParams:function(k){if(typeof(k)=="undefined"){k={}}var j=window.location.hash;if(j===""){return({})}var i=a(j.substr(1));$.extend(k,i);return(k)},setHashParams:function(l,i){var j="";for(var k in l){if(l.hasOwnProperty(k)){j+=k+":"+l[k]+";"}}j=encodeURI(j.substr(0,j.length-1));f.setHash(j,i)},updateHashParams:function(l,i){var j=f.getHashParams();for(var k in l){if(l.hasOwnProperty(k)){j[k]=l[k]}}f.setHashParams(j,i)},bindHashChange:function(j,i){if(g.indexOf(j)!=-1){return}g.push(j);if(typeof(i)!="undefined"&&i){j()}},unbindHashChange:function(j){var i=g.indexOf(j);if(i==-1){return}g.splice(i,1)},generateUrl:function(){var i="";if(h!==""){i=h}else{i=window.location.protocol+"//"+window.location.hostname}if(window.location.port.length){i+=":"+window.location.port}if(c!==""){i+=c}else{i+=window.location.pathname}if(Object.keys(e).length){i+="?";for(var j in e){if(e.hasOwnProperty(j)){i+=j+"="+encodeURIComponent(e[j])+"&"}}i=i.substr(0,i.length-1)}if(b!==""){i+="#"+b}return(i)},eoo:null};var h="";var c="";var b="";var e={};var g=[];var d=false;(function(){var i=window.location.search;if(i!==""){i=i.substr(1);i.split("&").forEach(function(k){var j=k.split("=");e[j[0]]=j[1]})}$(window).hashchange(function(){if(d){d=false;return}g.forEach(function(j){j()})})})();function a(k){var j={};if(typeof(k)=="undefined"||!k){return(j)}try{k.split(";").forEach(function(m){var l=m.split(":");if(l.length==2){var n=l[0].replace(/\s/g,"");j[n]=l[1].replace(/^[ \t]+|[ \t]+$ /,"")}else{j[l[0]]=null}})}catch(i){return([])}return(j)}return f};
$(function(){var o=$(".js-review-scale-widget-container");var k=$(".js-user-review-scale-container");var n=$(".js-user-review-scale-slider");var s=$(".js-user-review-scale-fill");var a=o.find("a[data-original-url]");var f=$(".js-user-review-scale");var d=$(".js-current-user-review-score");var p=false;var q=$(".js-current-user-review-question");if(!d.length){p=true}var e=false;var g=f.attr("data-current-score");var m=a.attr("data-original-url");var c=o.attr("data-rate-url");var j=f.attr("data-assoc-id");var l=f.attr("data-assoc-type-id");var i=l+"-"+j;var h=false;var r='<span class="breakdown-yourScore__title js-current-user-review-title">You rated <span>{objectName}</span>';var b='<span class="breakdown-yourScore__score js-current-user-review-score">{userReviewScore}</span>';a.attr("href",m+"?score="+g);k.on("mouseenter","li",function(){if(h){return}if(!e){n.fadeIn(350);n.children().removeClass("hide");n.css("width",(parseInt($(this).text(),10)*10)+"%")}});k.on("mouseleave",function(){if(h){return}if(!e){n.fadeOut(350)}else{n.css("width",g*10+"%")}});k.on("click","li",function(){if(h){return}g=parseInt($(this).text(),10);n.css("width",(g*10)+"%");a.attr("href",m+"?score="+g);e=true;n.children().addClass("hide");n.fadeOut(350,function(){e=false});s.css("width",(g*10)+"%");AjaxApiRequest.makeApiRequest(c,{score:g},true,function(u){h=false;if(!p){d.text(u.score)}else{var t=r.replace("{objectName}",q.data("objectName"));if(u.success==true){t=t.replace("{userReviewScore}",u.score);p=false;q.replaceWith(t);$(".js-current-user-review-title").after($(b.replace("{userReviewScore}",u.score)));d=$(".js-current-user-review-score")}}if(u.success==false){if(u.error=="access denied"){Phoenix.Ui.showErrorMessage("You must login to submit a score.")}else{if(u.error=="user not allowed to create a review"){Phoenix.Ui.showErrorMessage("You are not allowed to create a review.")}else{Phoenix.Ui.showErrorMessage("Rating coult not be saved.")}}}else{f.attr("data-current-score",u.score);Phoenix.Ui.showSuccessMessage("Rating saved.")}},function(t){h=false;if(t!=="Forbidden"){Phoenix.Ui.showErrorMessage("Error while saving.")}})})});
var AjaxApiRequest=function(){var c={makeApiRequest:function(d,h,f,e,g){if(typeof(h)=="undefined"||typeof(f)=="undefined"){throw ("Must specify params, and post or get for makeApiRequest")}a(d,h,f,e,g)},makeGetApiRequest:function(d,g,e,f){if(typeof(g)=="function"){f=e;e=g;g=null}a(d,g,false,e,f)},makePostApiRequest:function(d,g,e,f){if(typeof(g)=="function"){f=e;e=g;g=null}a(d,g,true,e,f)},eoo:null};(function(){$(document).ready(function(){$(".js-ajax-api-request").click(function(g){g.preventDefault();var f=$(this);var h="";var d=f.attr("data-api-url-from");if(typeof(d)!="undefined"){h=$(d).val()}else{h=f.attr("href")}if(f.data("add-class")){a(h,null,null,function(){f.toggleClass(f.data("add-class"));f.attr("href","#null")})}else{a(h)}});$(".js-ajax-api-request-select").change(function(){a($(this).val())});$(".js-ajax-api-track-anchor").click(function(h){var g=$(this);var d=g.attr("data-tracking-token");if(b(d)){Phoenix.getDocument().trigger("api_result_event",d);var f=g.attr("href");if(f.charAt(0)!="#"){h.preventDefault();var i=g.attr("target");setTimeout(function(){if(!i||i===""){window.location=f}else{window.open(f,i)}},1000)}}});$(".js-ajax-api-track-form-submit").click(function(g){var f=$(this);var d=f.attr("data-tracking-token");if(!b(d)){return}if(f.data().formPostLatch===undefined){g.preventDefault();Phoenix.getDocument().trigger("api_result_event",d);f.prop("disabled",true);f.data().formPostLatch=true;setTimeout(function(){f.prop("disabled",false);if(navigator.userAgent.search("Firefox")==-1){f.trigger("click")}else{var e=f.parents("form");if(e[0]){if(typeof(tinymce)!="undefined"){tinymce.triggerSave()}e.submit()}}},250)}else{delete (f.data().formPostLatch)}})})})();function b(d){return(typeof(d)!="undefined"&&d&&d!=="")}function a(i,h,f,e,g){if(typeof(f)=="undefined"){f=false}if(typeof(e)=="undefined"){e=function(){}}if(typeof(g)=="undefined"){g=function(){}}var d=f?$.post:$.get;d(i,h,function(j){if(typeof(j)!="undefined"&&j&&typeof(j.trackingToken)!="undefined"){Phoenix.getDocument().trigger("api_result_event",[j])}e(j)}).error(function(l,k,j){g(j,l)}).statusCode({0:function(j){},303:function(j){},302:function(j){}})}return(c)}();
(function(a){var c=[];var b=function(){var i={init:function(u){k=u.find(".js-poll-not-voted");m=u.find(".js-poll-voted");o=u.find(".js-poll-options");j=u.find(".js-poll-tally");r=o.find(".js-poll-option");d=u.find(".js-poll-submit");q=u.find(".js-poll-error");l=q.find(".js-error-text");e=u.attr("data-poll-id");p=u.attr("data-voting-allowed");s=u.attr("data-user-voted");if(!p||s){var t=m.attr("data-tally");n($.parseJSON(t));g($.parseJSON(t));m.removeClass("hidden")}else{k.removeClass("hidden")}if(r.length){h()}return(this)},eoo:null};var e=null;var p=false;var s=false;var k=null;var m=null;var o=null;var j=null;var r=null;var d=null;var q=null;var l=null;function h(){r.click(function(){var u=$(this);if(u.hasClass("js-poll-option-selected")){return}var t=o.find(".js-poll-option-selected");if(t[0]){t.removeClass("js-poll-option-selected")}u.addClass("js-poll-option-selected")});d.click(function(){var t=o.find(".js-poll-option-selected");if(!t[0]){return}q.addClass("hidden");var u=t.attr("data-poll-option-id");AjaxApiRequest.makeApiRequest("/poll/"+e+"/vote/"+u,null,false,function(v){if(v.success){n(v.tally);g(v.tally);m.removeClass("hidden");k.addClass("hidden")}else{f(v.error)}},function(x,w,v){if(x||w||v){}console.log("voting error "+v)})});$("#designer-values-submit").click(function(){var v=$(".js-designer-tally-values");var u=0;var w=0;v.each(function(x,y){u++;w+=parseInt($(y).val(),10)});if(w!=100){if(w>100){v.val(100/u)}else{var t=(100-w)/u;v.each(function(y,z){var x=$(z);u++;x.val(parseInt(x.val(),10)+t)})}}})}function n(t){j.find(".js-option-tally").each(function(v,x){var w=$(x);var u=parseInt(w.attr("data-poll-option-id"),10);w.text(t[u]+"%")})}function g(t){j.find(".js-option-pollbar").each(function(v,x){var w=$(x);var u=parseInt(w.attr("data-poll-option-id"),10);w.css("width",t[u]+"%")})}function f(t){l.text(t);q.removeClass("hidden")}return(i)};$(document).ready(function(){$(".js-poll-container").each(function(d,f){c.push(new b().init($(f)))})})}(window));